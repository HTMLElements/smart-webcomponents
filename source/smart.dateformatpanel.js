
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("DateFormatPanel",class{constructor(a,b,c,d="en",e=""){const f=this;a&&(f.formatVariants=a,f.inputDateTimeFormats=b,f.value="",f.customDateTimeContainer=document.querySelector(c),f._setLocalizationSettings(d,e),f._initSmartInputHolder(),f._initAddMoreFormatsButton(),f._initDateTimeFormatHolder())}_setLocalizationSettings(a,b){const c=this;c.locale=a,c.messages=b,c.defaultLocale="en",c.defaultMessages={en:{apply:"apply",date:"date",time:"time",day:"day",month:"month",year:"year",hours:"hours",hour:"hour",minutes:"minutes",minute:"minute",seconds:"seconds",second:"second",milliseconds:"milliseconds",ampm:"am/pm",delete:"delete"}},c.messages||(c.messages=c.defaultMessages),c.messages[c.locale]||(c.messages[c.defaultLocale]?c.locale=c.defaultLocale:(c.messages=c.defaultMessages,c.locale=c.defaultLocale))}_initSmartInputHolder(){const a=this;a.smartInputButtonsElementsHolder=document.createElement("div"),a.smartInputButtonsElementsHolder.classList.add("smart-input-buttons-elements-holder"),a.borderHolder=document.createElement("div"),a.borderHolder.classList.add("smart-input-and-add-formats-holder"),a.smartInputHolder=document.createElement("div"),a.smartInputHolder.classList.add("smart-input-list-holder"),a.borderHolder.appendChild(a.smartInputHolder),a.smartInputButtonsElementsHolder.appendChild(a.borderHolder),a.customDateTimeContainer.prepend(a.smartInputButtonsElementsHolder)}_initAddMoreFormatsButton(){const a=this;a.addFormatHolder=document.createElement("smart-drop-down-button"),a.addFormatHolder.setAttribute("drop-down-width","auto"),a.addFormatHolder.placeholder="",a.addFormatHolder.classList.add("add-format-holder"),a.addFormatHolder.classList.add("smart-hidden");let b=document.createElement("div");b.classList.add("all-format-holders");let c=document.createElement("div");c.classList.add("format-holder");let d=document.createElement("span");d.innerHTML=a.messages[a.locale].date?a.messages[a.locale].date.toUpperCase():a.defaultMessages[a.defaultLocale].date.toUpperCase(),d.classList.add("bold"),c.appendChild(d);let e=document.createElement("smart-button");e.innerHTML=a.messages[a.locale].day?a.messages[a.locale].day.charAt(0).toUpperCase()+a.messages[a.locale].day.slice(1):a.defaultMessages[a.defaultLocale].day.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].day.slice(1),a.addDayFormatClassName="add-day-format",e.classList.add(a.addDayFormatClassName),e.classList.add("flat"),e.classList.add("text-tramsform-none");const f=()=>a.addNewFormat("dd");e.addEventListener("click",f),e[a.addDayFormatClassName]=f,c.appendChild(e);let g=document.createElement("smart-button");g.innerHTML=a.messages[a.locale].month?a.messages[a.locale].month.charAt(0).toUpperCase()+a.messages[a.locale].month.slice(1):a.defaultMessages[a.defaultLocale].month.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].month.slice(1),a.addMonthFormatClassName="add-month-format",g.classList.add(a.addMonthFormatClassName),g.classList.add("flat"),g.classList.add("text-tramsform-none");const h=()=>a.addNewFormat("MM");g.addEventListener("click",h),g[a.addMonthFormatClassName]=h,c.appendChild(g);let i=document.createElement("smart-button");i.innerHTML=a.messages[a.locale].year?a.messages[a.locale].year.charAt(0).toUpperCase()+a.messages[a.locale].year.slice(1):a.defaultMessages[a.defaultLocale].year.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].year.slice(1),a.addYearFormatClassName="add-year-format",i.classList.add(a.addYearFormatClassName),i.classList.add("flat"),i.classList.add("text-tramsform-none");const j=()=>a.addNewFormat("yyyy");i.addEventListener("click",j),i[a.addYearFormatClassName]=j,c.appendChild(i),b.appendChild(c),c=document.createElement("div"),c.classList.add("format-holder"),d=document.createElement("span"),d.innerHTML=a.messages[a.locale].time?a.messages[a.locale].time.toUpperCase():a.defaultMessages[a.defaultLocale].time.toUpperCase(),d.classList.add("bold"),c.appendChild(d);let k=document.createElement("smart-button");k.innerHTML=a.messages[a.locale].hours?a.messages[a.locale].hours.charAt(0).toUpperCase()+a.messages[a.locale].hours.slice(1):a.defaultMessages[a.defaultLocale].hours.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].hours.slice(1),a.addHourFormatClassName="add-hour-format",k.classList.add(a.addHourFormatClassName),k.classList.add("flat"),k.classList.add("text-tramsform-none");const l=()=>a.addNewFormat("HH");k.addEventListener("click",l),k[a.addHourFormatClassName]=l,c.appendChild(k);let m=document.createElement("smart-button");m.innerHTML=a.messages[a.locale].minutes?a.messages[a.locale].minutes.charAt(0).toUpperCase()+a.messages[a.locale].minutes.slice(1):a.defaultMessages[a.defaultLocale].minutes.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].minutes.slice(1),a.addMinutesFormatClassName="add-minute-format",m.classList.add(a.addMinutesFormatClassName),m.classList.add("flat"),m.classList.add("text-tramsform-none");const n=()=>a.addNewFormat("mm");m.addEventListener("click",n),m[a.addMinutesFormatClassName]=n,c.appendChild(m);let o=document.createElement("smart-button");o.innerHTML=a.messages[a.locale].seconds?a.messages[a.locale].seconds.charAt(0).toUpperCase()+a.messages[a.locale].seconds.slice(1):a.defaultMessages[a.defaultLocale].seconds.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].seconds.slice(1),a.addSecondFormatClassName="add-second-format",o.classList.add(a.addSecondFormatClassName),o.classList.add("flat"),o.classList.add("text-tramsform-none");const p=()=>a.addNewFormat("ss");o.addEventListener("click",p),o[a.addSecondFormatClassName]=p,c.appendChild(o);let q=document.createElement("smart-button");q.innerHTML=a.messages[a.locale].milliseconds?a.messages[a.locale].milliseconds.charAt(0).toUpperCase()+a.messages[a.locale].milliseconds.slice(1):a.defaultMessages[a.defaultLocale].milliseconds.charAt(0).toUpperCase()+a.defaultMessages[a.defaultLocale].milliseconds.slice(1),a.addMillisecondFormatClassName="add-millisecond-format",q.classList.add(a.addMillisecondFormatClassName),q.classList.add("flat"),q.classList.add("text-tramsform-none");const r=()=>a.addNewFormat("fff");q.addEventListener("click",r),q[a.addMillisecondFormatClassName]=r,c.appendChild(q);let s=document.createElement("smart-button");s.innerHTML=a.messages[a.locale].ampm?a.messages[a.locale].ampm.toUpperCase():a.defaultMessages[a.defaultLocale].ampm.toUpperCase(),a.addAmPmFormatClassName="add-ampm-format",s.classList.add(a.addAmPmFormatClassName),s.classList.add("flat"),s.classList.add("text-tramsform-none");const t=()=>a.addNewFormat("tt");s.addEventListener("click",t),s[a.addAmPmFormatClassName]=t,c.appendChild(s),b.appendChild(c),a.addFormatHolder.appendChild(b),a.borderHolder.appendChild(a.addFormatHolder),a.smartInputButtonsElementsHolder.appendChild(a.borderHolder);let u=document.createElement("smart-button");u.classList.add("use-format-button"),u.disabled=!0,u.classList.add("success"),u.innerHTML=a.messages[a.locale].apply?a.messages[a.locale].apply:a.defaultMessages[a.defaultLocale].apply;const v=()=>a.value=a.getFormat();u.addEventListener("click",v),u["apply-button-event-listener"]=v,a.useThisFormatHolder=u,a.smartInputButtonsElementsHolder.appendChild(a.useThisFormatHolder),a.customDateTimeContainer.appendChild(a.smartInputButtonsElementsHolder)}_initDateTimeFormatHolder(){const a=this;let b=document.createElement("div");const c=new Date;a.currentDate=c,a.dateTime=new Smart.Utilities.DateTime(a.currentDate);const d=Smart.Utilities.DateTime.getLocalizedNames(a.locale);a.dateTime.calendar.days=d.days,a.dateTime.calendar.months=d.months,a.dateTime.calendar.locale=a.locale;let e=document.createElement("ul");e.classList.add("date-time-format-list");for(let b,c=0;c<a.inputDateTimeFormats.length;c++){b=document.createElement("li"),b.classList.add("date-time-format");let d=a.inputDateTimeFormats[c],f=a.dateTime.toString(d);b.innerHTML=f,b.dataset.fullFormat=d;const g=()=>a.addNewFormat(b);b.addEventListener("click",g),b["date-time-format-"+d]=g,e.appendChild(b),0==c&&a.addNewFormat(b)}b.appendChild(e),a.customDateTimeContainer.appendChild(b)}detach(){const a=this;a._removeEventListeners()}_removeEventListeners(){const a=this;let b=a.customDateTimeContainer.querySelectorAll("li.date-time-format");for(let a,c=0;c<b.length;c++)a=b[c],a.removeEventListener("click",a["date-time-format-"+a.dataset.fullFormat]),delete a["date-time-format-"+a.dataset.fullFormat];a.useThisFormatHolder.removeEventListener("click",a.useThisFormatHolder["apply-button-event-listener"]),delete a.useThisFormatHolder["apply-button-event-listener"],a._detachAddBtnEvent(a.addDayFormatClassName),a._detachAddBtnEvent(a.addMonthFormatClassName),a._detachAddBtnEvent(a.addYearFormatClassName),a._detachAddBtnEvent(a.addHourFormatClassName),a._detachAddBtnEvent(a.addMinutesFormatClassName),a._detachAddBtnEvent(a.addSecondFormatClassName),a._detachAddBtnEvent(a.addMillisecondFormatClassName),a._detachAddBtnEvent(a.addAmPmFormatClassName);let c=a.customDateTimeContainer.querySelectorAll(".smart-input-list-holder smart-input.format-smart-input-list");for(let a,b=0;b<c.length;b++)a=c[b],a.removeEventListener("change",a["smart-input-format"+b]),delete a["smart-input-format"+b]}_detachAddBtnEvent(a){const b=this,c=b.customDateTimeContainer.querySelector(".all-format-holders ."+a);c.removeEventListener("click",c[a]),delete c[a]}getFormat(){const a=this,b=a.smartInputHolderChildNodes;let c="";for(let a=0;a<b.length;a++)b[a].dataset.format&&0!==b[a].dataset.format.length?c+=b[a].dataset.format:b[a].value&&(c+=b[a].value);return c}addNewFormat(a){const b=this;let c=!1;b.dateTimeFullFormatFirstPart="";let d,e;a.dataset?(e=a.dataset.fullFormat,b.smartInputHolder&&(b.smartInputHolder.innerHTML="")):(c=!0,e=" ( "+a+" ) "),d=new Smart.Utilities.DateTime(e),b.useThisFormatHolder.disabled=!1,b.customDateTimeContainer.querySelector(".smart-input-and-add-formats-holder").classList.remove("smart-hidden"),b._showElement(b.addFormatHolder);let f=d.getParseRegExp(d.calendar,e),g=Object.keys(f.groups).length;for(let d=0;d<g;d++){let a=f.groups[d],h=f.groups[d+1],i=document.createElement("smart-input");i.dropDownWidth="auto",i.dropDownButtonPosition="right",i.readonly=!0,i.dataset.format=a;const j=()=>b._handleSmartInputFormatChange(i);i.addEventListener("change",j),i["smart-input-format"+d]=j,i.classList.add("format-smart-input-list"),c&&b._addSignSmartInput(b.smartInputHolder,e,a,h,c),b.formatVariants.day[a]?b._setSmartInputDataSource(b.formatVariants.day,a,i,b.messages[b.locale].day?b.messages[b.locale].day.charAt(0).toUpperCase()+b.messages[b.locale].day.slice(1):b.defaultMessages[b.defaultLocale].day.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].day.slice(1)):b.formatVariants.month[a]?b._setSmartInputDataSource(b.formatVariants.month,a,i,b.messages[b.locale].month?b.messages[b.locale].month.charAt(0).toUpperCase()+b.messages[b.locale].month.slice(1):b.defaultMessages[b.defaultLocale].month.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].month.slice(1)):b.formatVariants.year[a]?b._setSmartInputDataSource(b.formatVariants.year,a,i,b.messages[b.locale].year?b.messages[b.locale].year.charAt(0).toUpperCase()+b.messages[b.locale].year.slice(1):b.defaultMessages[b.defaultLocale].year.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].year.slice(1)):b.formatVariants.hour[a]?b._setSmartInputDataSource(b.formatVariants.hour,a,i,b.messages[b.locale].hour?b.messages[b.locale].hour.charAt(0).toUpperCase()+b.messages[b.locale].hour.slice(1):b.defaultMessages[b.defaultLocale].hour.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].hour.slice(1)):b.formatVariants.minute[a]?b._setSmartInputDataSource(b.formatVariants.minute,a,i,b.messages[b.locale].minute?b.messages[b.locale].minute.charAt(0).toUpperCase()+b.messages[b.locale].minute.slice(1):b.defaultMessages[b.defaultLocale].minute.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].minute.slice(1)):b.formatVariants.second[a]?b._setSmartInputDataSource(b.formatVariants.second,a,i,b.messages[b.locale].second?b.messages[b.locale].second.charAt(0).toUpperCase()+b.messages[b.locale].second.slice(1):b.defaultMessages[b.defaultLocale].second.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].second.slice(1)):b.formatVariants.millisecond[a]?b._setSmartInputDataSource(b.formatVariants.millisecond,a,i,b.messages[b.locale].milliseconds?b.messages[b.locale].milliseconds.charAt(0).toUpperCase()+b.messages[b.locale].milliseconds.slice(1):b.defaultMessages[b.defaultLocale].milliseconds.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].milliseconds.slice(1)):b.formatVariants.ampm[a]&&b._setSmartInputDataSource(b.formatVariants.ampm,a,i,b.messages[b.locale].ampm?b.messages[b.locale].ampm.charAt(0).toUpperCase()+b.messages[b.locale].ampm.slice(1):b.defaultMessages[b.defaultLocale].ampm.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].ampm.slice(1)),b.smartInputHolder.appendChild(i),i.$.scrollView.attached=function(){requestAnimationFrame(()=>{b.setActiveSmartInput(i)})},d+1<g&&b._addSignSmartInput(b.smartInputHolder,e,a,h,c)}b.smartInputHolderChildNodes=b.smartInputHolder.childNodes}_setSmartInputDataSource(a,b,c,d){const e=this;let f,g,h=[];for(let i in a){let c=a[i];i===b&&(g=i+e.dateTime.toString("("+i+")")+" - "+c,f=d+" "+e.dateTime.toString("("+i+")")),h.push(i+e.dateTime.toString("("+i+")")+" - "+c)}c.dataset.valueTitle=d,c.dataset.selectedValue=g,h.push(e.messages[e.locale].delete?e.messages[e.locale].delete.charAt(0).toUpperCase()+e.messages[e.locale].delete.slice(1):e.defaultMessages[e.defaultLocale].delete.charAt(0).toUpperCase()+e.defaultMessages[e.defaultLocale].delete.slice(1)),c.dataSource=h,c.value=f}_handleSmartInputFormatChange(a){const b=this;a.value===(b.messages[b.locale].delete?b.messages[b.locale].delete.charAt(0).toUpperCase()+b.messages[b.locale].delete.slice(1):b.defaultMessages[b.defaultLocale].delete.charAt(0).toUpperCase()+b.defaultMessages[b.defaultLocale].delete.slice(1))?(1===a.parentNode.childNodes.length&&(b.useThisFormatHolder.disabled=!0,b.customDateTimeContainer.querySelector(".smart-input-and-add-formats-holder").classList.add("smart-hidden"),b._hideElement(b.addFormatHolder)),a.nextElementSibling?a.parentNode.removeChild(a.nextElementSibling):a.previousSibling&&a.parentNode.removeChild(a.previousSibling),a.parentNode.removeChild(a)):(a.dataset.selectedValue=a.value,a.dataset.format=a.value.split("(")[0],a.value=a.dataset.valueTitle+b.dateTime.toString("("+a.dataset.format+")"))}setActiveSmartInput(a){let b=document.querySelector("li[value=\""+a.dataset.selectedValue+"\"]"),c=b.parentNode,d=c.querySelectorAll("li");for(let b,c=0;c<d.length;c++)b=d[c],b.classList.contains("active")&&b.classList.remove("active");b.classList.add("active")}_hideElement(a){a&&a.classList.add("smart-hidden")}_showElement(a){a&&a.classList.remove("smart-hidden")}_addSignSmartInput(a,b,c,d,e){const f=this;let g=document.createElement("smart-input");g.dropDownWidth="auto",g.dropDownButtonPosition="right",g.classList.add("sign-smart-input");let h=["-","/",","];f.dateTimeFullFormatFirstPart||(f.dateTimeFullFormatFirstPart=b);let i=f.dateTimeFullFormatFirstPart.split(c)[1].split(d)[0];e&&(i="-"),f.dateTimeFullFormatFirstPart=f.dateTimeFullFormatFirstPart.slice(f.dateTimeFullFormatFirstPart.indexOf(c)+c.length,f.dateTimeFullFormatFirstPart.length);let j=!0;for(let f=0;f<h.length;f++)i.trim()===h[f]&&(h[f]=i),(i===h[f]||i.trim()===h[f])&&(j=!1);j&&h.push(i),g.dataSource=h,g.value=i,a.appendChild(g)}});