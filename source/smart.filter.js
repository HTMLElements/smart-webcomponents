
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("FilterGroup",class FilterGroup{constructor(){const a=this;a.stringConditions=["EMPTY","NOT_EMPTY","CONTAINS","CONTAINS_CASE_SENSITIVE","DOES_NOT_CONTAIN","DOES_NOT_CONTAIN_CASE_SENSITIVE","STARTS_WITH","STARTS_WITH_CASE_SENSITIVE","ENDS_WITH","ENDS_WITH_CASE_SENSITIVE","EQUAL","EQUAL_CASE_SENSITIVE","NULL","NOT_NULL"],a.numericConditions=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"],a.dateConditions=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"],a.booleanConditions=["EQUAL","NOT_EQUAL","NULL","NOT_NULL"],a.filters=[],a.logicalOperators=[]}evaluate(a){const b=this;let c=!0;for(let d,e=0;e<b.filters.length;e++)d=b.filters[e].evaluate(a),c=0==e?d:1===b.logicalOperators[e]||"or"===b.logicalOperators[e]?c||d:c&&d;return c}getFiltersCount(){return this.filters.length}setConditions(a,b){const c=this;"numeric"===a?c.numericConditions=b:"string"===a?c.stringConditions=b:"date"===a||"time"===a?c.dateConditions=b:"bool"===a||"boolean"===a?c.booleanConditions=b:void 0}getConditions(a){const b=this;let c=[];return"numeric"===a?c=b.numericConditions.slice(0):"string"===a?c=b.stringConditions.slice(0):"date"===a||"time"===a?c=b.dateConditions.slice(0):"bool"===a||"boolean"===a?c=b.booleanConditions.slice(0):void 0,c}generateFilterKey(){const a=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return a()+"-"+a()+"-"+a()}createFilter(a,b,c,d,e,f,g){if(null===a||a===void 0)return null;switch(a){case"int":case"float":case"int64":case"double":case"numeric":case"number":case"numericFilter":return new Smart.Utilities.NumericFilter(b,c.toUpperCase());case"string":case"stringFilter":return new Smart.Utilities.StringFilter(b,c.toUpperCase(),f);case"date":case"time":case"dateFilter":return new Smart.Utilities.DateFilter(b,c.toUpperCase(),e,f,g);case"bool":case"boolean":case"booleanFilter":return new Smart.Utilities.BooleanFilter(b,c.toUpperCase());case"custom":return new Smart.Utilities.CustomFilter(b,c.toUpperCase(),d);}throw new Error("smartGrid: There is no such filter type. The available filter types are: \"numericFilter\", \"stringFilter\", \"dateFilter\" and \"booleanFilter\"")}getFilters(){const a=this;let b=[];for(let c=0;c<a.filters.length;c++){const d=a.filters[c];if(d instanceof FilterGroup){let e=d.getFilters();b.push({value:e,logicalOperator:a.logicalOperators[c],type:"FilterGroup"})}else{const e={value:d.value,condition:d.condition,logicalOperator:a.logicalOperators[c],type:d.type};d.data&&(e.id=d.data),b.push(e)}}return b}addFilter(a,b){const c=this;c.filters[c.filters.length]=b,b.key=c.generateFilterKey(),c.logicalOperators[c.logicalOperators.length]=a}removeFilter(a){const b=this;for(let c=0;c<b.filters.length;c++)if(b.filters[c].key===a.key){b.filters.splice(c,1),b.logicalOperators.splice(c,1);break}}getOperatorAt(a){const b=this;return void 0===a||null===a?null:0>a||a>b.filters.length?null:b.logicalOperators[a]}setOperatorAt(a,b){const c=this;return void 0===a||null===a?null:0>a||a>c.filters.length?null:void(c.logicalOperators[b]=b)}getFilterAt(a){const b=this;return void 0===a||null===a?null:0>a||a>b.filters.length?null:b.filters[a]}setFilterAt(a,b){const c=this;return void 0===a||null===a?null:0>a||a>c.filters.length?null:void(b.key=c.generateFilterKey(),c.filters[a]=b)}clear(){const a=this;a.filters=[],a.logicalOperators=[]}getUniqueValues(a,b){const c=a.data,d=[],e=[],f="dateFilter"===a.filterType&&"timePicker"===a.displayMode;let g,h=!1;for(let g,j=0;j<c.length;j++){if(g=c[j][a.dataField],""===g||null===g||void 0===g){h=!0;continue}let b;b=f?new Smart.Utilities.DateTime(g).toString(a.formatString):g.toString(),-1===d.indexOf(b)&&(d.push(b),e.push({label:b,value:g,customAttribute:"default-item"}))}switch(a.filterType){case"numericFilter":case"booleanFilter":g=function(c,a){return c.value-a.value};break;case"stringFilter":g=function(c,a){return new Intl.Collator().compare(c.value,a.value)};break;case"dateFilter":g=f?function(c,a){try{const b=c.value.getHours(),d=a.value.getHours();if(b!==d)return b-d;const e=c.value.getMinutes(),f=a.value.getMinutes();if(e!==f)return e-f;const g=c.value.getSeconds(),h=a.value.getSeconds();return g===h?0:g-h}catch(a){return-1}}:function(c,a){try{return c.value.getTime()-a.value.getTime()}catch(a){return-1}};}return e.sort(g),"booleanFilter"===a.filterType&&e.map(function(a){a.label=a.label.toUpperCase()}),h&&e.push({label:b.localize("blanks"),value:"",customAttribute:"default-item"}),e}}),Smart.Utilities.Assign("StringFilter",class{constructor(a,b,c){const d=this;d.value=a,d.condition=b,d.locale=c||"en",d.type="stringFilter"}evaluate(a){const b=this,c=b.value,d=b.condition;if(null===a||a===void 0||""===a){if("NULL"===d)return!0;if("EQUAL"===d&&a===c)return!0;if("NOT_EQUAL"===d&&a!==c)return!0;if("EMPTY"!==d)return!1;if(""===a)return!0}let e="";try{e=a.toString()}catch(a){return!0}const f=function(a,c){const e=b.locale;return"EQUAL"===d?0===a.localeCompare(c,e,{sensitivity:"accent"}):"EQUAL_CASE_SENSITIVE"===d?0===a.localeCompare(c,e,{sensitivity:"variant"}):"NOT_EQUAL"===d?0!==a.localeCompare(c,e,{sensitivity:"accent"}):"NOT_EQUAL_CASE_SENSITIVE"===d?0!==a.localeCompare(c,e,{sensitivity:"variant"}):"CONTAINS"===d?-1!==a.toLowerCase().indexOf(c.toLowerCase()):"CONTAINS_CASE_SENSITIVE"===d?-1!==a.indexOf(c):"DOES_NOT_CONTAIN"===d?-1===a.toLowerCase().indexOf(c.toLowerCase()):"DOES_NOT_CONTAIN_CASE_SENSITIVE"===d?-1===a.indexOf(c):"EMPTY"===d?""===a:"NOT_EMPTY"===d?""!==a:"NOT_NULL"===d?null!==a:"STARTS_WITH"===d?(a=a.substring(0,c.length),0===a.localeCompare(c,e,{sensitivity:"accent"})):"ENDS_WITH"===d?(a=a.substring(a.length-c.length,a.length),0===a.localeCompare(c,e,{sensitivity:"accent"})):"ENDS_WITH_CASE_SENSITIVE"===d?(a=a.substring(a.length-c.length,a.length),0===a.localeCompare(c,e,{sensitivity:"variant"})):!("STARTS_WITH_CASE_SENSITIVE"!==d)&&(a=a.substring(0,c.length),0===a.localeCompare(c,e,{sensitivity:"variant"}))},g=[];if(c&&c.indexOf&&(0<=c.indexOf("|")||0<=c.indexOf(" AND ")||0<=c.indexOf(" OR ")||0<=c.indexOf(" and ")||0<=c.indexOf(" or "))){const a=f(e,c);if(a)return a;const b=0<=c.indexOf(" and ")?c.split(" and "):[],d=0<=c.indexOf(" or ")?c.split(" or "):[],h=0<=c.indexOf("|")?c.split("|"):[];let k=0<=c.indexOf(" AND ")?c.split(" AND "):[],j=0<=c.indexOf(" OR ")?c.split(" OR "):[];if(0<h.length)for(let a=0;a<h.length;a++)h[a]=h[a].trim;const l=0<=c.indexOf(" ")?c.split(" "):[];if(0<l.length)for(let a=0;a<l.length;a++)l[a]=l[a].trim;if(k=k.concat(l),k=k.concat(b),j=j.concat(h),j=j.concat(d),0<k.length)for(let a=0;a<k.length;a++)0<=!k[a].indexOf(" OR ")&&g.push(k[a]);if(0<j.length)for(let a=0;a<j.length;a++)0<=!j[a].indexOf(" AND ")&&g.push(j[a]);let i;for(let a=0;a<g.length;a++){const b=g[a],c=f(e,b),d=a<k.length?"and":"or";i=void 0===i?c:"or"==d?i||c:i&&c}return i}return f(e,c)}}),Smart.Utilities.Assign("BooleanFilter",class{constructor(a,b){const c=this;c.value=a,c.condition=b,c.type="booleanFilter"}evaluate(a){const b=this,c=b.value,d=b.condition,e=a;return"EQUAL"===d?e===c:"NOT_EQUAL"===d?e!==c:"NULL"===d?null===a||void 0===a||""===a:!("NOT_NULL"!==d)&&null!==a&&void 0!==a&&""!==a}}),Smart.Utilities.Assign("NumericFilter",class{constructor(a,b){const c=this;c.value=a,c.condition=b,c.type="numericFilter"}evaluate(a){const b=this;let c=b.value,d=b.condition;if(null===a||a===void 0||""===a)return"NOT_NULL"!==d&&("NULL"===d||("EQUAL"===d?a===c:"NOT_EQUAL"===d&&a!==c));if("NULL"===d)return!1;if("NOT_NULL"===d)return!0;let e=a;try{e=parseFloat(e)}catch(b){if(""!==a.toString())return!1}const f=function(a,b){return"number"==typeof a&&"number"!=typeof b&&(b=parseFloat(b)),"EQUAL"===d?a===b:"NOT_EQUAL"===d?a!==b:"GREATER_THAN"===d?a>b:"GREATER_THAN_OR_EQUAL"===d?a>=b:"LESS_THAN"===d?a<b:"LESS_THAN_OR_EQUAL"===d?a<=b:"STARTS_WITH"===d?(b=b.toString().toLowerCase(),a.toString().toLowerCase().substring(0,b.length)===b):"ENDS_WITH"===d?(a=a.toString().toLowerCase(),b=b.toString().toLowerCase(),a.substring(a.length-b.length,a.length)===b):"ENDS_WITH_CASE_SENSITIVE"===d?(a=a.toString(),b=b.toString(),a.substring(a.length-b.length,a.length)===b):"STARTS_WITH_CASE_SENSITIVE"===d?(b=b.toString(),a.toString().substring(0,b.length)===b):"CONTAINS"===d?-1!==a.toString().toLowerCase().indexOf(b.toString().toLowerCase()):"CONTAINS_CASE_SENSITIVE"===d?-1!==a.toString().indexOf(b.toString()):"DOES_NOT_CONTAIN"===d?-1===a.toString().toLowerCase().indexOf(b.toString().toLowerCase()):"DOES_NOT_CONTAIN_CASE_SENSITIVE"!==d||-1===a.toString().indexOf(b.toString())};let g=[];if(c&&c.indexOf&&(0<=c.indexOf("|")||0<=c.indexOf(" AND ")||0<=c.indexOf(" OR ")||0<=c.indexOf(" and ")||0<=c.indexOf(" or "))){let a=f(e,c);if(a)return a;c=c.toString();const b=0<=c.indexOf(" and ")?c.split(" and "):[],d=0<=c.indexOf(" or ")?c.split(" or "):[],h=0<=c.indexOf("|")?c.split("|"):[];let k=0<=c.indexOf(" AND ")?c.split(" AND "):[],j=0<=c.indexOf(" OR ")?c.split(" OR "):[];if(k=k.concat(b),j=j.concat(d),0<h.length)for(let a=0;a<h.length;a++)h[a]=h[a].trim;if(j=j.concat(h),0<k.length)for(let a=0;a<k.length;a++)0<=!k[a].indexOf(" OR ")&&g.push(k[a]);if(0<j.length)for(let a=0;a<j.length;a++)0<=!j[a].indexOf(" AND ")&&g.push(j[a]);let i;for(let b=0;b<g.length;b++){const c=g[b];if(c&&c.indexOf&&0<=c.indexOf("..")){const b=c.toString().split("..");2===b.length&&(a=e>=b[0]&&e<=b[1])}else a=f(e,c);const d=b<k.length?"and":"or";i=void 0===i?a:"or"==d?i||a:i&&a}return i}return c&&c.indexOf&&0<=c.indexOf("..")&&(g=c.toString().split(".."),2===g.length)?e>=g[0]&&e<=g[1]:f(e,c)}}),Smart.Utilities.Assign("DateFilter",class{constructor(a,b,c,d,e){const f=this,g=new Smart.Utilities.DateTime;if(f.value=a,f.type="dateFilter",void 0!==c){const b=g.parseDate(a,c);if(null!==b)f.filterdate=b;else{const b=g.tryparseDate(a);null!==b&&(f.filterdate=b)}}else{const b=new Date(a);f.filterdate="NaN"===b.toString()||"Invalid Date"===b.toString()?g.tryparseDate(a):b}if(!f.filterdate){const b=new Date(a);f.filterdate="NaN"===b.toString()||"Invalid Date"===b.toString()?g.tryparseDate(a):b}f.condition=b,f.formatString=c,f.timeOnly=e}evaluate(a){const b=this,c=b.condition,d=b.formatString;let e=b.value;if(b.timeOnly)return b.evaluateTimeOnly(a);if(null===a||void 0===a||""===a)return"NOT_NULL"!==c&&("NULL"===c||("EQUAL"===c?a===e:"NOT_EQUAL"===c&&a!==e));if("NULL"===c)return!1;if("NOT_NULL"===c)return!0;let f,g=new Date;g.setFullYear(1900,0,1),g.setHours(12,0,0,0);try{const c=new Smart.Utilities.DateTime,h=new Date(a);if(a="NaN"===h.toString()||"Invalid Date"===h.toString()?c.tryparseDate(a):h,g=a,f=!1,void 0!==d&&(0<=d.indexOf("t")||0<=d.indexOf("T")||0<=d.indexOf(":")||0<=d.indexOf("f"))&&(f=!0,e&&-1===e.toString().indexOf(":"))){const a=c.tryparseDate(e.toString()+":00");null!==a&&(b.filterdate=a)}f||(g.setHours(0),g.setMinutes(0),g.setSeconds(0))}catch(b){if(""!==a.toString())return!1}if(null!==b.filterdate)e=b.filterdate;else if(e&&e.indexOf&&(-1!==e.indexOf(":")||!isNaN(parseInt(e)))){const a=new Date(g);a.setHours(12,0,0,0);const b=e.split(":");for(let c=0;c<b.length;c++)0==c&&a.setHours(b[c]),1==c&&a.setMinutes(b[c]),2==c&&a.setSeconds(b[c]);e=a}f&&e&&e.setFullYear&&g&&g.getFullYear&&-1===d.indexOf("d")&&-1===d.indexOf("M")&&-1===d.indexOf("y")&&e.setFullYear(g.getFullYear(),g.getMonth(),g.getDate());const h=function(a,b){return null===a&&(a=""),"EQUAL"===c?a.toString()===b.toString():"NOT_EQUAL"===c?a.toString()!==b.toString():"GREATER_THAN"===c?a>b:"GREATER_THAN_OR_EQUAL"===c?a>=b:"LESS_THAN"===c?a<b:"LESS_THAN_OR_EQUAL"===c?a<=b:"STARTS_WITH"===c?(b=b.toString().toLowerCase(),a.toString().toLowerCase().substring(0,b.length)===b):"ENDS_WITH"===c?(a=a.toString().toLowerCase(),b=b.toString().toLowerCase(),a.substring(a.length-b.length,a.length)===b):"ENDS_WITH_CASE_SENSITIVE"===c?(a=a.toString(),b=b.toString(),a.substring(a.length-b.length,a.length)===b):"STARTS_WITH_CASE_SENSITIVE"===c?(b=b.toString(),a.toString().substring(0,b.length)===b):"CONTAINS"===c?-1!==a.toString().toLowerCase().indexOf(b.toString().toLowerCase()):"CONTAINS_CASE_SENSITIVE"===c?-1!==a.toString().indexOf(b.toString()):"DOES_NOT_CONTAIN"===c?-1===a.toString().toLowerCase().indexOf(b.toString().toLowerCase()):"DOES_NOT_CONTAIN_CASE_SENSITIVE"!==c||-1===a.toString().indexOf(b.toString())};let k=[];if(e&&e.indexOf&&(0<=e.indexOf("|")||0<=e.indexOf(" AND ")||0<=e.indexOf(" OR ")||0<=e.indexOf(" and ")||0<=e.indexOf(" or "))){let a=h(g,e);if(a)return a;const b=0<=e.indexOf(" and ")?e.split(" and "):[],c=0<=e.indexOf(" or ")?e.split(" or "):[],d=0<=e.indexOf("|")?e.split("|"):[];let f=0<=e.indexOf(" AND ")?e.split(" AND "):[],j=0<=e.indexOf(" OR ")?e.split(" OR "):[];if(f=f.concat(b),j=j.concat(c),0<d.length)for(let a=0;a<d.length;a++)d[a]=d[a].trim;if(j=j.concat(d),0<f.length)for(let a=0;a<f.length;a++)0<=!f[a].indexOf(" OR ")&&k.push(f[a]);if(0<j.length)for(let a=0;a<j.length;a++)0<=!j[a].indexOf(" AND ")&&k.push(j[a]);let i;for(let b=0;b<k.length;b++){const c=k[b];if(c&&c.indexOf&&0<=c.indexOf("..")){const b=c.toString().split("..");2===b.length&&(a=g>=b[0]&&g<=b[1])}else a=h(g,c);const d=b<f.length?"and":"or";i=void 0===i?a:"or"==d?i||a:i&&a}return i}return e&&e.indexOf&&0<=e.indexOf("..")&&(k=e.toString().split(".."),2===k.length)?g>=k[0]&&g<=k[1]:h(g,e)}evaluateTimeOnly(a){const b=this,c=b.value;if(!c)return!a;if(!a||!(a instanceof Date))return!1;const d=a.getHours(),e=c.getHours();if(d!==e)return!1;const f=a.getMinutes(),g=c.getMinutes();if(f!==g)return!1;const h=a.getSeconds(),i=c.getSeconds();return!(h!==i)}}),Smart.Utilities.Assign("CustomFilter",class{constructor(a,b,c){const d=this;d.value=a,d.condition=b,d.customfilter=c}evaluate(a){const b=this;return b.customfilter(b.value,a,b.condition)}}),Smart.FilterGroup=Smart.Utilities.FilterGroup,Smart.StringFilter=Smart.Utilities.StringFilter,Smart.NumericFilter=Smart.Utilities.NumericFilter,Smart.DateFilter=Smart.Utilities.DateFilter,Smart.CustomFilter=Smart.Utilities.CustomFilter;