
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Cell",class{constructor(a,b){const c=this;c.row=a,c.column=b,c.grid=a.grid,c.rowSpan=1,c.colSpan=1,c.value=void 0,c.fontSize=null,c.fontWeight=null,c.fontFamily=null,c.fontStyle=null,c.color=null,c.background=null,c.borderColor=null,c.tooltip=null,c.align=null,c.verticalAlign=null,c.readonly=!1,c.oldValue=void 0,c._updating=!1,c.styleChanged=!0,c.editor=null,c.template=null,c.isEditing=!1,c.canNotify=!0,c.selected=!1,c.focused=!1;const d=new Proxy(c,{deleteProperty:function(a,b){return delete a[b],!0},get:function(a,b){if("value"===b){const a=c.column.displayField?c.row.data[c.column.displayField]:c.row.data[c.column.dataField];return a}if("editor"===b||"template"===b)return a[b]||c.column[b];if("focused"===b){if(c.grid.selection.allowCellSelection&&c.grid._selection.focusedCell&&c.grid._selection.focusedCell.row.id===c.row.id&&c.grid._selection.focusedCell.column.dataField===c.column.dataField)return!0;if(c.grid.selection.allowRowSelection&&c.grid._selection.focusedCell&&c.grid._selection.focusedCell.row.id===c.row.id&&c.grid._selection.focusedCell.column.dataField===c.column.dataField)return!0;const a=c.parent();return!!(a&&c.grid.selection.allowCellSelection&&c.grid._selection.focusedCell&&c.grid._selection.focusedCell.row.id===a.row.id&&c.grid._selection.focusedCell.column.dataField===a.column.dataField)}if("selected"===b)return!0===c.row.getProperty("selected")||!0===c.column.getProperty("selected")||!!c.grid._selection.cells["row"+c.row.id]&&c.grid._selection.cells["row"+c.row.id][c.column.dataField];if("modifiedValue"===b){const b=c.grid._cellsUpdatedValues[c.row.id+"_"+c.column.dataField];return void 0===b?a.value:b}return a[b]},set:function(a,b,d){const e=this.get(a,b);if(e===d)return!0;if(a[b]=d,"element"===b||"isEditing"===b||"oldValue"===b||"_updating"===b||"notifyFn"===b||b.startsWith("_")||"canNotify"===b)return!0;if("focused"===b&&(c.grid._selection.focusedCell=c),("colSpan"===b||"rowSpan"===b)&&0<=d&&-1===c.grid._cellsMerge.indexOf(c)&&c.grid._cellsMerge.push(c),"row"===b||"column"===b||"grid"===b||"styleChanged"===b)return!0;if(("background"===b||"fontSize"===b||"fontWeight"===b||"fontFamily"===b||"color"===b||"borderColor"===b||"fontStyle"===b)&&(c._styleChanged=!0),"value"===b){void 0===c.oldValue&&(c.oldValue=e);(()=>{c.grid.dataSource.boundSource.canNotify=!1,null!==d&&d.label&&d.value?(c.row.data[c.column.displayField]=d.label,c.row.data[c.column.dataField]=d.value):(c.column.valueField&&(c.row.data[c.column.valueField]=d),c.row.data[c.column.dataField]=d);const a=c.grid.dataSource.dataItemById[c.row.id];if(a){const b=a.$.index;d!==c.grid.dataSource[b][c.column.dataField]&&(c.grid.dataSource[b][c.column.dataField]=d)}c.grid.dataSource.boundSource.canNotify=!0})()}return("selected"===b&&(c.grid._selection.cells["row"+c.row.id]&&(delete c.grid._selection.cells["row"+c.row.id][c.column.dataField],1===Object.getOwnPropertyNames(c.grid._selection.cells["row"+c.row.id]).length&&delete c.grid._selection.cells["row"+c.row.id]),c.grid._selection.cells["column"+c.column.dataField]&&(delete c.grid._selection.cells["column"+c.column.dataField][c.row.id],1===Object.getOwnPropertyNames(c.grid._selection.cells["column"+c.column.dataField]).length&&delete c.grid._selection.cells["column"+c.column.dataField]),d&&(!c.grid._selection.cells["row"+c.row.id]&&(c.grid._selection.cells["row"+c.row.id]=[]),!c.grid._selection.cells["column"+c.column.dataField]&&(c.grid._selection.cells["column"+c.column.dataField]=[]),c.grid._selection.cells["row"+c.row.id][c.column.dataField]=!0,c.grid._selection.cells["column"+c.column.dataField][c.row.id]=!0)),c._updating||!c.canNotify)||!c.row.canNotify||(c.grid._recycle(),c.propertyChanged&&c.propertyChanged(name.substring(1),e),!0)}});return d}setStyle(a){const b=this;b._styleChanged&&(a.style.background=b.background,a.style.borderColor=b.borderColor,a.style.color=b.color,a.style.fontSize=b.fontSize,a.style.fontFamily=b.fontFamily,a.style.fontWeight=b.fontWeight,a.style.fontStyle=b.fontStyle,a.style.paddingBottom="",b._styleChanged=!1)}getFormattedValue(a,b){const c=this;return void 0===a||null===a||""===a?a:"date"===c.column.dataType||"datetime"===c.column.dataType||"time"===c.column.dataType?c.formatDate(a,b):"int"===c.column.dataType||"int64"===c.column.dataType||"float"===c.column.dataType||"number"===c.column.dataType?c.formatNumber(a,b):a}formatDate(a,b){if(!Smart.Utilities.DateTime)return a;const c=this,d=c.grid;if(c.column.formatSettings.Intl&&c.column.formatSettings.Intl.DateTimeFormat){const b=new Intl.DateTimeFormat(this.grid.locale,c.column.formatSettings.Intl.DateTimeFormat).format(a);return b}!b&&c.column.formatSettings.dateFormat&&(b=c.column.formatSettings.dateFormat);try{const c=new Smart.Utilities.DateTime(a);return c.calendar.locale=d.locale,d.messages[d.locale]&&d.messages[d.locale].calendar&&(d.messages[d.locale].calendar.months&&(c.calendar.months=d.messages[d.locale].calendar.months),d.messages[d.locale].calendar.days&&(c.calendar.days=d.messages[d.locale].calendar.days),void 0!==d.messages[d.locale].calendar.firstDay&&(c.calendar.firstDay=d.messages[d.locale].calendar.firstDay),void 0!==d.messages[d.locale].calendar.eras&&(c.calendar.eras=d.messages[d.locale].calendar.eras),void 0!==d.messages[d.locale].calendar.AM&&(c.calendar.AM=d.messages[d.locale].calendar.AM),void 0!==d.messages[d.locale].calendar.PM&&(c.calendar.PM=d.messages[d.locale].calendar.PM),void 0!==d.messages[d.locale].calendar["/"]&&(c.calendar["/"]=d.messages[d.locale].calendar["/"]),void 0!==d.messages[d.locale].calendar[":"]&&(c.calendar[":"]=d.messages[d.locale].calendar[":"])),c.toString(b)}catch(b){return a}}formatNumber(a,b){if(!Smart.Utilities.NumberRenderer)return a;const c=this,d=c.grid;if(c.column.formatSettings.Intl&&c.column.formatSettings.Intl.NumberFormat){const b=new Intl.NumberFormat(this.grid.locale,c.column.formatSettings.Intl.NumberFormat).format(a);return b}const e=new Smart.Utilities.NumberRenderer;if(e.localizationObject){const a=c.column.formatSettings,b=d.messages[d.locale]?d.messages[d.locale].calendar:{};a.decimalPlaces&&(e.localizationObject.decimalPlaces=a.decimalPlaces),(a.decimalSeparator||b.decimalSeparator)&&(e.localizationObject.decimalSeparator=a.decimalSeparator||b.decimalSeparator),(a.thousandsSeparator||b.thousandsSeparator)&&(e.localizationObject.thousandsSeparator=a.thousandsSeparator||b.thousandsSeparator),e.localizationObject.currencysymbol=b.currencySymbol,e.localizationObject.currencysymbolposition=b.currencySymbolPosition,a.prefix&&(e.localizationObject.currencysymbol=a.prefix),a.sufix&&(e.localizationObject.currencysymbol=a.sufix,e.localizationObject.currencysymbolposition="after")}const f=e.formatNumber(a,b);return void 0===f?a:0>a&&c.column.formatSettings.negativeWithBrackets?"("+f+")":f}refresh(){const a=this;if(a.element){const b=a.element.firstChild;a.setStyle(b)}}setProperties(a){const b=this;for(let c in b._updating=!0,a)b[c]=a[c];b._updating=!1,b.grid._recycle()}createElement(){const a=this,b=document.createElement("smart-grid-cell");return b.setAttribute("role","gridcell"),a.element=b,b._initialize(a),b}render(){const a=this;a.element&&a.element._render()}parent(a){const b=this,c=b.row,d=b.column.dataField,e=b.grid;if(!e._cellsMerge.length)return null;if(b.__parentCells&&void 0!==b.__parentCells["row"+c.id+"_column_"+d])return b.__parentCells["row"+c.id+"_column_"+d];let f=e.getVisibleRows();e.paging.enabled&&"page"===e.selection.selectAllMode&&(f=f.slice(e.paging.pageIndex*e.paging.pageSize,(e.paging.pageIndex+1)*e.paging.pageSize)),b.__parentCells||(b.__parentCells=[]);for(let g=0;g<e._cellsMerge.length;g++){const h=e._cellsMerge[g];let i=[],j=[];if(i.push(h.row),1<h.rowSpan){const a=f.indexOf(h.row);if(0<=a)for(let b=a;b<a+h.rowSpan;b++)f[b]&&-1===i.indexOf(f[b])&&i.push(f[b])}if(j.push(h.column.dataField),1<h.colSpan){const a=e.columns.indexOf(e.columnByDataField[h.column.dataField]);for(let b=a;b<a+h.colSpan;b++)e.columns[b]&&-1===j.indexOf(e.columns[b].dataField)&&j.push(e.columns[b].dataField)}if(0<=i.indexOf(c)&&0<=j.indexOf(d)){if(a){const a={cell:h.row.getCell(h.column.dataField),rows:i,columns:j,row:h.row,column:h.column,endRow:i[i.length-1],endColumn:e.columnByDataField[j[j.length-1]]};return b.__parentCells["row"+c.id+"_column_"+d]=a,a}const f=h.row.getCell(h.column.dataField);return b.__parentCells["row"+c.id+"_column_"+d]=f,f}}return b.__parentCells["row"+c.id+"_column_"+d]=null,null}}),Smart("smart-grid-cell",class extends Smart.BaseElement{static get properties(){return{}}get hasStyleObserver(){return!1}get enableShadowDOM(){return!1}addThemeClass(){}addDefaultClass(){}get isUtilityElement(){return!0}_refresh(){const a=this;a.innerHTML="",a._initialize(a.cell)}_initialize(a){const b=this,c=document.createElement("div"),d=a.column,e=a.row,f=a.grid;b.cell=a,b.appendChild(c);let g=!1;if(d&&d._treeColumn&&f.dataSource.boundHierarchy&&(g=!0,!f.grouping.enabled&&f.dataSource.groupBy&&0<f.dataSource.groupBy.length&&(g=!1)),g){const a=document.createElement("div"),d=document.createElement("button"),g=document.createElement("div"),h=document.createElement("div"),i=document.createElement("div"),j=document.createElement("span");return e.expanded?d.setAttribute("toggled",""):d.removeAttribute("toggled",""),b.toggleButton=d,b.checkbox=i,c.appendChild(a),c.appendChild(h),h.setAttribute("content",""),a.setAttribute("indent",""),g.setAttribute("label",""),d.setAttribute("toggle-button",""),i.setAttribute("checkbox",""),i.setAttribute("role","checkbox"),b.setAttribute("has-toggle-button",""),h.appendChild(d),h.appendChild(i),j.classList.add("smart-input"),i.appendChild(j),f.checkBoxes.visible?j.classList.remove("smart-hidden"):j.classList.add("smart-hidden"),h.appendChild(g),b.content=g,void(b.isRendered=!0)}else{const a=document.createElement("div");c.appendChild(a)}b.content=c,b.isRendered=!0}_renderCommands(){const a=this,b=a.cell.grid;if(b.__cellsCommandTemplate)return a.firstChild.innerHTML=b.__cellsCommandTemplate,void b._updateCommandColumnCommandsVisibility(a.firstChild,a.cell.row);const c=b._getCommandColumnCommandsTemplate();a.firstChild.innerHTML=c,b._updateCommandColumnCommandsVisibility(a.firstChild,a.cell.row),b.__cellsCommandTemplate=c}_renderGroupCell(){const a=this,b=a.cell.grid,c=a.cell.column,d=a.cell.row;[...a.attributes].forEach(b=>a.removeAttribute(b.name)),a.style.width!==c.computedWidth+"px"&&(a.style.width=c.computedWidth+"px"),b.rightToLeft?a.style.right!==c.left+"px"&&(a.style.right=c.left+"px"):a.style.left!==c.left+"px"&&(a.style.left=c.left+"px"),a.classList.contains("smart-hidden")&&a.classList.remove("smart-hidden"),c.autoGenerated&&(a.style.width="0px");let e=d.label;if(void 0!==d.label){let f="";if(b.grouping.summaryRow.visible){const a=function(b,c,d){for(let e=0;e<c.length;e++){const f=c[e];(void 0!==f[b]&&d.push(f),!f.summaryRow)&&(f.children?a(b,f.children,d):f.data&&f.data.children&&a(b,f.children,d))}return d},e=a(c.dataField,d.summaryRow?d.parent.data.children:d.data.children,[]),g={},h=c._treeColumn?0<c.summary.length?c.summary:["count"]:c.summary;g[c.dataField]=h;const j=0<h.length?b.dataSource.summarize([g],e):null;if(j)for(let a=0;a<h.length;a++){const d=h[a];f+="<span summary>"+b.localize(d,{value:j[c.dataField][d]}),+"</span>"}}c._treeColumn?(e=d.summaryRow?"<div header><span group></span><span value></span></div>":"<div header><span group>"+b.columnByDataField[d.groupDataField].label+"</span><span value>"+d.label+"</span></div>",f&&(e+="<div summary>",e+=f,e+="</div>"),a.setAttribute("has-toggle-button","")):(a.removeAttribute("has-toggle-button",""),e="<div content><div label><div header><span group></span><span value></span></div>",f&&(e+="<div summary>",e+=f,e+="</div>"),e+="</div></div>")}const f=a.firstChild;if(b.dataSource.boundHierarchy&&c._treeColumn){const g=f.children[0],h=f.children[1].children[0],i=f.children[1].children[1].firstChild,j=f.children[1].children[2];g.setAttribute("indent",""),d.checked?i.setAttribute("checked",""):!1===d.checked?i.removeAttribute("checked"):null===d.checked&&i.setAttribute("checked","indeterminate"),d.leaf?h.classList.add("smart-visibility-hidden"):(h.classList.remove("smart-visibility-hidden"),d.expanded?h.setAttribute("toggled",""):h.removeAttribute("toggled",""));let k="";if(c._treeColumn?a.toggleButton.classList.remove("smart-hidden"):a.toggleButton.classList.add("smart-hidden"),c._treeColumn)if(b.grouping.enabled&&0<b.dataSource.groupBy.length){let a=d.level;void 0===d.label&&a--,k+="<div style=\"width: "+(1+a)*b.grouping.groupIndent+"px;\"></div>"}else for(let a=0;a<d.level;a++)k+="<div class='smart-indent'></div>";void 0===d.label?h.classList.add("smart-hidden"):(h.classList.remove("smart-hidden"),h.style.marginLeft="",c._treeColumn&&b.grouping.enabled&&0<b.grouping.toggleButtonIndent&&(h.style.marginLeft=d.level*(b.grouping.toggleButtonIndent-b.grouping.groupIndent)+"px")),g.innerHTML=k,j.innerHTML=e,b.appearance.showTooltips?j.setAttribute("title",d.label?d.label:e):j.hasAttribute("title")&&j.removeAttribute("title")}else void 0!==d.label&&b.grouping.enabled&&!c._treeColumn&&(f.innerHTML=e);if(b.grouping.enabled&&b.dataSource.groupBy&&0<b.dataSource.groupBy.length){const e=b.grouping.groupIndent*(1+d.level);c.dataField===b.columns[b.columns.length-1].dataField&&(a.style.width=c.computedWidth-e+"px",b.appearance.showColumnLines&&f.firstChild.classList.add("smart-grid-column-border"))}if("smart-label"!==f.className&&(f.className="smart-label"),c.formatFunction){const b={row:d,column:c,cell:a.cell,value:null,template:null,group:{value:e,template:null}};c.formatFunction(b),b.group.value!==e&&(f.innerHTML=b.group.value),null!==b.group.template&&(f.innerHTML=b.group.template)}}_render(){var a=Math.floor;const b=this,c=b.cell.grid,d=b.cell.column,e=b.cell.row,f=e.data,g=e._isMeasureRow?null:d.cellsFormat;if(c.grouping.enabled&&0<c.dataSource.groupBy.length&&void 0!==e.label)return void b._renderGroupCell();if(c.grouping.enabled&&0<c.dataSource.groupBy.length&&b.toggleButton&&(b.toggleButton.classList.remove("smart-hidden"),b.toggleButton.classList.remove("smart-visibility-hidden"),b.toggleButton.style.marginLeft="",d._treeColumn&&c.grouping.enabled&&0<c.grouping.toggleButtonIndent&&(b.toggleButton.style.marginLeft=e.level*(c.grouping.toggleButtonIndent-c.grouping.groupIndent)+"px")),!d.visible)return void(b.style.width="0px");c.appearance.showSortColumnBackground?d.sorted?b.setAttribute("sort",""):b.removeAttribute("sort"):d.sorted&&b.hasAttribute("sort")&&b.removeAttribute("sort"),c.appearance.showFilterColumnBackground?d.filtered?b.setAttribute("filter",""):b.removeAttribute("filter"):d.filtered&&b.hasAttribute("filter")&&b.removeAttribute("filter"),c.dataSource.boundHierarchy&&b.hasAttribute("has-toggle-button")&&!d._treeColumn&&b.removeAttribute("has-toggle-button");let h=d.displayField?f[d.displayField]:f[d.dataField];if(c.editing.batch){if(c._cellsUpdatedValues){b.removeAttribute("update");const a=c._cellsUpdatedValues[e.id+"_"+d.dataField];void 0!==a&&(b.setAttribute("update",""),h=a)}c._rowsDeleted&&(0<=c._rowsDeleted.indexOf(e)?b.setAttribute("delete",""):b.removeAttribute("delete")),c._rowsAdded&&(0<=c._rowsAdded.indexOf(e.id)?b.setAttribute("add",""):b.removeAttribute("add"))}c.onCellValue&&!(d.rowHeaderColumn||d.selectionColumn)&&(b.cell._updating=!0,c.onCellValue(b.cell),b.cell._updating=!1,h=b.cell.value),void 0===h&&(h="");let i=h;g&&(i=b.cell.getFormattedValue(h,g));const j=b.firstChild;(c.onCellRender||d.onCellRender)&&requestAnimationFrame(function(){if(d._cellsCachedValues||(d._cellsCachedValues=[]),d._cellsCachedValues[e.index]){const a=d._cellsCachedValues[e.index];j.firstChild&&j.removeChild(j.firstChild),j.appendChild(a)}else if(c.onCellRender?c.onCellRender(b.cell):d.onCellRender(b.cell),b.cell.template!==d.template){const a=document.createElement("div");return j.firstChild&&j.removeChild(j.firstChild),b.cell.template instanceof HTMLTemplateElement?a.appendChild(b.cell.template.cloneNode(!0)):a.appendChild(b.cell.template),j.appendChild(a),void(d._cellsCachedValues[e.index]=a)}}),d.autoGenerated||b.setAttribute("data-field",d.dataField),b.cell.focused?(c.selection.allowCellSelection&&b.setAttribute("focus",""),e.element.setAttribute("focus",""),!b.cell.id&&(b.id="gridcell_"+a(65536*(1+Math.random())).toString(16).substring(1)),c.setAttribute("aria-activedescendant",b.id)):b.removeAttribute("focus"),b.cell.selected?(b.setAttribute("selected",""),b.setAttribute("aria-selected",!0)):(b.removeAttribute("selected"),b.removeAttribute("aria-selected")),c.rowDetail.enabled&&e.showDetail&&(b.style.height=e.cellHeight+"px",b.style.lineHeight=e.cellHeight+"px"),e.expanded&&0<e.expandHeight&&(b.style.height=e.cellHeight+"px",b.style.lineHeight=e.cellHeight+"px");const k=b._getCellAlignment(e,d),l=""!==b.cell.template&&c.isInitialized&&!e._isMeasureRow;let m="";if(k.align&&(m+=k.align+" "),k.verticalAlign&&(m+=k.verticalAlign+" "),d.cellsWrap&&(m+="wrap "),m+="smart-label",b.style.width!==d.computedWidth+"px"){const a=c._isLastVisibleColumn(d);b.style.width=d.autoGenerated||a?d.computedWidth+"px":d.computedWidth-c._columnGap+"px"}if(c.grouping.enabled&&c.dataSource.groupBy&&0<c.dataSource.groupBy.length){const a=c.grouping.groupIndent*(1+e.level);d.dataField===c.columns[c.columns.length-1].dataField&&(b.style.width=d.computedWidth-a+c.grouping.groupIndent+"px",c.appearance.showColumnLines&&b.classList.add("smart-grid-column-border"))}d===c._firstVisibleColumn?b.classList.add("smart-grid-column-border-collapse"):b.classList.remove("smart-grid-column-border-collapse"),0<c._columnGap&&c.appearance.showColumnLines&&b.classList.add("smart-grid-column-border"),0<c._rowGap&&b.classList.add("smart-grid-row-border"),c.appearance.showColumnLines?b.classList.remove("smart-grid-vertical-border-collapse"):b.classList.add("smart-grid-vertical-border-collapse"),c.appearance.showRowLines?b.classList.remove("smart-grid-horizontal-border-collapse"):b.classList.add("smart-grid-horizontal-border-collapse");let n=d.left;if(c.rightToLeft?b.style.right!==n+"px"&&(b.style.right=n+"px"):b.style.left!==n+"px"&&(b.style.left=n+"px"),b.classList.contains("smart-hidden")&&b.classList.remove("smart-hidden"),b.hasAttribute("template")&&b.removeAttribute("template"),b.hasAttribute("freeze")&&b.removeAttribute("freeze"),b.hasAttribute("detail")&&b.removeAttribute("detail"),e.filterRow?b.classList.add("smart-grid-filter-row-cell"):e.summaryRow?b.classList.add("smart-grid-summary-row-cell"):(d.freeze||e.freeze)&&(d.selectionColumn&&(b.setAttribute("checkbox",""),m+=" smart-input",d.grid.selection.checkBoxes.enabled&&d.grid.selection.checkBoxes.autoShow?b.setAttribute("auto-show",""):b.removeAttribute("auto-show")),(d.rowHeaderColumn||d.selectionColumn)&&(b.setAttribute("header",""),b.setAttribute("role","rowheader")),d.rowDetailColumn&&(b.setAttribute("header",""),b.setAttribute("detail",""),b.setAttribute("has-toggle-button","")),d.commandColumn&&b.setAttribute("command",""),c.appearance.showFrozenColumnBackground&&d.freeze&&b.setAttribute("freeze",""),c.appearance.showFrozenRowBackground&&e.freeze&&b.setAttribute("freeze","")),d.cellsRotationAngle){const a=b._rotateCellContent(j,d,h);if(!a)return}else if(e.filterRow)d.toggleColumn||d.rowHeaderColumn?j.innerHTML="":!d.filterEditorInitialized&&(d.filterEditorInitialized=!0);else if(e.summaryRow){if(d.toggleColumn||d.rowHeaderColumn)j.innerHTML="";else if(0<d.summary.length&&c._summaryItems){const a=c._summaryItems[d.dataField];let b=0;for(let d in a)b===e.summaryRowIndex&&(j.innerHTML=c.localize(d,{value:a[d]})),b++}}else if(c.rowDetail.enabled&&d.rowDetailColumn)""!==j.innerHTML&&(j.innerHTML=e.showDetail?"<button class=\"smart-animate\" toggled toggle-button></button>":"<button class=\"smart-animate\" toggle-button></button>",e.element.toggleDetailButton=b.querySelector("button"));else if(d.commandColumn)b._renderCommands();else if(c.appearance.showRowHeaderNumber&&d.rowHeaderColumn){if(e.addNewRow)j.textContent="";else{const d=d=>{if(b.cell.value)return b.cell.value;if("number"===c.appearance.autoGenerateRowLabelMode)return d.visibleIndex+1;else{const b=d.visibleIndex%26,c=a(d.visibleIndex/26),e=String.fromCharCode(65+b);let f="";for(let a=0;a<c;a++)f+="A";const g=f+e;return g}};j.textContent=c._rowsAdded?0<=c._rowsAdded.indexOf(e.id)?"":d(e):d(e)}}else if(l)switch(b.removeAttribute("readonly"),b.cell.template){case"checkBox":case"switchButton":case"radioButton":""!==j.textContent&&(j.textContent=""),(!c.editing.enabled||!d.allowEdit||b.cell.readonly||c.editing.enabled&&c.editing.commandColumn.visible&&c.editing.editRow!==b.cell.row)&&b.setAttribute("readonly",""),"<span class=\"smart-input\"></span>"!==j.innerHTML&&(j.innerHTML="<span class=\"smart-input\"></span>"),h?j.firstChild.setAttribute("checked",""):null===h?j.firstChild.setAttribute("checked","indeterminate"):j.firstChild.removeAttribute("checked"),b.setAttribute("template",b.cell.template);break;default:{let a=null;if(b.setAttribute("template",""),"function"==typeof b.cell.template){const a={row:e,column:d,cell:b.cell,oldValue:b.cell.oldValue,value:h,template:null};let c=j.querySelector(".smart-grid-cell-template");if(c&&c.getAttribute("column")===d.dataField?a.template=c.firstElementChild:c=null,b.formattedValue!==i&&(c=null),c||b.cell.template(a),c||!a.template)c||null!==a.template||(j.innerHTML=h);else if(a.template instanceof HTMLElement){const b=document.createElement("div");b.classList.add("smart-grid-cell-template"),b.setAttribute("column",d.dataField),j.innerHTML="",j.appendChild(b),b.appendChild(a.template)}else j.innerHTML="<div column=\""+d.dataField+"\" class=\"smart-grid-cell-template\">"+a.template+"</div>";b.cell._styleChanged&&b.cell.setStyle(j),void 0===b.cell.oldValue&&(b.cell.oldValue=h),b.formattedValue=i}else if(""!==j.textContent&&(j.textContent=""),b.cell.template.startsWith("#")&&(a=document.querySelector(b.cell.template)),a){const b=a.content.cloneNode(!0).firstElementChild;h=h.toString(),h=h.replace(/'/ig,"\\'"),h=h.replace(/"/ig,"\\\"");let c=b.outerHTML.replace(/{{value}}/ig,h).replace(/{{id}}/ig,e.id);0<=c.indexOf("{{value=")&&(h?(c=c.substring(0,c.indexOf("{{value="))+h+c.substring(c.indexOf("}")),c=c.replace(/}/ig,""),c=c.replace(/{/ig,"")):(c=c.replace(/{{value=/ig,""),c=c.replace(/}}/ig,""))),j.innerHTML!==c&&(j.innerHTML=c)}else{const a=b.cell.template.replace(/{{value}}/ig,h).replace(/{{id}}/ig,e.id);j.innerHTML!==a&&(j.innerHTML=a)}}}else if(d.selectionColumn)"checkBox"===c.selectionMode&&(e.getProperty("selected")?(b.setAttribute("selected",""),b.element.setAttribute("aria-selected",!0)):b.getAttribute("selected")&&(b.removeAttribute("selected"),b.element.removeAttribute("aria-selected")));else{const a=j.firstChild;if(a&&a.classList&&b.toggleButton&&d._treeColumn){const a=j.children[0],f=j.children[1].children[0],g=j.children[1].children[1].firstChild,h=j.children[1].children[2];let k="";if(d._treeColumn){if(c.grouping.enabled){let a=e.level-1;k+="<div style=\"width: "+(1+a)*c.grouping.groupIndent+"px;\"></div>"}else for(let a=0;a<e.level;a++)k+="<div class='smart-indent'></div>";e.checked?g.setAttribute("checked",""):!1===e.checked?g.removeAttribute("checked"):null===e.checked&&g.setAttribute("checked","indeterminate"),e.leaf?e.allowCheck?g.classList.remove("smart-visibility-hidden"):g.classList.add("smart-visibility-hidden"):e.allowCheck?g.classList.remove("smart-hidden"):g.classList.add("smart-hidden")}e.allowCheck?c.checkBoxes.visible?g.classList.remove("smart-hidden"):g.classList.add("smart-hidden"):!c.checkBoxes.visible&&g.classList.add("smart-hidden"),a.innerHTML=k,f.classList.add("smart-visibility-hidden"),e.leaf?f.classList.add("smart-visibility-hidden"):(f.classList.remove("smart-visibility-hidden"),e.expanded?f.setAttribute("toggled",""):f.removeAttribute("toggled","")),e.data.isEmpty&&f.classList.add("smart-visibility-hidden"),h.innerHTML=i,c.appearance.showRowHeaderNumber&&c.grouping.enabled&&0<c.dataSource.groupBy.length&&(i="<span visible-index>"+(1+e.visibleIndex)+"</span> "+i),c.rowDetail.enabled&&c.grouping.enabled&&0<c.dataSource.groupBy.length&&(h.innerHTML="<button class=\"inline smart-animate\" toggled toggle-button></button>"+i,e.element.toggleDetailButton=b.querySelector("button.inline"),e.element.toggleDetailButton.setAttribute("title",c.localize(e.showDetail?"collapseRow":"expandRow",{elementType:"Grid"})),e.element.toggleDetailButton.onpointerdown=function(){e.showDetail=!e.showDetail}),c.appearance.showTooltips?h.setAttribute("title",i):h.hasAttribute("title")&&h.removeAttribute("title")}else{const a=e["column_"+d.dataField];if(b.getAttribute("rowspan")&&(b.removeAttribute("rowspan"),b.removeAttribute("aria-rowspan"),b.style.height=""),b.getAttribute("colspan")&&(b.removeAttribute("colspan"),b.removeAttribute("aria-colspan")),a){if(1<a.colSpan){const e=c.columns.indexOf(d);let f=0;for(let b=e;b<e+a.colSpan;b++){const a=c.columns[b];a&&a.visible&&(f+=a.computedWidth)}b.style.width=f+"px",b.setAttribute("colspan",""),b.setAttribute("aria-colspan",a.colSpan),a._styleChanged=!0}if(1<a.rowSpan){const d=c.rows.indexOf(e);let f=0;e.element.setAttribute("rowspan","");for(let b=d;b<=d+a.rowSpan-1;b++){const a=c.rows[b];a&&a.visible&&a.filtered&&(f+=a.cellHeight)}b.style.height=f+"px",b.setAttribute("rowspan",""),b.setAttribute("aria-rowspan",a.rowSpan),a._styleChanged=!0}(1===a.colSpan&&b.hasAttribute("colspan")||b.hasAttribute("rowspan")&&1===a.rowSpan)&&(b.style.height="",b.style.width="",b.removeAttribute("colspan"),b.removeAttribute("rowspan"),b.removeAttribute("aria-rowspan"),b.removeAttribute("aria-colspan"),a._styleChanged=!0),j.textContent===i||d.formatFunction||(j.textContent=i),a.setStyle(j),c.appearance.showTooltips?j.setAttribute("title",a.tooltip||i):j.hasAttribute("title")&&j.removeAttribute("title")}else j.textContent=i}}if(j.className!==m&&(j.className=m),d.formatFunction&&!e.data.isEmpty&&c.isInitialized){const a={row:e,column:d,cell:b.cell,oldValue:b.cell.oldValue,value:h,formattedValue:i,template:null};b.cell.canNotify=!1,e.canNotify=!1;const c=Object.assign({},{background:b.cell.background,borderColor:b.cell.borderColor,color:b.cell.color,fontSize:b.cell.fontSize,fontFamily:b.cell.fontFamily,fontWeight:b.cell.fontWeight,fontStyle:b.cell.fontStyle});d.formatFunction(a),(j.style.background!==c.background||j.style.borderColor!==c.borderColor||j.style.color!==c.color||j.style.fontSize!==c.fontSize||j.style.fontWeight!==c.fontWeight||j.style.fontStyle!==c.fontStyle)&&(b.cell._styleChanged=!0,b.cell.setStyle(j)),(b.cell.background!==c.background||b.cell.borderColor!==c.borderColor||b.cell.color!==c.color||b.cell.fontSize!==c.fontSize||b.cell.fontWeight!==c.fontWeight||b.cell.fontStyle!==c.fontStyle)&&(b.cell._styleChanged=!0,b.cell.setStyle(j));let f=!0;if(a.value!==h){if(b.toggleButton){const b=j.children[1].children[2];b.innerHTML=a.value}else j.innerHTML=a.value;f=!1}if(null!==a.template){if(b.toggleButton){const b=j.children[1].children[2];b.innerHTML!==a.template&&(b.innerHTML=a.template)}else if(j.innerHTML!==a.template){const b=document.createElement("div");b.innerHTML=a.template,b.innerHTML!==j.innerHTML&&(j.innerHTML=a.template)}f=!1}f&&(j.textContent=h),b.cell.canNotify=!0,e.canNotify=!0}}_rotateCellContent(a,b,c){const d=this,e=document.createElement("span");return a.innerHTML="",e.innerHTML=c,a.appendChild(e),e.className="rotate",e.style.transform="rotate("+b.cellsRotationAngle+"deg)",d.grid._recycleRotate(a,e,b.cellsAlign,b.cellsVerticalAlign,c)}_getCellAlignment(a,b){const c=a["column_"+b.dataField],d=c?c.verticalAlign||b.cellsVerticalAlign:b.cellsVerticalAlign;let e=c?c.align||b.cellsAlign:b.cellsAlign;const f={align:"",verticalAlign:""};return c.grid.rightToLeft&&("left"===e?e="right":"right"==e&&(e="left")),"left"===e?f.align="align-left":"center"===e||"middle"===e?f.align="align-center":"right"===e?f.align="align-right":void 0,("top"===d?f.verticalAlign="align-top":"center"===d||"middle"===d?f.verticalAlign="align-middle":"bottom"===d?f.verticalAlign="align-bottom":void 0,f)}template(){return""}_detach(){const a=this;a.element=null,a.cell=null}onDetached(){const a=this;a._detach()}});