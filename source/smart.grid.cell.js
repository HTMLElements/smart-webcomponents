
/* Smart UI v10.0.1 (2021-08-16) 
Copyright (c) 2011-2021 jQWidgets. 
License: https://htmlelements.com/license/ */ //

Smart.Utilities.Assign("Grid.Cell",class{constructor(e,t){const l=this;return l.row=e,l.column=t,l.grid=e.grid,l.rowSpan=1,l.colSpan=1,l.value=void 0,l.fontSize=null,l.fontWeight=null,l.fontFamily=null,l.fontStyle=null,l.color=null,l.background=null,l.borderColor=null,l.tooltip=null,l.align=null,l.verticalAlign=null,l.readonly=!1,l.oldValue=void 0,l._updating=!1,l.styleChanged=!0,l.editor=null,l.template=null,l.isEditing=!1,l.canNotify=!0,l.selected=!1,l.focused=!1,l.error=!1,new Proxy(l,{deleteProperty:function(e,t){return delete e[t],!0},get:function(e,t){if("value"===t)return l.column.displayField?l.row.data[l.column.displayField]:l.row.data[l.column.dataField];if("editor"===t||"template"===t)return e[t]||l.column[t];if("focused"===t){if(l.grid.selection.allowCellSelection&&l.grid._selection.focusedCell&&l.grid._selection.focusedCell.id===l.row.id&&l.grid._selection.focusedCell.dataField===l.column.dataField)return!0;if(l.grid.selection.allowRowSelection&&l.grid._selection.focusedCell&&l.grid._selection.focusedCell.id===l.row.id&&l.grid._selection.focusedCell.dataField===l.column.dataField)return!0;const e=l.parent();return!!(e&&l.grid.selection.allowCellSelection&&l.grid._selection.focusedCell&&l.grid._selection.focusedCell.id===e.row.id&&l.grid._selection.focusedCell.dataField===e.column.dataField)}if("selected"===t)return!0===l.row.getProperty("selected")||!0===l.column.getProperty("selected")||!!l.grid._selection.cells["row"+l.row.id]&&l.grid._selection.cells["row"+l.row.id][l.column.dataField];if("modifiedValue"===t){const t=l.grid._cellsUpdatedValues[l.row.id+"_"+l.column.dataField];return void 0!==t?t:e.value}return e[t]},set:function(e,t,i){const a=this.get(e,t);return a===i||(e[t]=i,!("element"!==t&&"isEditing"!==t&&"oldValue"!==t&&"_updating"!==t&&"notifyFn"!==t&&!t.startsWith("_")&&"canNotify"!==t)||("error"===t||("focused"===t&&(l.grid._selection.focusedCell={id:l.row.id,dataField:l.column.dataField,value:l.value,index:l.row.index}),"colSpan"!==t&&"rowSpan"!==t||i>=0&&-1===l.grid._cellsMerge.indexOf(l)&&l.grid._cellsMerge.push(l),"row"===t||"column"===t||"grid"===t||"styleChanged"===t||("background"!==t&&"fontSize"!==t&&"fontWeight"!==t&&"fontFamily"!==t&&"color"!==t&&"borderColor"!==t&&"fontStyle"!==t||(l._styleChanged=!0),"value"===t&&(void 0===l.oldValue&&(l.oldValue=a),(()=>{l.grid.dataSource.boundSource.canNotify=!1,null!==i&&i.label&&i.value?(l.row.data[l.column.displayField]=i.label,l.row.data[l.column.dataField]=i.value):(l.column.valueField&&(l.row.data[l.column.valueField]=i),l.row.data[l.column.dataField]=i);const e=l.grid.dataSource.dataItemById[l.row.id];if(e){const t=e.$.index;l.grid.dataSource&&i!==l.grid.dataSource.boundSource[t][l.column.dataField]&&(l.grid.dataSource.boundSource[t][l.column.dataField]=i)}l.grid.dataSource.boundSource.canNotify=!0})()),"selected"===t&&(l.grid._selection.cells["row"+l.row.id]&&(delete l.grid._selection.cells["row"+l.row.id][l.column.dataField],1===Object.getOwnPropertyNames(l.grid._selection.cells["row"+l.row.id]).length&&delete l.grid._selection.cells["row"+l.row.id]),l.grid._selection.cells["column"+l.column.dataField]&&(delete l.grid._selection.cells["column"+l.column.dataField][l.row.id],1===Object.getOwnPropertyNames(l.grid._selection.cells["column"+l.column.dataField]).length&&delete l.grid._selection.cells["column"+l.column.dataField]),i&&(l.grid._selection.cells["row"+l.row.id]||(l.grid._selection.cells["row"+l.row.id]=[]),l.grid._selection.cells["column"+l.column.dataField]||(l.grid._selection.cells["column"+l.column.dataField]=[]),l.grid._selection.cells["row"+l.row.id][l.column.dataField]=!0,l.grid._selection.cells["column"+l.column.dataField][l.row.id]=!0)),!(!l._updating&&l.canNotify&&l.row.canNotify&&(l.grid._recycle(),l.propertyChanged&&l.propertyChanged(name.substring(1),a),0))))))}})}setStyle(e){const t=this;t._styleChanged&&(e.style.background=t.background,e.style.borderColor=t.borderColor,e.style.color=t.color,e.style.fontSize=t.fontSize,e.style.fontFamily=t.fontFamily,e.style.fontWeight=t.fontWeight,e.style.fontStyle=t.fontStyle,e.style.paddingBottom="",t._styleChanged=!1)}getFormattedValue(e,t){const l=this;return null==e||""===e?e:t?"date"===l.column.dataType||"datetime"===l.column.dataType||"time"===l.column.dataType?"dateRangeInput"===l.column.editor.template?Array.isArray(e)?l.formatDate(e[0],t)+" - "+l.formatDate(e[1],t):l.formatDate(e,t)+" - "+l.formatDate(e,t):l.formatDate(e,t):"int"===l.column.dataType||"int64"===l.column.dataType||"float"===l.column.dataType||"number"===l.column.dataType?l.formatNumber(e,t):e:""+e}formatDate(e,t){if(!Smart.Utilities.DateTime)return e;const l=this,i=l.grid;if(l.column.formatSettings.Intl&&l.column.formatSettings.Intl.DateTimeFormat)return new Intl.DateTimeFormat(this.grid.locale,l.column.formatSettings.Intl.DateTimeFormat).format(e);!t&&l.column.formatSettings.dateFormat&&(t=l.column.formatSettings.dateFormat);try{const l=new Smart.Utilities.DateTime(e);return l.calendar.locale=i.locale,i.messages[i.locale]&&i.messages[i.locale].calendar&&(i.messages[i.locale].calendar.months&&(l.calendar.months=i.messages[i.locale].calendar.months),i.messages[i.locale].calendar.days&&(l.calendar.days=i.messages[i.locale].calendar.days),void 0!==i.messages[i.locale].calendar.firstDay&&(l.calendar.firstDay=i.messages[i.locale].calendar.firstDay),void 0!==i.messages[i.locale].calendar.eras&&(l.calendar.eras=i.messages[i.locale].calendar.eras),void 0!==i.messages[i.locale].calendar.AM&&(l.calendar.AM=i.messages[i.locale].calendar.AM),void 0!==i.messages[i.locale].calendar.PM&&(l.calendar.PM=i.messages[i.locale].calendar.PM),void 0!==i.messages[i.locale].calendar["/"]&&(l.calendar["/"]=i.messages[i.locale].calendar["/"]),void 0!==i.messages[i.locale].calendar[":"]&&(l.calendar[":"]=i.messages[i.locale].calendar[":"])),l.toString(t)}catch(t){return e}}formatNumber(e,t){if(!Smart.Utilities.NumberRenderer)return e;const l=this,i=l.grid;if(l.column.formatSettings.Intl&&l.column.formatSettings.Intl.NumberFormat)return new Intl.NumberFormat(this.grid.locale,l.column.formatSettings.Intl.NumberFormat).format(e);const a=new Smart.Utilities.NumberRenderer;if(a.localizationObject){const e=l.column.formatSettings,t=i.messages[i.locale]?i.messages[i.locale].calendar:{};e.decimalPlaces&&(a.localizationObject.decimalPlaces=e.decimalPlaces),(e.decimalSeparator||t.decimalSeparator)&&(a.localizationObject.decimalSeparator=e.decimalSeparator||t.decimalSeparator,a.localizationObject.decimalseparator=a.localizationObject.decimalSeparator),(e.thousandsSeparator||t.thousandsSeparator)&&(a.localizationObject.thousandsSeparator=e.thousandsSeparator||t.thousandsSeparator,a.localizationObject.thousandsseparator=a.localizationObject.thousandsSeparator),a.localizationObject.currencysymbol=t.currencySymbol,a.localizationObject.currencysymbolposition=t.currencySymbolPosition,e.prefix&&(a.localizationObject.currencysymbol=e.prefix),e.sufix&&(a.localizationObject.currencysymbol=e.sufix,a.localizationObject.currencysymbolposition="after")}const n=a.formatNumber(e,t);return void 0===n?e:e<0&&l.column.formatSettings.negativeWithBrackets?"("+n+")":n}refresh(){const e=this;if(e.element){const t=e.element.firstChild;e.setStyle(t)}}autoWrap(){const e=this;e.element&&e.element._autoWrap()}setProperties(e){const t=this;t._updating=!0;for(let l in e)t[l]=e[l];t._updating=!1,t.grid._recycle()}createElement(){const e=document.createElement("smart-grid-cell");return e.setAttribute("role","gridcell"),this.element=e,e._initialize(this),e}render(){this.element&&this.element._render()}parent(e){const t=this,l=t.row,i=t.column.dataField,a=t.grid;if(!a._cellsMerge.length)return null;if(t.__parentCells&&void 0!==t.__parentCells["row"+l.id+"_column_"+i])return t.__parentCells["row"+l.id+"_column_"+i];let n=a.getVisibleRows();a.paging.enabled&&"page"===a.selection.selectAllMode&&(n=n.slice(a.paging.pageIndex*a.paging.pageSize,(a.paging.pageIndex+1)*a.paging.pageSize)),t.__parentCells||(t.__parentCells=[]);for(let o=0;o<a._cellsMerge.length;o++){const r=a._cellsMerge[o];let s=[],d=[];if(s.push(r.row),r.rowSpan>1){const e=n.indexOf(r.row);if(e>=0)for(let t=e;t<e+r.rowSpan;t++)n[t]&&-1===s.indexOf(n[t])&&s.push(n[t])}if(d.push(r.column.dataField),r.colSpan>1){const e=a.columns.indexOf(a.columnByDataField[r.column.dataField]);for(let t=e;t<e+r.colSpan;t++)a.columns[t]&&-1===d.indexOf(a.columns[t].dataField)&&d.push(a.columns[t].dataField)}if(s.indexOf(l)>=0&&d.indexOf(i)>=0){if(e){const e={cell:r.row.getCell(r.column.dataField),rows:s,columns:d,row:r.row,column:r.column,endRow:s[s.length-1],endColumn:a.columnByDataField[d[d.length-1]]};return t.__parentCells["row"+l.id+"_column_"+i]=e,e}const n=r.row.getCell(r.column.dataField);return t.__parentCells["row"+l.id+"_column_"+i]=n,n}}return t.__parentCells["row"+l.id+"_column_"+i]=null,null}}),Smart("smart-grid-cell",class extends Smart.BaseElement{static get properties(){return{}}get hasStyleObserver(){return!1}get enableShadowDOM(){return!1}addThemeClass(){}addDefaultClass(){}get isUtilityElement(){return!0}_refresh(){const e=this;e.innerHTML="",e._initialize(e.cell)}_initialize(e){const t=this,l=document.createElement("div"),i=e.column,a=e.row,n=e.grid;t._properties=[],t.cell=e,t.appendChild(l);let o=!1;if(i&&i._treeColumn&&n.dataSource.boundHierarchy&&(o=!0,!n.grouping.enabled&&n.dataSource.groupBy&&n.dataSource.groupBy.length>0&&(o=!1),n.grouping.enabled&&n.dataSource.groupBy&&0===n.dataSource.groupBy.length&&(o=!1)),o){const e=document.createElement("div"),i=document.createElement("button"),o=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),d=document.createElement("span");return a.expanded?i.setAttribute("toggled",""):i.removeAttribute("toggled",""),i.tabIndex=-1,t.toggleButton=i,t.checkbox=s,l.appendChild(e),l.appendChild(r),r.setAttribute("content",""),e.setAttribute("indent",""),o.setAttribute("label",""),i.setAttribute("toggle-button",""),s.setAttribute("checkbox",""),s.setAttribute("role","checkbox"),t.setAttribute("has-toggle-button",""),r.appendChild(i),r.appendChild(s),d.classList.add("smart-input"),s.appendChild(d),n.checkBoxes.visible?d.classList.remove("smart-hidden"):d.classList.add("smart-hidden"),r.appendChild(o),t.content=o,void(t.isRendered=!0)}{const e=document.createElement("div");l.appendChild(e)}t.content=l,t.isRendered=!0}_renderCommands(){const e=this,t=e.cell.grid;if(t.__cellsCommandTemplate)return e.firstChild.innerHTML=t.__cellsCommandTemplate,void t._updateCommandColumnCommandsVisibility(e.firstChild,e.cell.row);const l=t._getCommandColumnCommandsTemplate();e.firstChild.innerHTML=l,t._updateCommandColumnCommandsVisibility(e.firstChild,e.cell.row),t.__cellsCommandTemplate=l}_renderGroupCell(){const e=this,t=e.cell.grid,l=e.cell.column,i=e.cell.row;[...e.attributes].forEach((t=>e.removeAttribute(t.name))),e.setAttribute("group",""),e.style.width!==l.computedWidth+"px"&&(e.style.width=l.computedWidth+"px"),t.rightToLeft?e.style.right!==l.left+"px"&&(e.style.right=l.left+"px"):e.style.left!==l.left+"px"&&(e.style.left=l.left+"px"),e.classList.contains("smart-hidden")&&e.classList.remove("smart-hidden"),l.autoGenerated&&(e.style.width="0px");let a=i.label;const n=function(e,t,l){for(let i=0;i<t.length;i++){const a=t[i];a.$&&!1===a.$.filtered||(void 0!==a[e]&&l.push(a),a.summaryRow||(a.children||a.data&&a.data.children)&&n(e,a.children,l))}return l};if(void 0!==i.label){let o="",r=[];if(t.grouping.summaryRow.visible){const a=n(l.dataField,i.summaryRow?i.parent.data.children:i.data.children,[]),s={},d=l._treeColumn?l.summary.length>0?l.summary:["count"]:l.summary;s[l.dataField]=d;const c=d.length>0?t.dataSource.summarize([s],a):null;if(c)for(let i=0;i<d.length;i++){const a=d[i];if("advanced"===t.grouping.renderMode)o+="<span summary>"+t.localize(a,{value:c[l.dataField][a]});else{i>0&&(o+=", ");let n=c[l.dataField][a];const r=l.cellsFormat;r&&(n=e.cell.getFormattedValue(n,r)),o+=t.localize(a,{value:n})}r.push(c[l.dataField][a])}}if(t.dataSource.virtualDataSourceOnExpand&&(o=""),l._treeColumn){const l=t.columnByDataField[i.groupDataField],n=l?l.label:"";"advanced"===t.grouping.renderMode?(a=i.summaryRow?"<div header><span group></span><span value></span></div>":"<div header><span group>"+n+"</span><span value>"+i.label+"</span></div>",o&&(a+="<div summary>",a+=o,a+="</div>")):"compact"===t.grouping.renderMode?(i.summaryRow?(a="<div header><span group></span><span value></span>",o&&(a+="<div summary>",a+=o,a+="</div>")):(a="<div header><span group>"+n+": </span><span value>"+i.label+"</span>",o&&t.grouping.summaryRow.inline&&(a+="<span summary>",a+="  ("+r+")",a+="</span>")),a+="</div>",e.classList.add("smart-grid-column-border-collapse")):"basic"===t.grouping.renderMode&&(a=i.label,i.summaryRow?o&&(a+="<div summary>",a+=o,a+="</div>"):o&&t.grouping.summaryRow.inline&&(a+="<span summary>",a+="  ("+r+")",a+="</span>"),e.classList.add("smart-grid-column-border-collapse")),e.setAttribute("has-toggle-button","")}else e.removeAttribute("has-toggle-button",""),"advanced"===t.grouping.renderMode?(a="<div content><div label><div header><span group></span><span value></span></div>",o&&(a+="<div summary>",a+=o,a+="</div>"),a+="</div></div>"):a=o}const o=e.firstChild;if(t.dataSource.boundHierarchy&&l._treeColumn){const n=o.children[0],r=o.children[1].children[0],s=o.children[1].children[1].firstChild,d=o.children[1].children[2];n.setAttribute("indent",""),i.checked?s.setAttribute("checked",""):!1===i.checked?s.removeAttribute("checked"):null===i.checked&&s.setAttribute("checked","indeterminate"),i.leaf?r.classList.add("smart-visibility-hidden"):(r.classList.remove("smart-visibility-hidden"),i.expanded?r.setAttribute("toggled",""):r.removeAttribute("toggled",""));let c="";if(l._treeColumn?e.toggleButton.classList.remove("smart-hidden"):e.toggleButton.classList.add("smart-hidden"),l._treeColumn)if(t.grouping.enabled&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode){let e=i.level;void 0===i.label&&e--,c+='<div style="width: '+(1+e)*t.grouping.groupIndent+'px;"></div>'}else for(let e=0;e<i.level;e++)c+="<div class='smart-indent'></div>";void 0===i.label?r.classList.add("smart-hidden"):(r.classList.remove("smart-hidden"),r.style.marginLeft="",l._treeColumn&&t.grouping.enabled&&t.grouping.toggleButtonIndent>0&&"advanced"===t.grouping.renderMode&&(r.style.marginLeft=i.level*(t.grouping.toggleButtonIndent-t.grouping.groupIndent)+"px")),n.innerHTML=c,d.innerHTML=a,t.appearance.showTooltips?d.setAttribute("title",i.label?i.label:a):d.hasAttribute("title")&&d.removeAttribute("title")}else void 0!==i.label&&t.grouping.enabled&&!l._treeColumn&&(o.innerHTML=a);if(t.grouping.enabled&&t.dataSource.groupBy&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode){const a=t.grouping.groupIndent*(1+i.level);l.dataField===t.columns[t.columns.length-1].dataField&&(e.style.width=l.computedWidth-a+"px",t.appearance.showColumnLines&&o.firstChild.classList.add("smart-grid-column-border"))}let r="smart-label";if(e.style.zIndex="","advanced"!==t.grouping.renderMode&&l._treeColumn){const l=t.columnByDataField[i.groupDataField];l.cellsAlign&&(r+=" align-"+l.cellsAlign),l.cellsVerticalAlign&&(r+=" align-"+l.cellsVerticalAlign),e.setAttribute("header",""),i.summaryRow||(e.style.width="100%"),e.style.zIndex=100}if(i.summaryRow&&(e.setAttribute("header",""),e.classList.add("smart-grid-column-border-collapse"),l.cellsAlign&&(r+=" align-"+l.cellsAlign),l.cellsVerticalAlign&&(r+=" align-"+l.cellsVerticalAlign)),o.className!==r&&(o.className=r),l.formatFunction){const t={row:i,column:l,cell:e.cell,value:null,template:null,group:{value:a,template:null}};l.formatFunction(t),t.group.value!==a&&(o.innerHTML=t.group.value),null!==t.group.template&&(o.innerHTML=t.group.template)}}_renderFilterCell(e){const t=this,l=t.cell.grid,i=t.cell.column;let a;const n=(e,t)=>{l._handleFilterMenuClick(e,t)};l._filterInfo||(l._filterInfo={},l._filterInfo.stringConditions=[{icon:"smart-icon-contains",command:n,value:"CONTAINS",label:l.localize("CONTAINS")},{icon:"smart-icon-does-not-contain",command:n,value:"DOES_NOT_CONTAIN",label:l.localize("DOES_NOT_CONTAIN")},{icon:"smart-icon-starts-with",command:n,value:"STARTS_WITH",label:l.localize("STARTS_WITH")},{icon:"smart-icon-ends-with",command:n,value:"ENDS_WITH",label:l.localize("ENDS_WITH")},{icon:"smart-icon-equals",command:n,value:"EQUAL",label:l.localize("EQUAL")},{icon:"smart-icon-delete",command:n,value:"CLEAR_FILTER",label:l.localize("CLEAR_FILTER")}],l._filterInfo.numberAndDateConditions=[{icon:"smart-icon-equals",command:n,value:"EQUAL",label:l.localize("EQUAL")},{icon:"smart-icon-not-equal",command:n,value:"NOT_EQUAL",label:l.localize("NOT_EQUAL")},{icon:"smart-icon-less-than",command:n,value:"LESS_THAN",label:l.localize("LESS_THAN")},{icon:"smart-icon-less-than-equal",command:n,value:"LESS_THAN_OR_EQUAL",label:l.localize("LESS_THAN_OR_EQUAL")},{icon:"smart-icon-greater-than",command:n,value:"GREATER_THAN",label:l.localize("GREATER_THAN")},{icon:"smart-icon-greater-than-equal",command:n,value:"GREATER_THAN_OR_EQUAL",label:l.localize("GREATER_THAN_OR_EQUAL")},{icon:"smart-icon-between",command:n,value:"RANGE",label:l.localize("RANGE")},{icon:"smart-icon-delete",command:n,value:"CLEAR_FILTER",label:l.localize("CLEAR_FILTER")}]),a="string"===i.dataType?l._filterInfo.stringConditions:l._filterInfo.numberAndDateConditions;let o="smart-icon-search";switch(i._filterInfo||(i._filterInfo={condition:""}),i.filterEditor&&i.filterEditor.condition&&(i._filterInfo.condition=i.filterEditor.condition),i.filterEditor&&i.filterEditor.value&&(i._filterInfo.value=i.filterEditor.value),i._filterInfo.dataSource=a,i._filterInfo.condition.toLowerCase()){case"equal":o="smart-icon-equals";break;case"starts_with":o="smart-icon-starts-with";break;case"ends_with":o="smart-icon-ends-with";break;case"not_equal":o="smart-icon-not-equal";break;case"less_than":o="smart-icon-less-than";break;case"less_than_or_equal":o="smart-icon-less-than-or-equal";break;case"greater_than":o="smart-icon-greater-than";break;case"greater_than_or_equal":o="smart-icon-greater-than-or-equal";break;case"contains":o="smart-icon-contains";break;case"does_not_contain":o="smart-icon-does-not-contain";break;case"range":o="smart-icon-between";break;default:o="smart-icon-search"}let r=`<div class="smart-filter-input-type"><i class="smart-grid-icon ${o} show"></i></div>`;if("string"===i.dataType)r+=`<input class="smart-filter-input-value" data-type="${i.dataType}"/>`,e.innerHTML=r;else if("date"===i.dataType){const a=new Smart.Utilities.DateTime;r+=`<input placeholder="${a.expandFormat(a.calendar,i.cellsFormat||"d")}" class="smart-filter-input-value" data-type="${i.dataType}"/><div class="smart-filter-input-type"><i class="smart-grid-icon smart-icon-calendar show"></i></div>`,e.innerHTML=r,e.lastElementChild.onpointerdown=function(){l._handleFilterCalendarCellClick(t.cell)}}else if("number"===i.dataType)r+='<div class="smart-grid-cell-editor smart-filter-input-value smart-grid-number-input-cell-editor"><input class="smart-input" type="number"><div tabindex="-1" class="nav"><div tabindex="-1" class="up"></div><div tabindex="-1" class="down"></div></div></div>',e.innerHTML=r,l._handleFilterNumberCellEditor(this.cell,e);else if("boolean"===i.dataType){const i=document.createElement("div");i.classList.add("smart-input"),i.classList.add("smart-grid-check-box-cell-editor"),i.classList.add("smart-filter-input-value"),e.tabIndex=0,e.style.outline="none",t.setAttribute("template","checkBox"),i.setAttribute("checked","indeterminate"),r=i.outerHTML,e.innerHTML=r,e.classList.add("align-center"),e.classList.add("smart-label"),e.onfocus=()=>{e.setAttribute("focus","")},e.onblur=()=>{e.removeAttribute("focus","")},e.onclick=e=>{e.target.classList.contains("smart-input")&&l._handleFilterCellCheckBoxClick(this.cell)}}const s=e.querySelector("input");if(s&&(e.firstElementChild.onpointerdown=function(){l._handleFilterCellIconClick(this.cell)}.bind(this),s.onfocus=function(){l._handleFilterCellFocus(this.cell)}.bind(this),s.onblur=function(){l._handleFilterCellBlur(this.cell)}.bind(this),s.onkeyup=function(e){l._handleFilterCellKeyUp(this.cell,e)}.bind(this),s.onkeydown=function(e){l._handleFilterCellKeyDown(this.cell,e)}.bind(this)),e.classList.add("smart-filter-input-container"),i._filterInfo.input=s,i._filterInfo.cell=t.cell,i._filterInfo.editor=e,i._filterInfo.value&&(s.value=i._filterInfo.value,"date"===i.dataType&&(s.value=t.getFormattedValue(i._filterInfo.value,i.cellsFormat))),i.allowFilter||(s.disabled=!0),i.filterEditor)if(i.filterEditor.template){const t=i.filterEditor.template,l=document.createElement("div");i.filterTemplate instanceof HTMLTemplateElement?l.appendChild(t.content.cloneNode(!0)):t instanceof HTMLElement?l.appendChild(t):l.innerHTML=t,e.innerHTML="",e.appendChild(l),l.style.height="100%",l.style.width="100%";const a=e.querySelector("input");a&&(a.onfocus=()=>{e.setAttribute("focus","")},a.onblur=()=>{e.removeAttribute("focus","")}),i.filterEditor.onInit&&i.filterEditor.onInit(i,l)}else void 0!==i.filterEditor.min&&(s.min=i.filterEditor.min),void 0!==i.filterEditor.max&&(s.max=i.filterEditor.max),void 0!==i.filterEditor.minLength&&(s.minLength=i.filterEditor.minLength),void 0!==i.filterEditor.maxLength&&(s.maxLength=i.filterEditor.maxLength),void 0!==i.filterEditor.placeholder&&(s.placeholder=i.filterEditor.placeholder),void 0!==i.filterEditor.value&&(s.value=i.filterEditor.value),void 0!==i.filterEditor.step&&(s.step=i.filterEditor.step),void 0!==i.filterEditor.disabled&&(s.disabled=i.filterEditor.disabled),void 0!==i.filterEditor.condition&&(i._filterInfo.condition=i.filterEditor.condition),i.filterEditor.onInit&&i.filterEditor.onInit(i,e)}async _render(){const e=this,t=e.cell.grid,l=e.cell.column,i=e.cell.row,a=i.data,n=i._isMeasureRow?null:l.cellsFormat;if(t.grouping.enabled&&t.dataSource.groupBy.length>0&&void 0!==i.label)return e._renderGroupCell(),void(i.summaryRow&&(e.cell.canNotify=!1,i.canNotify=!1,e.cell._styleChanged=!0,e.cell.background=null,e.cell.color=null,e.cell.fontFamily=null,e.cell.fontSize=null,e.cell.element&&e.cell.element.firstElementChild&&e.cell.setStyle(e.cell.element.firstElementChild),e.cell.canNotify=!0,i.canNotify=!0));if(t.grouping.enabled&&t.dataSource.groupBy.length>0&&e.toggleButton&&(e.toggleButton.classList.remove("smart-hidden"),e.toggleButton.classList.remove("smart-visibility-hidden"),e.toggleButton.style.marginLeft="",l._treeColumn&&t.grouping.enabled&&t.grouping.toggleButtonIndent>0&&(e.toggleButton.style.marginLeft=i.level*(t.grouping.toggleButtonIndent-t.grouping.groupIndent)+"px")),t.grouping.enabled&&t.dataSource.groupBy.length>0&&(e.removeAttribute("header"),e.removeAttribute("group")),!l.visible)return void(e.style.width="0px");t.appearance.showSortColumnBackground?l.sorted?e.setAttribute("sort",""):e.removeAttribute("sort"):l.sorted&&e.hasAttribute("sort")&&e.removeAttribute("sort"),t.appearance.showFilterColumnBackground?l.filtered?e.setAttribute("filter",""):e.removeAttribute("filter"):l.filtered&&e.hasAttribute("filter")&&e.removeAttribute("filter"),t.dataSource.boundHierarchy&&e.hasAttribute("has-toggle-button")&&!l._treeColumn&&e.removeAttribute("has-toggle-button");let o=l.displayField?a[l.displayField]:a[l.dataField];e.removeAttribute("highlight"),t.highlighted!==i.id||l.autoGenerated||e.setAttribute("highlight","");const r=t=>t?t.startsWith("off_")?(e.classList.remove(t.substring(4)),!1):(e.classList.add(t),e.setAttribute("customCSS",t),!0):(e.setAttribute("highlight",""),!0);if((t.highlightedRows||t.highlightedCells)&&e.hasAttribute("customCSS")){const t=e.getAttribute("customCSS");e.removeAttribute("customCSS"),e.classList.remove(t)}if(l.highlight&&(r(),e.setAttribute("highlight-data-field",l.dataField)),t.highlightedCells&&t.highlightedCells[i.id]&&void 0!==t.highlightedCells[i.id][l.dataField]&&r(t.highlightedCells[i.id][l.dataField]),t.highlightedRows&&void 0!==t.highlightedRows[i.id]&&r(t.highlightedRows[i.id]),t.editing.batch){if(t._cellsUpdatedValues){e.removeAttribute("update");const a=t._cellsUpdatedValues[i.id+"_"+l.dataField];void 0!==a&&(e.setAttribute("update",""),o=a)}t._rowsDeleted&&(t._rowsDeleted.indexOf(i)>=0?e.setAttribute("delete",""):e.removeAttribute("delete")),t._rowsAdded&&(t._rowsAdded.indexOf(i.id)>=0?e.setAttribute("add",""):e.removeAttribute("add"))}!t.onCellValue||l.rowHeaderColumn||l.selectionColumn||(e.cell._updating=!0,t.onCellValue(e.cell),e.cell._updating=!1,o=e.cell.value),void 0===o&&(o="");let s=o;n&&(s=e.cell.getFormattedValue(o,n));const d=e.firstChild;if((t.onCellRender||l.onCellRender)&&requestAnimationFrame((function(){if(l._cellsCachedValues||(l._cellsCachedValues=[]),l._cellsCachedValues[i.index]){const e=l._cellsCachedValues[i.index];d.firstChild&&d.removeChild(d.firstChild),d.appendChild(e)}else if(t.onCellRender?t.onCellRender(e.cell):l.onCellRender(e.cell),e.cell.template!==l.template){const t=document.createElement("div");return d.firstChild&&d.removeChild(d.firstChild),e.cell.template instanceof HTMLTemplateElement?t.appendChild(e.cell.template.cloneNode(!0)):t.appendChild(e.cell.template),d.appendChild(t),void(l._cellsCachedValues[i.index]=t)}})),l.autoGenerated||e.setAttribute("data-field",l.dataField),e.cell.focused?(t.selection.allowCellSelection&&e.setAttribute("focus",""),i.element.setAttribute("focus",""),e.cell.id||(e.id="gridcell_"+Math.floor(65536*(1+Math.random())).toString(16).substring(1)),t.setAttribute("aria-activedescendant",e.id)):e.removeAttribute("focus"),e.cell.selected?(e.setAttribute("selected",""),e.setAttribute("aria-selected",!0)):(e.removeAttribute("selected"),e.removeAttribute("aria-selected")),t.dragDrop&&t.dragDrop.row===i?e.classList.add("dragged"):e.classList.remove("dragged"),l.cellsClassName){const t=l.cellsClassName.trim().split(" ");for(let l=0;l<t.length;l++)e.classList.add(t[l])}t.rowDetail.enabled&&i.showDetail&&(e.style.height=i.cellHeight+"px",e.style.lineHeight=i.cellHeight+"px"),i.expanded&&i.expandHeight>0&&(e.style.height=i.cellHeight+"px",e.style.lineHeight=i.cellHeight+"px");const c=e._getCellAlignment(i,l),u=""!==e.cell.template&&t.isInitialized&&!i._isMeasureRow;let m="";if(c.align&&(m+=c.align+" "),c.verticalAlign&&(m+=c.verticalAlign+" "),l.cellsWrap&&(m+="wrap "),m+="smart-label",e.style.width!==l.computedWidth+"px"){const i=t._isLastVisibleColumn(l);l.autoGenerated||i?e.style.width=l.computedWidth+"px":e.style.width=l.computedWidth-t._columnGap+"px"}if(t.grouping.enabled&&t.dataSource.groupBy&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode){const a=t.grouping.groupIndent*(1+i.level);l.dataField===t.columns[t.columns.length-1].dataField&&(e.style.width=l.computedWidth-a+t.grouping.groupIndent+"px",t.appearance.showColumnLines&&e.classList.add("smart-grid-column-border"))}l===t._firstVisibleColumn?e.classList.add("smart-grid-column-border-collapse"):e.classList.remove("smart-grid-column-border-collapse"),t._columnGap>0&&t.appearance.showColumnLines&&e.classList.add("smart-grid-column-border"),t._rowGap>0&&e.classList.add("smart-grid-row-border"),t.appearance.showColumnLines?e.classList.remove("smart-grid-vertical-border-collapse"):e.classList.add("smart-grid-vertical-border-collapse"),t.appearance.showRowLines?e.classList.remove("smart-grid-horizontal-border-collapse"):e.classList.add("smart-grid-horizontal-border-collapse");let g=l.left;if(t.rightToLeft?e.style.right!==g+"px"&&(e.style.right=g+"px"):e.style.left!==g+"px"&&(e.style.left=g+"px"),e.classList.contains("smart-hidden")&&e.classList.remove("smart-hidden"),e.hasAttribute("template")&&e.removeAttribute("template"),e.hasAttribute("freeze")&&e.removeAttribute("freeze"),e.hasAttribute("detail")&&e.removeAttribute("detail"),e.hasAttribute("error")&&e.removeAttribute("error"),e.cell.error&&e.setAttribute("error",e.cell.error),i.filterRow?e.classList.add("smart-grid-filter-row-cell"):i.summaryRow?e.classList.add("smart-grid-summary-row-cell"):(l.freeze||i.freeze)&&(l.selectionColumn&&(e.setAttribute("checkbox",""),m+=" smart-input",l.grid.selection.checkBoxes.enabled&&l.grid.selection.checkBoxes.autoShow?e.setAttribute("auto-show",""):e.removeAttribute("auto-show")),(l.rowHeaderColumn||l.selectionColumn)&&(e.setAttribute("header",""),e.setAttribute("role","rowheader")),l.rowDetailColumn&&(e.setAttribute("header",""),e.setAttribute("detail",""),e.setAttribute("has-toggle-button","")),l.commandColumn&&e.setAttribute("command",""),t.appearance.showFrozenColumnBackground&&l.freeze&&e.setAttribute("freeze",""),t.appearance.showFrozenRowBackground&&i.freeze&&e.setAttribute("freeze","")),l.cellsRotationAngle){if(!e._rotateCellContent(d,l,o))return}else if(i.filterRow){if(!l.toggleColumn&&!l.rowHeaderColumn)return l._filterEditorInitialized?void("boolean"===l.dataType&&e.setAttribute("template","checkBox")):(l._filterEditorInitialized=!0,void e._renderFilterCell(d));d.innerHTML=""}else if(i.summaryRow){if(l.toggleColumn||l.rowHeaderColumn)d.innerHTML="";else if(d.innerHTML="",l.summary.length>0&&t._summaryItems){const a=t._summaryItems[l.dataField];let n=0;for(let o in a){if(n===i.summaryRowIndex){const i=l.cellsFormat;let n=a[o];i&&(n=e.cell.getFormattedValue(n,i)),d.innerHTML=t.localize(o,{value:n})}n++}}}else if(t.rowDetail.enabled&&l.rowDetailColumn)""!==d.innerHTML&&(i.showDetail?d.innerHTML='<button tabindex="-1" class="smart-animate" toggled toggle-button></button>':d.innerHTML='<button tabindex="-1" class="smart-animate" toggle-button></button>',i.element.toggleDetailButton=e.querySelector("button"),i.element.toggleDetailButton.setAttribute("title",t.localize(i.showDetail?"collapseRow":"expandRow",{elementType:"Grid"})),t.rowDetail.dialog.enabled&&i.element.toggleDetailButton.classList.add("row-detail"));else if(l.commandColumn)e._renderCommands();else if(t.appearance.showRowHeaderNumber&&l.rowHeaderColumn)if(i.addNewRow)d.textContent="";else{const l=l=>{if(e.cell.value)return e.cell.value;if("number"===t.appearance.autoGenerateRowLabelMode)return l.visibleIndex+1;{const e=l.visibleIndex%26,t=Math.floor(l.visibleIndex/26),i="A".charCodeAt(0),a=String.fromCharCode(i+e);let n="";for(let e=0;e<t;e++)n+="A";return n+a}};t._rowsAdded&&t._rowsAdded.indexOf(i.id)>=0?d.textContent="":d.textContent=l(i)}else if(u)switch(e.removeAttribute("readonly"),e.cell.template){case"checkBox":case"switchButton":case"radioButton":""!==d.textContent&&(d.textContent=""),(!t.editing.enabled||!l.allowEdit||e.cell.readonly||t.editing.enabled&&t.editing.commandColumn.visible&&t.editing.editRow!==e.cell.row)&&e.setAttribute("readonly",""),'<span class="smart-input"></span>'!==d.innerHTML&&(d.innerHTML='<span class="smart-input"></span>'),o?d.firstChild.setAttribute("checked",""):null===o?d.firstChild.setAttribute("checked","indeterminate"):d.firstChild.removeAttribute("checked"),e.setAttribute("template",e.cell.template);break;case"email":""!==d.textContent&&(d.textContent=""),(!t.editing.enabled||!l.allowEdit||e.cell.readonly||t.editing.enabled&&t.editing.commandColumn.visible&&t.editing.editRow!==e.cell.row)&&e.setAttribute("readonly",""),Smart.Validator&&(Smart.Validator.email(o)?d.innerHTML=o:d.innerHTML='<span class="url"><a href="mailto:'+o+'" target="_blank" contenteditable="false" rel="noreferrer noopener">'+o+"</a></span>");break;case"url":""!==d.textContent&&(d.textContent=""),(!t.editing.enabled||!l.allowEdit||e.cell.readonly||t.editing.enabled&&t.editing.commandColumn.visible&&t.editing.editRow!==e.cell.row)&&e.setAttribute("readonly",""),Smart.Validator&&(Smart.Validator.url(o)?d.innerHTML='<span class="url"><a href="http://'+o+'" target="_blank" contenteditable="false" rel="noreferrer noopener">'+o+"</a></span>":d.innerHTML='<span class="url"><a href="'+o+'" target="_blank" contenteditable="false" rel="noreferrer noopener">'+o+"</a></span>");break;default:{let a=null;if(e.setAttribute("template",""),"function"==typeof e.cell.template){const t={row:i,column:l,cell:e.cell,oldValue:e.cell.oldValue,value:o,template:null};let a=d.querySelector(".smart-grid-cell-template");a&&a.getAttribute("column")===l.dataField?t.template=a.firstElementChild:a=null,e.formattedValue!==s&&(a=null),e.cell.canNotify=!1,i.canNotify=!1;const n=Object.assign({},{background:e.cell.background,borderColor:e.cell.borderColor,color:e.cell.color,fontSize:e.cell.fontSize,fontFamily:e.cell.fontFamily,fontWeight:e.cell.fontWeight,fontStyle:e.cell.fontStyle});if(e.cell.template(t),!a&&t.template)if(t.template instanceof HTMLElement){const e=document.createElement("div");e.classList.add("smart-grid-cell-template"),e.setAttribute("column",l.dataField),d.innerHTML="",d.appendChild(e),e.appendChild(t.template)}else d.innerHTML='<div column="'+l.dataField+'" class="smart-grid-cell-template">'+t.template+"</div>";else a||null!==t.template||(d.innerHTML=o);d.style.background===n.background&&d.style.borderColor===n.borderColor&&d.style.color===n.color&&d.style.fontSize===n.fontSize&&d.style.fontWeight===n.fontWeight&&d.style.fontStyle===n.fontStyle||(e.cell._styleChanged=!0,e.cell.setStyle(d)),e.cell.background!==n.background||e.cell.borderColor!==n.borderColor||e.cell.color!==n.color||e.cell.fontSize!==n.fontSize||e.cell.fontWeight!==n.fontWeight||e.cell.fontStyle!==n.fontStyle?(e.cell._styleChanged=!0,e.cell.setStyle(d)):e.cell._styleChanged&&e.cell.setStyle(d),void 0===e.cell.oldValue&&(e.cell.oldValue=o),e.formattedValue=s,e.cell.canNotify=!0,i.canNotify=!0}else if(""!==d.textContent&&(d.textContent=""),e.cell.template.startsWith("#")&&(a=document.querySelector(e.cell.template)),a){let n=a.content.cloneNode(!0).firstElementChild;const r=o;if(o=o.toString(),o=o.replace(/'/gi,"\\'"),o=o.replace(/"/gi,'\\"'),n.querySelector("[smart-if]")){const e=n.querySelector("[smart-else]"),t=n.querySelectorAll("[smart-if]");let i=!1;for(let e=0;e<t.length;e++){const a=t[e],s=a.getAttribute("smart-if").split(" "),d=s[1].trim();let c=s[2].trim(),u=o;switch("Today"===c&&(c=new Date),"date"===l.dataType&&(o=new Date(r).getTime(),c=new Date(c).getTime()),d){case">":o>parseFloat(c)&&(n=a,i=!0);break;case">=":o>=parseFloat(c)&&(n=a,i=!0);break;case"=":o===c&&(n=a,i=!0);break;case"<":o<parseFloat(c)&&(n=a,i=!0);break;case"<=":o<=parseFloat(c)&&(n=a,i=!0)}if(o=u,i)break}!i&&e&&(n=e)}let c=n.outerHTML.replace(/{{value}}/gi,o).replace(/{{id}}/gi,i.id);for(c.indexOf("{{value=")>=0&&(o?(c=c.substring(0,c.indexOf("{{value="))+o+c.substring(c.indexOf("}")),c=c.replace(/}/gi,""),c=c.replace(/{/gi,"")):(c=c.replace(/{{value=/gi,""),c=c.replace(/}}/gi,"")));c.indexOf("{{value::")>=0;){const t=c.indexOf("{{value::"),l=c.substring(t+9,c.indexOf("}}")),i=e.cell.getFormattedValue(o,l);c=c.replace(`{{value::${l}}}`,i)}if(l._treeColumn){const a=d.firstChild;if(a&&a.classList&&e.toggleButton&&l._treeColumn&&d.children[1]){const a=d.children[0],n=d.children[1].children[0],o=d.children[1].children[1].firstChild,r=d.children[1].children[2];let u="";if(l._treeColumn){if(t.grouping.enabled)u+='<div style="width: '+(i.level-1+1)*t.grouping.groupIndent+'px;"></div>';else for(let e=0;e<i.level;e++)u+="<div class='smart-indent'></div>";i.checked?o.setAttribute("checked",""):!1===i.checked?o.removeAttribute("checked"):null===i.checked&&o.setAttribute("checked","indeterminate"),i.leaf?i.allowCheck?o.classList.remove("smart-visibility-hidden"):o.classList.add("smart-visibility-hidden"):i.allowCheck?o.classList.remove("smart-hidden"):o.classList.add("smart-hidden")}i.allowCheck?t.checkBoxes.visible?o.classList.remove("smart-hidden"):o.classList.add("smart-hidden"):t.checkBoxes.visible||o.classList.add("smart-hidden"),a.innerHTML=u,n.classList.add("smart-visibility-hidden"),i.leaf?n.classList.add("smart-visibility-hidden"):(n.classList.remove("smart-visibility-hidden"),i.expanded?n.setAttribute("toggled",""):n.removeAttribute("toggled","")),i.data.isEmpty&&n.classList.add("smart-visibility-hidden"),r.innerHTML=c,t.appearance.showRowHeaderNumber&&t.grouping.enabled&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode&&(s="<span visible-index>"+(1+i.visibleIndex)+"</span> "+s),t.rowDetail.enabled&&t.grouping.enabled&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode&&(r.innerHTML='<button tabindex="-1" class="row-detail inline smart-animate" toggled toggle-button></button>'+s,i.element.toggleDetailButton=e.querySelector("button.inline"),i.element.toggleDetailButton.setAttribute("title",t.localize(i.showDetail?"collapseRow":"expandRow",{elementType:"Grid"})),i.element.toggleDetailButton.onpointerdown=function(){i.showDetail=!i.showDetail}),t.appearance.showTooltips?r.setAttribute("title",s):r.hasAttribute("title")&&r.removeAttribute("title")}}else d.innerHTML!==c&&(d.innerHTML=c)}else{""===o&&(o="&nbsp;");const t=e.cell.template.replace(/{{value}}/gi,o).replace(/{{id}}/gi,i.id);d.innerHTML!==t&&(d.innerHTML=t)}}}else if(l.selectionColumn)"checkBox"===t.selectionMode&&(i.getProperty("selected")?(e.setAttribute("selected",""),e.element.setAttribute("aria-selected",!0)):e.getAttribute("selected")&&(e.removeAttribute("selected"),e.element.removeAttribute("aria-selected")));else{const a=d.firstChild;if(a&&a.classList&&e.toggleButton&&l._treeColumn&&d.children[1]){const a=d.children[0],n=d.children[1].children[0],o=d.children[1].children[1].firstChild,r=d.children[1].children[2];let c="";if(l._treeColumn){if(t.grouping.enabled)c+='<div style="width: '+(i.level-1+1)*t.grouping.groupIndent+'px;"></div>';else for(let e=0;e<i.level;e++)c+="<div class='smart-indent'></div>";i.checked?o.setAttribute("checked",""):!1===i.checked?o.removeAttribute("checked"):null===i.checked&&o.setAttribute("checked","indeterminate"),i.leaf?i.allowCheck?o.classList.remove("smart-visibility-hidden"):o.classList.add("smart-visibility-hidden"):i.allowCheck?o.classList.remove("smart-hidden"):o.classList.add("smart-hidden")}i.allowCheck?t.checkBoxes.visible?o.classList.remove("smart-hidden"):o.classList.add("smart-hidden"):t.checkBoxes.visible||o.classList.add("smart-hidden"),a.innerHTML=c,n.classList.add("smart-visibility-hidden"),i.leaf?n.classList.add("smart-visibility-hidden"):(n.classList.remove("smart-visibility-hidden"),i.expanded?n.setAttribute("toggled",""):n.removeAttribute("toggled","")),i.data.isEmpty&&n.classList.add("smart-visibility-hidden"),r.innerHTML=s,t.appearance.showRowHeaderNumber&&t.grouping.enabled&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode&&(s="<span visible-index>"+(1+i.visibleIndex)+"</span> "+s),t.rowDetail.enabled&&t.grouping.enabled&&t.dataSource.groupBy.length>0&&"advanced"===t.grouping.renderMode&&(r.innerHTML='<button tabindex="-1" class="row-detail inline smart-animate" toggled toggle-button></button>'+s,i.element.toggleDetailButton=e.querySelector("button.inline"),i.element.toggleDetailButton.setAttribute("title",t.localize(i.showDetail?"collapseRow":"expandRow",{elementType:"Grid"})),i.element.toggleDetailButton.onpointerdown=function(){i.showDetail=!i.showDetail}),t.appearance.showTooltips?r.setAttribute("title",s):r.hasAttribute("title")&&r.removeAttribute("title")}else{const a=i["column_"+l.dataField];if(e.getAttribute("rowspan")&&(e.removeAttribute("rowspan"),e.removeAttribute("aria-rowspan"),e.style.height=""),e.getAttribute("colspan")&&(e.removeAttribute("colspan"),e.removeAttribute("aria-colspan")),a){if(a.colSpan>1){const i=t.columns.indexOf(l);let n=0;for(let e=i;e<i+a.colSpan;e++){const l=t.columns[e];l&&l.visible&&(n+=l.computedWidth)}e.style.width=n+"px",e.setAttribute("colspan",""),e.setAttribute("aria-colspan",a.colSpan),a._styleChanged=!0}if(a.rowSpan>1){const l=t.rows.indexOf(i);let n=0;i.element.setAttribute("rowspan","");for(let e=l;e<=l+a.rowSpan-1;e++){const l=t.rows[e];l&&l.visible&&l.filtered&&(n+=l.cellHeight)}e.style.height=n+"px",e.setAttribute("rowspan",""),e.setAttribute("aria-rowspan",a.rowSpan),a._styleChanged=!0}1===a.colSpan&&e.hasAttribute("colspan")&&(e.style.width="",e.removeAttribute("colspan"),e.removeAttribute("aria-colspan"),a._styleChanged=!0),e.hasAttribute("rowspan")&&1===a.rowSpan&&(e.style.height="",e.removeAttribute("rowspan"),e.removeAttribute("aria-rowspan"),a._styleChanged=!0),d.textContent===s||l.formatFunction||(d.textContent=s),a.setStyle(d),t.appearance.showTooltips?d.setAttribute("title",a.tooltip||s):d.hasAttribute("title")&&d.removeAttribute("title")}else d.textContent=s}}if(d.className!==m&&(d.className=m),t.appearance.displayLoadingIndicator&&!l.autoGenerated&&(i.element.removeAttribute("focus"),d.innerHTML='<div class="smart-grid-cell-loading"></div>'),l.formatFunction&&!i.data.isEmpty&&t.isInitialized){const t={row:i,column:l,cell:e.cell,oldValue:e.cell.oldValue,value:o,formattedValue:s,template:null};e.cell.canNotify=!1,i.canNotify=!1;const a=Object.assign({},{background:e.cell.background,borderColor:e.cell.borderColor,color:e.cell.color,fontSize:e.cell.fontSize,fontFamily:e.cell.fontFamily,fontWeight:e.cell.fontWeight,fontStyle:e.cell.fontStyle});await l.formatFunction(t),d.style.background===a.background&&d.style.borderColor===a.borderColor&&d.style.color===a.color&&d.style.fontSize===a.fontSize&&d.style.fontWeight===a.fontWeight&&d.style.fontStyle===a.fontStyle||(e.cell._styleChanged=!0,e.cell.setStyle(d)),e.cell.background===a.background&&e.cell.borderColor===a.borderColor&&e.cell.color===a.color&&e.cell.fontSize===a.fontSize&&e.cell.fontWeight===a.fontWeight&&e.cell.fontStyle===a.fontStyle||(e.cell._styleChanged=!0,e.cell.setStyle(d));let n=!0;if(t.value!==o&&(e.toggleButton?d.children[1].children[2].innerHTML=t.value:d.innerHTML=t.value,n=!1),null!==t.template){if(e.toggleButton){const e=d.children[1].children[2];e.innerHTML!==t.template&&(e.innerHTML=t.template)}else if(d.innerHTML!==t.template){const e=document.createElement("div");e.innerHTML=t.template,e.innerHTML!==d.innerHTML&&(d.innerHTML=t.template)}n=!1}n&&(l.cellsFormat?d.textContent=s:d.textContent=o),e.cell.canNotify=!0,i.canNotify=!0}if(!i.data.isEmpty&&t.isInitialized&&e._applyConditionalFormattingToCell(e.cell,t,d),t.grouping.enabled&&"advanced"!==t.grouping.renderMode&&t.dataSource&&t.dataSource.groupBy.length>0&&l===t._firstVisibleColumn&&t.rowDetail.enabled&&t.rowDetail.visible&&d.querySelector("[toggle-button]")){const e=d.querySelector("[toggle-button]");e.classList.remove("smart-visibility-hidden"),e.classList.add("row-detail"),i.element.toggleDetailButton=e,i.element.toggleDetailButton.setAttribute("title",t.localize(i.showDetail?"collapseRow":"expandRow",{elementType:"Grid"})),e.onpointerdown=function(e){i.showDetail=!i.showDetail,e.stopPropagation(),e.preventDefault()}}}_autoWrap(){const e=this,t=e.firstChild,l=e.cell.grid;l.layout.allowCellsWrapShortcut&&e.hasAttribute("focus")&&e.hasAttribute("selected")&&(t.offsetWidth<t.scrollWidth?e._popupCellContent(t.innerHTML,e.cell):l._cellContentPopup&&l._cellContentPopup.remove())}_popupCellContent(e,t){const l=this,i=t.grid;let a=i._cellContentPopup;if(!i._cellContentPopup){a=document.createElement("div");const t=document.createElement("span"),l=document.createElement("div"),n=document.createElement("div");a.style.minHeight="0px",a.style.minWidth="0px",a.setAttribute("theme",i.theme),a.classList.add("smart-grid-cell-content-popup"),n.appendChild(l),n.classList.add("smart-grid-text-area-container"),l.innerHTML=e,l.classList.add("smart-grid-cell-content-popup-content"),t.classList.add("smart-hidden"),t.classList.add("close-button"),t.classList.add("smart-grid-icon"),t.classList.add("smart-icon-cancel-circled"),t.onclick=function(){i._cellContentPopup.parentNode.removeChild(i._cellContentPopup)},a.classList.add("smart-grid-text-area-dialog"),a.appendChild(n),a.appendChild(t),i._cellContentPopup=a}a.querySelector(".smart-grid-cell-content-popup-content").innerHTML=e;const n=i.offset(i.$.scrollView);a.style.top=i._offsetTop(l)-n.top+"px",a.style.left=i._offsetLeft(l)-n.left+"px",a.style.width=l.offsetWidth-4+"px",i.$.scrollView.appendChild(a)}_applyConditionalFormattingToCell(e,t,l){const i=this,a=e.column.dataField,n=e.row,o=e.row.index;if(t._conditionalFormatting&&t._conditionalFormatting[a]){const e=t._conditionalFormatting[a][o];i.cell.canNotify=!1,n.canNotify=!1,e?(i.cell._styleChanged=!0,i.cell.background=e.background,i.cell.color=e.color,i.cell.fontFamily=e.fontFamily,i.cell.fontSize=e.fontSize,i.cell.setStyle(l)):i.cell._styleChanged||(i.cell._styleChanged=!0,i.cell.background=null,i.cell.color=null,i.cell.fontFamily=null,i.cell.fontSize=null,i.cell.setStyle(l)),i.cell.canNotify=!0,n.canNotify=!0}else t._conditionalFormattingChanged&&!i.cell._styleChanged&&(i.cell.canNotify=!1,n.canNotify=!1,i.cell._styleChanged=!0,i.cell.background=null,i.cell.color=null,i.cell.fontFamily=null,i.cell.fontSize=null,i.cell.setStyle(l),i.cell.canNotify=!0,n.canNotify=!0)}_rotateCellContent(e,t,l){const i=document.createElement("span");return e.innerHTML="",i.innerHTML=l,e.appendChild(i),i.className="rotate",i.style.transform="rotate("+t.cellsRotationAngle+"deg)",this.grid._recycleRotate(e,i,t.cellsAlign,t.cellsVerticalAlign,l)}_getCellAlignment(e,t){const l=e["column_"+t.dataField],i=l&&l.verticalAlign||t.cellsVerticalAlign;let a=l&&l.align||t.cellsAlign;const n={align:"",verticalAlign:""};switch(l.grid.rightToLeft&&("left"===a?a="right":"right"===a&&(a="left")),a){case"left":n.align="align-left";break;case"center":case"middle":n.align="align-center";break;case"right":n.align="align-right"}switch(i){case"top":n.verticalAlign="align-top";break;case"center":case"middle":n.verticalAlign="align-middle";break;case"bottom":n.verticalAlign="align-bottom"}return n}template(){return""}_detach(){this.element=null,this.cell=null}onDetached(){this._detach()}});