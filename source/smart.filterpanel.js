
/* Smart UI v12.0.0 (2022-01-16) 
Copyright (c) 2011-2021 jQWidgets. 
License: https://htmlelements.com/license/ */ //

Smart("smart-filter-panel",class extends Smart.BaseElement{static get properties(){return{buttons:{value:["clear","filter"],type:"array"},data:{value:null,type:"array?",reflectToAttribute:!1},dataField:{value:null,type:"string?"},dataSource:{value:null,type:"any",reflectToAttribute:!1},evaluateFilterExpression:{value:null,type:"function?",reflectToAttribute:!1},filterType:{value:"string",allowedValues:["numeric","string","date","boolean"],type:"string"},formatString:{value:"d",type:"string"},messages:{value:{en:{addCondition:"Add Condition",addGroup:"Add Group",and:"and",blanks:"(Blanks)",cancel:"Cancel",clear:"Clear",contains:"contains",containsCaseSensitive:"contains (case sensitive)",dateTabLabel:"DATE",doesNotContain:"does not contain",doesNotContainCaseSensitive:"does not contain (case sensitive)",empty:"empty",endsWith:"ends with",endsWithCaseSensitive:"ends with (case sensitive)",equal:"equal",equalCaseSensitive:"equal (case sensitive)",filter:"Filter",greaterThan:"greater than",greaterThanOrEqual:"greater than or equal",lessThan:"less than",lessThanOrEqual:"less than or equal",mismatchedProperties:'smartFilterPanel: The "filterType" and the data type of the selected "dataField" are mismatched.',missingProperty:'smartFilterPanel: When mode is \'excel\', either "data" and "dataField" or "dataSource" of type Array have to be set.',notEmpty:"not empty",notEqual:"not equal",notNull:"not null",null:"null ",or:"or",placeholderBoolean:"Select value",placeholderDate:"Enter date",placeholderNumber:"Enter number",placeholderTime:"Enter time",placeholderValue:"Enter value",selectAll:"(Select All)",showRows:"Show rows where:",startsWith:"starts with",startsWithCaseSensitive:"starts with (case sensitive)",matchCase:"Match Case",timeTabLabel:"TIME"}},type:"object",extend:!0},mode:{value:"default",allowedValues:["basic","default","excel"],type:"string"}}}static get listeners(){return{"cancelButton.click":"cancel","clearButton.click":"clear","filterButton.click":"filter"}}template(){return'<div id="container" class="smart-container" role="presentation">\n                <div id="label" class="smart-filter-panel-label"></div>\n                <div id="mainContainer" role="presentation"></div>\n                <div id="buttonContainer" class="smart-filter-panel-button-container" role="presentation">\n                    <smart-button id="filterButton" class="primary" animation="[[animation]]" disabled="[[disabled]]" right-to-left="[[rightToLeft]]" theme="[[theme]]" unfocusable="[[unfocusable]]"></smart-button>\n                    <smart-button id="clearButton" animation="[[animation]]" disabled="[[disabled]]" right-to-left="[[rightToLeft]]" theme="[[theme]]" unfocusable="[[unfocusable]]"></smart-button>\n                    <smart-button id="cancelButton" animation="[[animation]]" disabled="[[disabled]]" right-to-left="[[rightToLeft]]" theme="[[theme]]" unfocusable="[[unfocusable]]"></smart-button>\n                </div>\n            </div>'}static get styleUrls(){return["smart.grid.css","smart.dropdownlist.css","smart.menu.css","smart.filterpanel.css","smart.textbox.css"]}ready(){super.ready()}render(){const e=this,t=e.filterType;e.$.label.id||(e.$.label.id=e.id+"Label"),e.setAttribute("role","dialog"),e.setAttribute("aria-labelledby",e.$.label.id),e._localize(),e._setButtonsVisibility(),e._filterType=t+"Filter",e._filterHandler=new(Smart.Utilities[t.slice(0,1).toUpperCase()+t.slice(1)+"FilterHandler"])(e),super.render()}cancel(){const e=this;e._filterHandler[e.mode+"Cancel"](),e.$.fireEvent("cancel")}clear(){const e=this;e._filterHandler[e.mode+"Clear"](),e.$.fireEvent("clear")}reset(){const e=this;e.$.clearButton.removeAttribute("hover"),e.$.filterButton.removeAttribute("hover"),e.$.cancelButton.removeAttribute("hover"),e._filterHandler.firstInputMatchCase&&e._filterHandler.firstInputMatchCase.classList.remove("active"),e._filterHandler.secondInputMatchCase&&e._filterHandler.secondInputMatchCase.classList.remove("active"),e._filterHandler[e.mode+"Clear"](),e._filterHandler.filterObject=new Smart.Utilities.FilterGroup}getFilter(){if(this._filterHandler){const e=new Smart.Utilities.FilterGroup;for(let t in this._filterHandler.filterObject)e[t]=this._filterHandler.filterObject[t];return e}return null}evaluate(e){try{return this._filterHandler.evaluate(e)}catch(e){return!1}}filter(){const e=this;e._filterHandler[e.mode+"Filter"](),e.$.fireEvent("filter")}getState(){return this._filterHandler.cachedFilter}loadState(e){try{const t=this;t._filterHandler.cachedFilter=e,t._filterHandler[t.mode+"Cancel"]()}catch(e){}}propertyChangedHandler(e,t,a){super.propertyChangedHandler(e,t,a);const l=this,i=l._filterHandler;function s(){l.$.mainContainer.innerHTML="",function(){const e=["cachedFilter","caseSensitive","customExcelFilterObjects","customItems","dataSource","defaultListSelection","defaultListSource","displayMode","filterBuilder","filterBuilderObject","filterBuilderOperations","filterObject","firstInput","firstList","operationsMapping","operatorList","secondInput","secondList","timeOnly","tree"];e.forEach((function(t){delete i[e[t]]})),delete l._filterHandler}(),l._filterHandler=new(Smart.Utilities[l.filterType.slice(0,1).toUpperCase()+l.filterType.slice(1)+"FilterHandler"])(l)}switch(e){case"animation":case"disabled":case"rightToLeft":case"unfocusable":switch(l.mode){case"default":case"basic":[i.firstList,i.firstInput,i.logicalOperatorList,i.secondList,i.secondInput].forEach((function(t){t[e]=a}));break;case"excel":i.tree[e]=a;break;case"filterBuilder":i.filterBuilder[e]=a,i.caseSensitive&&(i.caseSensitive[e]=a)}break;case"buttons":l._setButtonsVisibility();break;case"data":case"dataField":"excel"!==l.mode||Array.isArray(l.dataSource)||s();break;case"dataSource":"excel"===l.mode&&s();break;case"filterType":l._filterType=a+"Filter",s();break;case"mode":s();break;case"formatString":if("date"!==l.filterType)return;switch(l.mode){case"default":case"basic":i.firstInput.formatString=a,i.secondInput.formatString=a;break;case"excel":s();break;case"filterBuilder":i.filterBuilder.formatStringDate=a,i.filterBuilder.formatStringDateTime=a}break;case"locale":case"messages":switch(l._localize(),l.mode){case"default":case"basic":{const t=i.firstList.selectedIndex,a=i.logicalOperatorList.selectedIndex,s=i.secondList.selectedIndex,r=[i.firstInput,i.secondInput];switch(i.setDefaults(),i.firstList.dataSource=i.defaultListSource,i.logicalOperatorList.dataSource=[{value:0,label:l.localize("and")},{value:1,label:l.localize("or")}],i.secondList.dataSource=i.defaultListSource,l.filterType){case"date":r.forEach((function(t){t.messages[l.locale]||(t.messages[l.locale]={});const a=l.localize("dateTabLabel");a&&(t.messages[l.locale].dateTabLabel=a);const i=l.localize("timeTabLabel");if(i&&(t.messages[l.locale].timeTabLabel=i),"locale"===e&&(t.locale=l.locale),"timePicker"===t._dropDownDisplayMode){const e=l.localize("placeholderTime");e&&(t.placeholder=e,t.placeholder=e)}else{const e=l.localize("placeholderDate");e&&(t.placeholder=e,t.placeholder=e)}}));break;case"numeric":r[0].placeholder=l.localize("placeholderNumber"),r[1].placeholder=l.localize("placeholderNumber");break;case"string":r[0].placeholder=l.localize("placeholderValue"),r[1].placeholder=l.localize("placeholderValue");break;case"boolean":r[0].placeholder=l.localize("placeholderBoolean"),r[1].placeholder=l.localize("placeholderBoolean")}i.firstList.selectedIndex=t,i.logicalOperatorList.selectedIndex=a,i.secondList.selectedIndex=s;break}case"excel":i.tree.selectAll.label=l.localize("selectAll"),i.tree.blanks&&(i.tree.blanks.label=l.localize("blanks"));break;case"filterBuilder":i.localizeFilterBuilder(),"messages"===e&&(i.filterBuilder._localizeInitialValues(),i.filterBuilder._refresh()),i.filterBuilder.$.scrollableContainer.refresh()}}}_localize(){const e=this;e.localize("showRows")&&(e.$.label.innerHTML=e.localize("showRows")),e.localize("filter")&&(e.$.filterButton.innerHTML=e.localize("filter")),e.localize("clear")&&(e.$.clearButton.innerHTML=e.localize("clear")),e.localize("cancel")&&(e.$.cancelButton.innerHTML=e.localize("cancel"))}_setButtonsVisibility(){const e=this,t=e.buttons;["cancel","clear","filter"].forEach((function(a){-1!==t.indexOf(a)?e["$"+a+"Button"].removeClass("smart-hidden"):e["$"+a+"Button"].addClass("smart-hidden")}))}}),Smart.Utilities.Assign("BaseFilterHandler",class{constructor(e){const t=this;if(t.basicFilter=t.defaultFilter,t.basicClear=t.defaultClear,t.basicCancel=t.defaultCancel,t.context=e,t.filterObject=new Smart.Utilities.FilterGroup,t.setDefaults(),"date"===e.filterType){const a=new Smart.Utilities.DateTime,l=e.formatString,i=a.getParseRegExp(a.calendar,l.replace(/y+/g,"yyyyy"));t.displayMode=Smart.Utilities.DateTime.detectDisplayMode(a,l,i),t.timeOnly="timePicker"===t.displayMode}"default"!==e.mode&&"basic"!==e.mode?(t.operationsMapping={"=":"EQUAL","<>":"NOT_EQUAL","<":"LESS_THAN",">":"GREATER_THAN","<=":"LESS_THAN_OR_EQUAL",">=":"GREATER_THAN_OR_EQUAL",isblank:"EMPTY",isnotblank:"NOT_EMPTY",contains:"CONTAINS",notcontains:"DOES_NOT_CONTAIN",startswith:"STARTS_WITH",endswith:"ENDS_WITH",NULL:"NULL",NOT_NULL:"NOT_NULL"},"excel"===e.mode?t.createExcelHTMLStructure():"filterBuilder"===e.mode&&t.createBuilderHTMLStructure()):t.createDefaultHTMLStructure()}setDefaults(){const e=this,t=e.context;e.defaultListSource=[{prefix:'<span class="smart-icon smart-icon-equal"></span>',value:"EQUAL",label:t.localize("equal")},{prefix:'<span class="smart-icon smart-icon-not-equal"></span>',value:"NOT_EQUAL",label:t.localize("notEqual")},{prefix:'<span class="smart-icon smart-icon-less-than"></span>',value:"LESS_THAN",label:t.localize("lessThan")},{prefix:'<span class="smart-icon smart-icon-less-than-equal"></span>',value:"LESS_THAN_OR_EQUAL",label:t.localize("lessThanOrEqual")},{prefix:'<span class="smart-icon smart-icon-greater-than"></span>',value:"GREATER_THAN",label:t.localize("greaterThan")},{prefix:'<span class="smart-icon smart-icon-greater-than-equal"></span>',value:"GREATER_THAN_OR_EQUAL",label:t.localize("greaterThanOrEqual")},{prefix:'<span class="smart-icon smart-icon-null"></span>',value:"NULL",label:t.localize("null")},{prefix:'<span class="smart-icon smart-icon-not-null"></span>',value:"NOT_NULL",label:t.localize("notNull")}],e.filterBuilderOperations=["<","=","<>","<=",">",">=","NULL","NOT_NULL"],e.defaultListSelection=2}createDefaultHTMLStructure(){const e=this,t=e.context,a=document.createElement("smart-input"),l=document.createElement("smart-input"),i=document.createElement("smart-input"),s=document.createDocumentFragment(),r=e=>{e.readonly=!0,e.dropDownButtonPosition="right"};a.classList.add("smart-filter-panel-list"),a.dataSource=e.defaultListSource,a.selectedIndex=e.defaultListSelection,r(a),l.classList.add("smart-filter-panel-operator-list"),l.dataSource=[{value:0,label:t.localize("and")},{value:1,label:t.localize("or")}],r(l),i.classList.add("smart-filter-panel-list"),i.dataSource=e.defaultListSource,i.selectedIndex=e.defaultListSelection,r(i),e.firstList=a,e.logicalOperatorList=l,e.secondList=i;const n=document.createElement("span");n.classList.add("smart-icon","smart-icon-font-size"),n.title=t.localize("matchCase");const c=document.createElement("span");c.classList.add("smart-icon","smart-icon-font-size"),c.title=t.localize("matchCase"),e.firstInputMatchCase=n,e.secondInputMatchCase=c,e.appendInputs(),e.firstInput.classList.add("smart-filter-panel-input"),e.secondInput.classList.add("smart-filter-panel-input"),"basic"===t.mode&&(e.secondList.classList.add("smart-hidden"),e.secondInput.classList.add("smart-hidden"),e.logicalOperatorList.classList.add("smart-hidden"),e.secondInputMatchCase.classList.add("smart-hidden")),l.dropDownHeight="auto",l.selectedIndex=0,[a,e.firstInput,e.firstInputMatchCase,l,i,e.secondInput,e.secondInputMatchCase].forEach((function(e){e.animation=t.animation,e.disabled=t.disabled,e.unfocusable=t.unfocusable,e.dropDownPosition="bottom",e.dropDownAppendTo="body",e.dropDownMaxHeight=200,e.rightToLeft=t.rightToLeft,s.appendChild(e)})),e.context.$.mainContainer.appendChild(s),e.cacheFilter(e.defaultListSelection,0,e.defaultListSelection)}cacheFilter(e,t,a){const l=this;l.cachedFilter={firstFilterComparison:e,firstFilterValue:l.firstInput.value,firstFilterCaseSensitive:l.firstInputMatchCase.classList.contains("active"),logicalOperator:t,secondFilterComparison:a,secondFilterValue:l.secondInput.value,secondFilterCaseSensitive:l.secondInputMatchCase.classList.contains("active")}}defaultFilter(){const e=this,t=e.context,a=e.getFilterInputValue(e.firstInput),l=parseFloat(e.logicalOperatorList.selectedValues[0]),i=e.getFilterInputValue(e.secondInput),s=e.filterObject;let r=e.firstList.selectedValues[0],n=e.secondList.selectedValues[0];s.clear();const c=e=>"CONTAINS"===e?"CONTAINS_CASE_SENSITIVE":"DOES_NOT_CONTAIN"===e?"DOES_NOT_CONTAIN_CASE_SENSITIVE":"STARTS_WITH"===e?"STARTS_WITH_CASE_SENSITIVE":"ENDS_WITH"===e?"ENDS_WITH_CASE_SENSITIVE":"EQUAL"===e?"EQUAL_CASE_SENSITIVE":"NOT_EQUAL"===e?"NOT_EQUAL_CASE_SENSITIVE":void 0;if(e.firstInputMatchCase.classList.contains("active")&&(r=c(r)),e.secondInputMatchCase.classList.contains("active")&&(n=c(n)),""!==a||-1!==["NULL","NOT_NULL","EMPTY","NOT_EMPTY"].indexOf(r)){const i=s.createFilter(t._filterType,a,r,void 0,t.formatString,t.locale,"timePicker"===e.firstInput._dropDownDisplayMode);s.addFilter(l,i)}if(""!==i||-1!==["NULL","NOT_NULL","EMPTY","NOT_EMPTY"].indexOf(n)){const a=s.createFilter(t._filterType,i,n,void 0,t.formatString,t.locale,"timePicker"===e.secondInput._dropDownDisplayMode);s.addFilter(l,a)}e.cacheFilter(e.firstList.selectedIndexes[0],e.logicalOperatorList.selectedIndexes[0],e.secondList.selectedIndexes[0])}getFilterInputValue(e){return e.value}excelFilter(){const e=this,t=e.context;if(Array.isArray(t.dataSource))return void e.customExcelFilter();const a=e.tree,l=e.filterObject;if(l.clear(),e.customItems=[],a._menuItems[0].selected)return void e.excelClear();const i=a.selectedIndexes;if(i.forEach((function(i){const s=a._menuItems[i];if(s instanceof Smart.TreeItem){const a=s.value;if(s.hasAttribute("default-item"))if(a instanceof Date){const i=new Smart.FilterGroup,s=new Date(a.getFullYear(),a.getMonth(),1),r=new Date(a.getFullYear(),a.getMonth()+1,0),n=i.createFilter(t._filterType,s,"GREATER_THAN_OR_EQUAL",void 0,t.formatString,t.locale,e.timeOnly),c=i.createFilter(t._filterType,r,"LESS_THAN_OR_EQUAL",void 0,t.formatString,t.locale,e.timeOnly);i.addFilter("and",n),i.addFilter("and",c),l.addFilter("or",i)}else{const i=e.getExcelComparison(a),s=l.createFilter(t._filterType,a,i,void 0,t.formatString,t.locale,e.timeOnly);l.addFilter("or",s)}else e.customItems.push(s)}})),0===i.length){const a=e.getExcelComparison("Empty Filter"),i=l.createFilter(t._filterType,"Empty Filter",a,void 0,t.formatString,t.locale,e.timeOnly);l.addFilter("or",i)}e.cachedFilter=i.slice(0)}customExcelFilter(){const e=this,t=e.tree;if(delete e.customExcelFilterObjects,t._menuItems[0].selected)return;const a=e.context,l=[],i=t.selectedIndexes;i.forEach((function(i){const s=t._menuItems[i];if(s instanceof Smart.TreeItem){let t=s.value;if(!Array.isArray(t))return;Array.isArray(t[0])||(t=[t]);const i=new Smart.Utilities.FilterGroup;for(let l=0;l<t.length;l++){const s=t[l],r=e.operationsMapping[s[1]],n=i.createFilter(a._filterType,s[2],r,void 0,a.formatString,a.locale,e.timeOnly);i.addFilter("and",n)}l.push(i)}})),e.customExcelFilterObjects=l,e.cachedFilter=i.slice(0)}getExcelComparison(e){return""===e?"NULL":"EQUAL"}filterBuilderFilter(){const e=this,t=e.filterBuilder.value,a="string"===e.context.filterType&&e.caseSensitive.checked,l={filters:[]};!function t(l,i){const s=new Smart.Utilities.FilterGroup,r=l[1];i.logicalOperator=r;for(let n=0;n<l.length;n++){if(1===n)continue;const c=l[n];if(Array.isArray(c))if(Array.isArray(c[0])){const e={filters:[]};i.filters.push(e),t(c,e)}else s.addFilter(r,e.createFilterBuilderFilter(s,c,a))}s.filters.length>0&&i.filters.push(s)}(t,l),e.filterBuilderObject=l,e.cachedFilter={filterBuilder:JSON.parse(JSON.stringify(e.filterBuilder.value),(function(e,t){return/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}).(\d{3})Z$/.test(t)?new Date(t):t})),caseSensitive:a}}createFilterBuilderFilter(e,t,a){const l=this.context;let i=this.operationsMapping[t[1]];return a&&-1!==["CONTAINS","DOES_NOT_CONTAIN","STARTS_WITH","ENDS_WITH","EQUAL"].indexOf(i)&&(i+="_CASE_SENSITIVE"),e.createFilter(l._filterType,t[2],i,void 0,l.formatString,l.locale,!1)}defaultClear(){const e=this;e.firstList.selectedIndexes=[e.defaultListSelection],e.firstInput.value="",e.logicalOperatorList.selectedIndexes=[0],e.secondList.selectedIndexes=[e.defaultListSelection],e.secondInput.value="",e.filterObject.clear(),e.cacheFilter(e.defaultListSelection,0,e.defaultListSelection)}excelClear(){const e=this;0!==e.tree.offsetHeight&&e.tree.select("0"),e.filterObject.clear(),e.cachedFilter=e.tree.selectedIndexes.slice(0)}filterBuilderClear(){const e=this;e.filterBuilder.value=["and"],"string"===e.context.filterType&&(e.caseSensitive.checked=!1),e.cachedFilter={filterBuilder:["and"],caseSensitive:!1}}defaultCancel(){const e=this;let t=null,a=null;if(e.filterObject){const l=e.filterObject.stringConditions,i=e.filterObject.numericConditions,s=e.filterObject.booleanConditions,r=e.filterObject.dateConditions;t=l[e.cachedFilter.firstFilterComparison],a=l[e.cachedFilter.secondFilterComparison],e.cachedFilter.firstFilterValue&&"string"!=typeof e.cachedFilter.firstFilterValue&&(!0===e.cachedFilter.firstFilterValue||!1===e.cachedFilter.firstFilterValue?(t=s[e.cachedFilter.firstFilterComparison],a=s[e.cachedFilter.secondFilterComparison]):e.cachedFilter.firstFilterValue&&e.cachedFilter.firstFilterValue instanceof Date?(t=r[e.cachedFilter.firstFilterComparison],a=r[e.cachedFilter.secondFilterComparison]):(t=i[e.cachedFilter.firstFilterComparison],a=i[e.cachedFilter.secondFilterComparison]))}let l=-1;e.firstList.dataSource.find(((e,a)=>{if(e.value===t)return l=a,e}));let i=-1;e.secondList.dataSource.find(((e,t)=>{if(e.value===a)return i=t,e})),e.firstList.selectedIndexes=[l],e.firstInput.value=e.cachedFilter.firstFilterValue,e.cachedFilter.firstFilterCaseSensitive&&e.firstInputMatchCase.classList.add("active"),e.logicalOperatorList.selectedIndexes=[e.cachedFilter.logicalOperator],e.secondList.selectedIndexes=[i],e.secondInput.value=e.cachedFilter.secondFilterValue,e.cachedFilter.firstFilterCaseSensitive&&e.firstInputMatchCase.classList.add("active"),e.cachedFilter.secondFilterCaseSensitive&&e.secondInputMatchCase.classList.add("active")}excelCancel(){const e=this;if(e.cachedFilter&&e.cachedFilter.firstFilterValue){const t=e.cachedFilter.firstFilterValue,a=e.cachedFilter.secondFilterValue,l=e.cachedFilter.firstFilterComparison,i=e.cachedFilter.secondFilterComparison;let s=e.filterObject.stringConditions;if(isNaN(parseFloat(t))||(s=e.filterObject.numericConditions),e.dataSource){let r=[];return e.dataSource.forEach(((e,n)=>{r.push("0."+n),e.label===t||e.label===a?("NOT_EQUAL"!==s[l]&&"DOES_NOT_CONTAIN"!==s[l]||r.pop(),"NOT_EQUAL"!==s[i]&&"DOES_NOT_CONTAIN"!==s[i]||r.pop()):e.label===t&&e.label===a||("EQUAL"!==s[l]&&"CONTAINS"!==s[l]&&"ENDS_WITH"!==s[l]&&"STARTS_WITH"!==s[l]||r.pop(),"EQUAL"!==s[i]&&"CONTAINS"!==s[i]&&"ENDS_WITH"!==s[i]&&"STARTS_WITH"!==s[i]||r.pop())})),void setTimeout((()=>{e.tree.selectedIndexes=r}))}}e.tree.selectedIndexes=e.cachedFilter.slice(0)}filterBuilderCancel(){const e=this;e.filterBuilder.value=e.cachedFilter.filterBuilder,"string"===e.context.filterType&&(e.caseSensitive.checked=e.cachedFilter.caseSensitive)}createExcelHTMLStructure(){const e=this,t=e.context,a=document.createElement("smart-tree"),l={data:t.data,dataField:t.dataField,filterType:t._filterType};if(t.dataSource&&Array.isArray(t.dataSource))e.processCustomDataSource(a);else{if(t.data&&t.dataField||t.error(t.localize("missingProperty")),"date"===t.filterType){l.formatString=t.formatString,l.displayMode=e.displayMode,e.dataSource=e.filterObject.getUniqueValues(l,t);try{e.getHierarchicalDataSource(e.displayMode)}catch(e){t.error(t.localize("mismatchedProperties"))}e.timeOnly?a.classList.add("standard-excel"):a.classList.add("date-excel")}else e.dataSource=e.filterObject.getUniqueValues(l,t),a.classList.add("standard-excel");"function"==typeof t.dataSource&&(e.dataSource=t.dataSource(e.dataSource)||e.dataSource)}a.animation=t.animation,a.disabled=t.disabled,a.unfocusable=t.unfocusable,a.dataSource=[{label:t.localize("selectAll"),value:"",items:e.dataSource,expanded:!0,selected:!0}],a.selectionMode="checkBox",a.hasThreeStates=!0,a.theme=t.theme,a.animation="none",a.toggleMode="arrow",a.rightToLeft=t.rightToLeft,a.addEventListener("collapsing",(function(e){1===e.detail.item.level&&e.preventDefault()})),a._onCompleted=function(){if(e.cachedFilter=a.selectedIndexes.slice(0),a.classList.contains("date-excel"))for(let e in a._menuItems){if("0"===e)continue;const t=a._menuItems[e];t.firstElementChild.style.paddingLeft=20*(t.level-1)-10+"px"}else a._menuItems[0].firstElementChild.style.paddingLeft=0;a.selectAll=a._menuItems[0],a.blanks=a.querySelector('[label="'+t.localize("blanks")+'"]')},e.tree=a,t.$.mainContainer.appendChild(a)}processCustomDataSource(e){const t=this.context.dataSource;e.classList.add("standard-excel"),this.dataSource=t}createBuilderHTMLStructure(){const e=this,t=e.context,a=document.createElement("smart-filter-builder"),l=t.dataField,i="numeric"===t.filterType?"number":t.filterType;if(e.filterBuilder=a,a.animation=t.animation,a.disabled=t.disabled,a.unfocusable=t.unfocusable,a.value=["and"],a.fields=[{label:l,dataField:l,dataType:i,filterOperations:e.filterBuilderOperations}],e.localizeFilterBuilder(),t.$.mainContainer.appendChild(a),"string"===i){const a=document.createElement("smart-check-box");a.classList.add("case-sensitive"),a.innerHTML="Case sensitive",a.animation=t.animation,a.disabled=t.disabled,a.unfocusable=t.unfocusable,a.checked=!1,e.caseSensitive=a,t.$.mainContainer.appendChild(a)}e.filterBuilderObject={filters:[]},e.cachedFilter={filterBuilder:["and"],caseSensitive:!1}}localizeFilterBuilder(){const e=this.context,t=this.filterBuilder;let a=t.messages[e.locale];a||(a={},t.messages[e.locale]=a),t.customOperations=[{name:"NULL",label:e.localize("null"),hideValue:!0},{name:"NOT_NULL",label:e.localize("notNull"),hideValue:!0}],a.addCondition=e.localize("addCondition"),a.addGroup=e.localize("addGroup"),a["<"]=e.localize("lessThan"),a["<="]=e.localize("lessThanOrEqual"),a["<>"]=e.localize("notEqual"),a["="]=e.localize("equal"),a[">"]=e.localize("greaterThan"),a[">="]=e.localize("greaterThanOrEqual"),a.and=e.localize("and"),a.contains=e.localize("contains"),a.endswith=e.localize("endsWith"),a.isblank=e.localize("empty"),a.isnotblank=e.localize("notEmpty"),a.notcontains=e.localize("doesNotContain"),a.or=e.localize("or"),a.startswith=e.localize("startsWith"),a.dateTabLabel=e.localize("dateTabLabel"),a.timeTabLabel=e.localize("timeTabLabel"),t.formatStringDate=e.formatString,t.formatStringDateTime=e.formatString,t.locale=e.locale,t.valuePlaceholder=e.localize("filterBuilderPlaceholder")}evaluate(e){const t=this,a=t.context;if("default"===a.mode||"basic"===a.mode)return t.filterObject.evaluate(e);if("excel"===a.mode){let l=!1;if(Array.isArray(a.dataSource)){if(!t.customExcelFilterObjects||0===t.customExcelFilterObjects.length)return!0;for(let a=0;a<t.customExcelFilterObjects.length;a++)l=l||t.customExcelFilterObjects[a].evaluate(e);return l}if(t.customItems&&t.customItems.length>0){if(t.filterObject.filters.length>0&&(l=t.filterObject.evaluate(e)),t.customItems&&a.evaluateFilterExpression)for(let i=0;i<t.customItems.length;i++){const s=a.evaluateFilterExpression(e,t.customItems[i].value);void 0!==s&&(l=l||s)}}else l=t.filterObject.evaluate(e);return l}return!t.filterBuilderObject.logicalOperator||function t(a){let l="and"===a.logicalOperator;for(let i=0;i<a.filters.length;i++){let s;s=a.filters[i]instanceof Smart.Utilities.FilterGroup?a.filters[i].evaluate(e):t(a.filters[i]),l="and"===a.logicalOperator?l&&s:l||s}return l}(t.filterBuilderObject)}}),Smart.Utilities.Assign("NumericFilterHandler",class extends Smart.Utilities.BaseFilterHandler{appendInputs(){let e=this,t=document.createElement("smart-number-input"),a=document.createElement("smart-number-input");t.placeholder=e.context.localize("placeholderNumber"),a.placeholder=e.context.localize("placeholderNumber"),t.nullable=!0,t.spinButtons=!0,t.value=null,a.nullable=!0,a.spinButtons=!0,a.value=null,e.firstInput=t,e.secondInput=a}getFilterInputValue(e){return null===e.value||""===e.value?"":parseFloat(e.value)}}),Smart.Utilities.Assign("StringFilterHandler",class extends Smart.Utilities.BaseFilterHandler{setDefaults(){const e=this,t=e.context;e.defaultListSource=[{prefix:'<span class="smart-icon smart-icon-empty"></span>',value:"EMPTY",label:t.localize("empty")},{prefix:'<span class="smart-icon smart-icon-not-empty"></span>',value:"NOT_EMPTY",label:t.localize("notEmpty")},{prefix:'<span class="smart-icon smart-icon-contains"></span>',value:"CONTAINS",label:t.localize("contains")},{prefix:'<span class="smart-icon smart-icon-does-not-contain"></span>',value:"DOES_NOT_CONTAIN",label:t.localize("doesNotContain")},{prefix:'<span class="smart-icon smart-icon-starts-with"></span>',value:"STARTS_WITH",label:t.localize("startsWith")},{prefix:'<span class="smart-icon smart-icon-ends-with"></span>',value:"ENDS_WITH",label:t.localize("endsWith")},{prefix:'<span class="smart-icon smart-icon-equal"></span>',value:"EQUAL",label:t.localize("equal")},{prefix:'<span class="smart-icon smart-icon-not-equal"></span>',value:"NOT_EQUAL",label:t.localize("notEqual")},{prefix:'<span class="smart-icon smart-icon-null"></span>',value:"NULL",label:t.localize("null")},{prefix:'<span class="smart-icon smart-icon-not-null"></span>',value:"NOT_NULL",label:t.localize("notNull")}],e.filterBuilderOperations=["contains","isblank","isnotblank","notcontains","startswith","endswith","=","NULL","NOT_NULL"],e.defaultListSelection=2}appendInputs(){const e=this,t=document.createElement("input"),a=document.createElement("input");t.placeholder=e.context.localize("placeholderValue"),t.setAttribute("aria-label",t.placeholder),a.placeholder=e.context.localize("placeholderValue"),a.setAttribute("aria-label",a.placeholder),t.classList.add("smart-input"),a.classList.add("smart-input"),e.firstInput=t,e.secondInput=a,e.firstInputMatchCase.onclick=()=>{e.firstInputMatchCase.classList.toggle("active")},e.secondInputMatchCase.onclick=()=>{e.secondInputMatchCase.classList.toggle("active")};const l=(e,t,a)=>{if(0===e.selectedValues.length)return t.classList.remove("case-sensitive"),void a.classList.remove("case-sensitive");const l=e.selectedValues[0];t.classList.remove("case-sensitive"),a.classList.remove("case-sensitive"),["EQUAL","NOT_EQUAL","CONTAINS","DOES_NOT_CONTAIN","STARTS_WITH","ENDS_WITH"].indexOf(l)>=0&&(t.classList.add("case-sensitive"),a.classList.add("case-sensitive"))};e.firstList.onchange=()=>{l(e.firstList,e.firstInput,e.firstInputMatchCase)},e.secondList.onchange=()=>{l(e.secondList,e.secondInput,e.secondInputMatchCase)},setTimeout((()=>{l(e.firstList,e.firstInput,e.firstInputMatchCase),l(e.secondList,e.secondInput,e.secondInputMatchCase)}),50)}getExcelComparison(e){return""===e?"EMPTY":"EQUAL_CASE_SENSITIVE"}}),Smart.Utilities.Assign("DateFilterHandler",class extends Smart.Utilities.BaseFilterHandler{appendInputs(){let e=this,t=e.context,a=document.createElement("smart-date-input"),l=document.createElement("smart-date-input");t.formatString&&!(t.formatString.indexOf("d")>=0||t.formatString.indexOf("M")>=0||t.formatString.indexOf("y")>=0)&&(a=document.createElement("smart-time-input"),l=document.createElement("smart-time-input")),a.calendarButton=!0,a.editMode="partial",a.formatString=t.formatString,a.dropDownDisplayMode="auto",a.locale=t.locale,a.autoClose=!0,a.messages[t.locale]||(a.messages[t.locale]={}),a.messages[t.locale].dateTabLabel=t.localize("dateTabLabel"),a.messages[t.locale].timeTabLabel=t.localize("timeTabLabel"),a.nullable=!0,a.value=null,l.autoClose=!0,l.calendarButton=!0,l.formatString=t.formatString,l.dropDownDisplayMode="auto",l.locale=t.locale,l.messages[t.locale]||(l.messages[t.locale]={}),l.messages[t.locale].dateTabLabel=t.localize("dateTabLabel"),l.messages[t.locale].timeTabLabel=t.localize("timeTabLabel"),l.nullable=!0,l.value=null,e.firstInput=a,e.secondInput=l}getFilterInputValue(e){if(null===e.value)return"";const t=e.getDate();return"calendar"===this.displayMode&&t.setHours(0,0,0),t}defaultClear(){const e=this;e.firstList.selectedIndexes=[e.defaultListSelection],e.firstInput.value=null,e.logicalOperatorList.selectedIndexes=[0],e.secondList.selectedIndexes=[e.defaultListSelection],e.secondInput.value=null,e.filterObject.clear(),e.cacheFilter(e.defaultListSelection,0,e.defaultListSelection)}getHierarchicalDataSource(e){const t=this,a=t.dataSource,l={},i=[];let s;if("timePicker"!==e){""===a[a.length-1].value&&(s=a[a.length-1],a.pop()),a.forEach((function(e){const a=e.value,i=a.getFullYear(),s=new Intl.DateTimeFormat(t.context.locale,{month:"long"}).format(a);l[i]||(l[i]={}),l[i][s]||(l[i][s]=e.value)}));for(let e in l){const t={expanded:!0,label:e,items:[],customAttribute:"default-item"};i.push(t);for(let a in l[e]){const i={value:l[e][a],expanded:!0,label:a,items:[],customAttribute:"default-item"};t.items.push(i)}}s&&i.push(s),t.dataSource=i}}}),Smart.Utilities.Assign("BooleanFilterHandler",class extends Smart.Utilities.BaseFilterHandler{cacheFilter(e,t,a){const l=this;l.cachedFilter={firstFilterComparison:e,firstFilterValue:l.firstInput.selectedIndexes.slice(0),logicalOperator:t,secondFilterComparison:a,secondFilterValue:l.secondInput.selectedIndexes.slice(0)}}setDefaults(){const e=this,t=e.context;e.defaultListSource=[{prefix:'<span class="smart-icon smart-icon-equal"></span>',value:"EQUAL",label:t.localize("equal")},{prefix:'<span class="smart-icon smart-icon-not-equal"></span>',value:"NOT_EQUAL",label:t.localize("notEqual")},{prefix:'<span class="smart-icon smart-icon-null"></span>',value:"NULL",label:t.localize("null")},{prefix:'<span class="smart-icon smart-icon-not-null"></span>',value:"NOT_NULL",label:t.localize("notNull")}],e.filterBuilderOperations=["=","<>","NULL","NOT_NULL"],e.defaultListSelection=0}appendInputs(){const e=this,t=document.createElement("smart-input"),a=document.createElement("smart-input");t.dataSource=[{value:!0,label:"true"},{value:!1,label:"false"}],t.placeholder=e.context.localize("placeholderBoolean"),t.selectedIndexes=[],t.selectionMode="zeroOrOne",t.readonly=!0,t.dropDownButtonPosition="right",a.dataSource=[{value:!0,label:"true"},{value:!1,label:"false"}],a.placeholder=e.context.localize("placeholderBoolean"),a.selectedIndexes=[],a.selectionMode="zeroOrOne",a.readonly=!0,a.dropDownButtonPosition="right",e.firstInput=t,e.secondInput=a}getFilterInputValue(e){return 0===e.selectedValues.length?"":!0===e.selectedValues[0]}defaultClear(){const e=this;e.firstList.selectedIndexes=[e.defaultListSelection],e.firstInput.selectedIndexes=[],e.logicalOperatorList.selectedIndexes=[0],e.secondList.selectedIndexes=[e.defaultListSelection],e.secondInput.selectedIndexes=[],e.filterObject.clear(),e.cacheFilter(e.defaultListSelection,0,e.defaultListSelection)}defaultCancel(){const e=this;e.firstList.selectedIndexes=[e.cachedFilter.firstFilterComparison],e.firstInput.selectedIndexes=e.cachedFilter.firstFilterValue,e.logicalOperatorList.selectedIndexes=[e.cachedFilter.logicalOperator],e.secondList.selectedIndexes=[e.cachedFilter.secondFilterComparison],e.secondInput.selectedIndexes=e.cachedFilter.secondFilterValue}});