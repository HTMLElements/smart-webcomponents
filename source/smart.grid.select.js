
/* Smart HTML Elements v4.5.0 (2019-Sep) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Select",class{_refreshSelection(){const e=this;if(e.selection.enabled){const l=e._selectionColumn;l.refresh()}e._refreshCellSelectionRect()}_toggleColumnSelection(e){const l=this;if(!l.selection.enabled||"none"===l.selection.checkBoxes.selectAllMode)return void(l._inputOverlay&&l._inputOverlay.parentNode&&l._inputOverlay.parentNode.removeChild(l._inputOverlay));let n=e.element.getAttribute("selected");n="indeterminate"===n||""!==n;let t=l._recyclingRows;l._selectionColumn._selecting=!0,l.beginUpdate();for(let l=0;l<t.length;l++){const e=t[l];e.selected=n}if(l._selectionColumn._selecting=!1,l.endUpdate(!1),l._recycle(!1),l.selection.enabled&&l.selection.checkBoxes.enabled&&"none"!==l.selection.checkBoxes.selectAllMode){const n=e.element,t=n.querySelector(".smart-input");l._inputOverlay?l._inputOverlay.parentNode!==l.$.columnHeader&&(l._inputOverlay.parentNode&&l._inputOverlay.parentNode.removeChild(l._inputOverlay),l._inputOverlay=document.createElement("div"),l.$.columnHeader.appendChild(l._inputOverlay)):(l._inputOverlay=document.createElement("div"),l.$.columnHeader.appendChild(l._inputOverlay)),l._inputOverlay.column=e,l._inputOverlay.onpointerdown=function(){l._inputOverlay||(l._inputOverlay.onpointerdown=null);const e=l._inputOverlay.column;l._inputOverlay.classList.remove("smart-animate"),l._selectionColumn._selecting=!0,l.beginUpdate();let n=e.element.hasAttribute("selected"),t=l._recyclingRows;for(let e=0;e<t.length;e++){const l=t[e];l.selected=!n}l._selectionColumn._selecting=!1;const o=l._inputOverlay;return l.endUpdate(!1),l._recycle(),l.$.columnHeader.appendChild(o),l._inputOverlay=o,l._inputOverlay.classList.add("smart-animate"),!1},l._inputOverlay.classList.add("smart-input-overlay"),l._inputOverlay.classList.add("smart-input-overlay-column"),l.appearance.allowCheckBoxesSelectionAnimation&&l._inputOverlay.classList.add("smart-animate"),l._inputOverlay.style.top=(n.offsetHeight-t.offsetHeight)/4+1+"px";const o=l._selectionColumn.element.parentElement.offsetLeft+l._selectionColumn.element.offsetLeft;l._inputOverlay.style.left=o+"px",l._inputOverlay.style.height=n.offsetWidth+"px",l._inputOverlay.style.width=n.offsetWidth+"px",l._inputOverlay.onmousedown=null,l._inputOverlay.classList.add("smart-input-overlay-on"),l._selectionColumn.refresh()}}_refreshCheckBoxColumnSelection(){const e=this;if(e.selection.enabled&&e.selection.checkBoxes.enabled){const l=e._selectionColumn.element;"none"===e.selection.checkBoxes.selectAllMode?(l.removeAttribute("checkbox"),l.label.classList.remove("smart-input")):(l.setAttribute("checkbox",""),l.label.classList.add("smart-input")),e._selectionColumn.refresh()}}_handleExtendedRowSelection(e,l){const n=this;if(!e)return;let t=n._recyclingRows;if(n.paging.enabled&&"page"===n.selection.selectAllMode&&(t=t.slice(n.paging.pageIndex*n.paging.pageSize,(n.paging.pageIndex+1)*n.paging.pageSize)),l&&!l.ctrlKey&&(n._selection.rows=[]),l&&!l.shiftKey&&(n._rangeSelectionStartRow=e,n._rangeSelectionEndRow=e),l&&l.shiftKey){n._rangeSelectionEndRow=e;const l=t.indexOf(n._rangeSelectionStartRow),o=t.indexOf(n._rangeSelectionEndRow),d=Math.min(l,o),a=Math.max(l,o);if(-1===l||-1===o)return;for(let e=d;e<=a;e++){const l=t[e];l.setProperty("selected",!0)}}else l&&l.ctrlKey?null===e.selected?e.setProperty("selected",!0):e.setProperty("selected",!e.selected):e.setProperty("selected",!0)}_setSelection(e,l,n){const t=this;if(t.selection.enabled){if(t._lastColumnSelectionRange=null,t._lastRowSelectionRange=null,t.closeMenu(),null===e&&null===l)return void t.clearSelection();const o=function(){if((!n||n.ctrlKey||n.shiftKey)&&"one"!==t.selection.mode||("many"!==t.selection.mode&&(t._selection.rows=[],t._selection.columns=[],t._selection.cells=[]),t._selection.focusedCell=null),t._selection.selectionRect){const e=t._selection.selectionRect;e.parentNode.removeChild(e);const l={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(l.down="touchstart",l.move="touchmove",l.up="touchend"),document.removeEventListener(l.move,e.onMove),document.removeEventListener(l.up,e.onUp),document.removeEventListener(l.down,e.onDown),t._selection.selectionRect=null}};t.beginUpdate();const i=t.columnByDataField[l];if(t.selection.allowCellSelection&&void 0!==e&&null!==e&&i&&!i.autoGenerated){const i=t.rowById[e];let d=i.getCell(l);const a=t._getParentCell(i,l);a&&(d=a.row.getCell(a.column.dataField)),o(),n&&!n.ctrlKey&&(t._selection.rows=[],t._selection.columns=[],"many"!==t.selection.mode&&(t._selection.cells=[])),d.selected="extended"===t.selection.mode?!(n&&n.ctrlKey)||!d.selected:"one"===t.selection.mode||!d.selected,(!n||n.shiftKey)&&t._selection.focusedCell||(t._selection.focusedCell=d),n&&(n.shiftKey||t._selection.focusedCell===d)&&"extended"===t.selection.mode&&(a?t._renderCellSelectionRect(d.row,d.column,a.endRow,a.endColumn):t._renderCellSelectionRect(d.row,d.column,d.row,d.column))}else t.selection.allowRowHeaderSelection&&void 0!==e&&null!==e&&void 0===t.columnByDataField[l]?(o(),t._selectRow(e,n)):t.selection.checkBoxes.enabled&&void 0!==e&&null!==e&&"_checkBoxColumn"===l&&void 0===t.columnByDataField[l]?(o(),t._selectRow(e,n)):void 0!==e&&null!==e&&(void 0===l||void 0!==t.columnByDataField[l])&&t.selection.allowRowSelection?(o(),t._selectRow(e,n)):t.selection.allowColumnHeaderSelection&&i&&(o(),t._selectColumn(l,n));t.endUpdate(!1),t._recycle(),void 0===e||null===e||i||t._renderInputOverlay(e,n)}}_renderCellSelectionRect(e,l,n,t){const o=this;let i=o._recyclingRows;const d=i.indexOf(e),a=i.indexOf(n);if(0<=d&&0<=a){if(!o._selection.selectionRect){const e=o._selection.selectionRect=function(e){const l=document.createElement("div"),n=document.createElement("div"),t=document.createElement("div");return t.classList.add("smart-selection-overlay"),t.appendChild(n),n.appendChild(l),l.classList.add("smart-selection-overlay-content"),n.classList.add("smart-selection-overlay-border-content"),o.selection.allowCellDragSelectionHandle&&e&&n.classList.add("handle"),o.$.scrollView.appendChild(t),t}(!0);if(o.selection.allowCellDragSelectionHandle){let l=null,n=null,t=null;e.onMove=function(e){var d=Math.abs;const a=o._selection.selectionRect;let c=e.clientX,r=e.clientY;e.touches&&(c=e.touches[0].clientX,r=e.touches[0].clientY);const s=function(e){const l=document.elementsFromPoint(e.clientX,e.clientY);let n=null;for(let t=0;t<l.length;t++){const e=l[t];if(e.getAttribute("data-field")){n=e.getAttribute("data-field");break}}let t=null;for(let n=0;n<l.length;n++){const e=l[n];if(e.getAttribute("data-id")){t=e.row;break}}return{column:o.columnByDataField[n],row:t}};if(a.capturedDrag){const l={clientX:c,clientY:r};let n=s(l),t=s({clientX:c,clientY:r+a.top}).row,d=s({clientX:c+a.left,clientY:r}).column;t||(t=i[i.length-1]),d||(d=n.column),t&&d&&n.row&&n.column&&(a.row=n.row,a.column=n.column,a.endDragRow=a.endRow=t,a.endDragColumn=a.endColumn=d,o._dragSelectionStartDataField=a.column.dataField,o._dragSelectionStartRow=a.row,o._selection.focusedCell=a.row.getCell(a.column.dataField)),o._resizeSelectionRect(),e.preventDefault()}else if(a.captured)if(o._dragSelectionStartDataField=o._selection.focusedCell.column.dataField,o._dragSelectionStartRow=o._selection.focusedCell.row,null===n&&null===t&&(30<=d(c-l.left)?n=!0:30<=d(r-l.top)&&(t=!0)),a.lastPoint&&40<=d(a.lastPoint.top-r)?(n=null,t=!0):a.lastPoint&&40<=d(a.lastPoint.left-c)&&(t=null,n=!0),n){const e=a.endDragColumn.dataField,n={clientX:c,clientY:l.top-5},t=s(n);t.row&&t.column&&(a.endDragRow=a.endRow,a.endDragColumn=t.column,a.endDragColumn.dataField!==e&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}else if(t){const e=a.endDragRow,n={clientX:l.left-5,clientY:r},t=s(n);t.row&&t.column&&(a.endDragRow=t.row,a.endDragColumn=a.endColumn,a.endDragRow.id&&a.endDragRow.id!==e.id&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}a.captured&&o.selection.allowDragSelectionAutoScroll&&(o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.selection.isDragging=!0,o._autoScrollSelectionDragInterval=setInterval(function(){const e=o.$.scrollView.getBoundingClientRect();c<=e.left+20?(o.scrollLeft-=15,o._resizeSelectionRect()):c>=e.left+e.width-20&&(o.scrollLeft+=15,o._resizeSelectionRect()),r<=e.top+20?(o.scrollTop-=15,o._resizeSelectionRect()):r>=e.top+e.height-20&&(o.scrollTop+=15,o._resizeSelectionRect())},5))},e.onUp=function(){if(e.captured){o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.editing.editCell||o.editing.editRow||o.focus(),e.capturedDrag=!1,e.captured=!1,n=null,t=null,l=null,e.lastPoint=null;const i=e.cellValues;e.minRow&&e.maxRow&&e.maxRow&&e.maxColumn&&(o._selectCellsRange(e.minRow,e.maxRow,e.minColumn.dataField,e.maxColumn.dataField),e.row=e.minRow,e.column=e.minColumn,e.endColumn=e.maxColumn,e.endRow=e.maxRow,e.cellValues=i,o._resizeSelectionRect(),o.selection.allowCellDragSelectionAutoFill&&o._pasteSelectedCells({row:e.row,endRow:e.endDragRow,column:e.column,endColumn:e.endColumn},i)),e.endDragColumn=null,e.endDragRow=null,e.minColumn=null,e.minRow=null,e.maxColumn=null,e.maxRow=null}},e.onDown=function(n){if(e.captured&&!l){let e=n.clientX,t=n.clientY;n.touches&&(e=n.touches[0].clientX,t=n.touches[0].clientY),l={left:e,top:t}}};const d={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(d.down="touchstart",d.move="touchmove",d.up="touchend"),e["on"+d.down]=function(l){const n=e.getBoundingClientRect();let t=l.clientX,i=l.clientY;l.touches&&(t=l.touches[0].clientX,i=l.touches[0].clientY),t>=n.right-5&&i>=n.bottom-5?(e.captured=!0,e.endDragRow=e.endRow,e.endDragColumn=e.endColumn):o.selection.allowCellDragDropSelectionHandle&&i>=n.bottom-5?(e.captured=!0,e.capturedDrag=!0,e.endDragRow=e.endRow,e.endDragColumn=e.endColumn,e.left=e.endColumn.left-e.column.left,e.top=e.endRow.top-e.row.top):!e.captured&&o._rowDownHandler(l)},document.addEventListener(d.move,e.onMove,{passive:!1}),document.addEventListener(d.up,e.onUp,{passive:!1}),document.addEventListener(d.down,e.onDown,{passive:!1})}}const e=o._selection.selectionRect;e.row=o._selection.focusedCell.row,e.column=o._selection.focusedCell.column,e.endRow=n,e.endDragRow=n,e.endColumn=t,e.endDragColumn=t,o._refreshCellSelectionRect()}}_resizeSelectionRect(){var e=Math.max,l=Math.min;const n=this,t=n._selection.selectionRect;if(!t)return;let o=n._recyclingRows,i=t.row,d=t.endDragRow,a=t.column,c=t.endDragColumn;const r=o.indexOf(i),s=o.indexOf(d),u=o.indexOf(t.endRow),m=n.columns.indexOf(a),g=n.columns.indexOf(c),_=n.columns.indexOf(t.endColumn),w=l(u,l(r,s)),p=e(u,e(r,s)),f=l(_,l(m,g)),h=e(_,e(m,g));t.minRow=u<=l(r,s)?t.endRow:r<=s?i:d,t.maxRow=u>=e(r,s)?t.endRow:r>=s?i:d,t.minColumn=_<=l(m,g)?t.endColumn:m<=g?a:c,t.maxColumn=_>=e(m,g)?t.endColumn:m>=g?a:c;let y=0,S=0,R=0,x=0;for(let e=w;e<=p;e++){const l=o[e];e===w&&(y=l.top),e===p&&(S=l.top+l.height-y);for(let e=f;e<=h;e++){const t=n.columns[e].dataField,o=l.getCell(t);e===f&&(R=o.column.left),e===h&&(x=o.column.left+o.column.computedWidth-R)}}t.style.top=y-n.scrollTop-1+"px",t.style.left=R-n.scrollLeft+"px",t.style.height=S+1+"px",t.style.width=x+1+"px"}_getPatternValue(e,l,n){let t=[],o=0,d=[],a=[],c=[],r=[];const i={names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},s={names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},u=function(e){if(void 0!==e&&!(0<=e.toString().indexOf("GMT+")||0<=e.toString().indexOf("GMT-"))){if(isNaN(parseFloat(e))){if(0<=i.names.indexOf(e))return r=i.names,i.names.indexOf(e);if(0<=i.namesAbbr.indexOf(e))return r=i.namesAbbr,i.namesAbbr.indexOf(e);if(0<=i.namesShort.indexOf(e))return r=i.namesShort,i.namesShort.indexOf(e);if(0<=s.names.indexOf(e))return r=s.names,s.names.indexOf(e);if(0<=s.namesAbbr.indexOf(e))return r=s.namesAbbr,s.namesAbbr.indexOf(e);if(void 0!==e){null===e&&(e="");const l=/\d+/.test(e.toString());if(l){c.push(e.toString().replace(/[0-9]/,"#")),c[c.length-1]=c[c.length-1].replace(/[0-9]/g,"");const l=parseFloat(e.toString().replace(/\D/g,""));return isNaN(l)?0:l}}return}const l=/[A-Za-z]/.test(e.toString());return l?void 0:parseFloat(e)}};let m=0;for(let i in n){let e=n[i];for(let l in t[o]=[],m=0,e){let n=u(e[l]);void 0!==n&&(t[o].push(n),m++)}if(0===t[o].length)continue;let l=t[o][0],a=0;for(let e=0;e<t[o].length;e++){let n=u(t[o][e-1]),i=u(t[o][e]);0==e&&(n=i),l+=i,a+=i-n}l/=t[o].length,l-=t[o][0],l+=t[o][t[o].length-1],0!==a&&(a/=t[o].length-1),(0<r.length||0<c.length)&&(a=1,l=t[o][0]),2>=t[o].length&&(l=t[o][t[o].length-1]+a),d.push({step:a,stepStart:l}),o++}for(let o=0;o<m;o++){let e=t[0][o],l=0;for(let n=1;n<t.length;n++){const i=u(t[n-1][o]),d=u(t[n][o]);e+=d,l+=d-i}e/=t.length,e-=t[0][o],e+=t[t.length-1][o],0!==l&&(l/=t.length-1),(0<r.length||0<c.length)&&(l=1,e=t[0][o]),2>=t.length&&(e=t[t.length-1][o]+l),a.push({step:l,stepStart:e})}if(!t[e]){let n=t.length;for(let o=n;o<=e;o++){t[o]=[];for(let e=0;e<=l;e++)(a[e]||(a[e]=a[e-1]),!!a[e])&&(o===n?t[o][e]=a[e].stepStart:(t[o][e]=t[o-1][e]+a[e].step,1<r.length&&t[o][e]>=r.length&&(t[o][e]=0)))}if(0<r.length)return r[t[e][l]];return 0<c.length?c[e%c.length].replace("#",t[e][l]):t[e][l]}if(!t[e][l]){let n=m;for(let o=n;o<=l;o++)d[e]&&(o==n?t[e].push(d[e].stepStart):(t[e][o]=t[e][o-1]+d[e].step,1<r.length&&t[e][o]>=r.length&&(t[e][o]=0)));return 0<r.length?r[t[e][l]]:0<c.length?c[e%c.length].replace("#",t[e][l]):t[e][l]}return t[e]&&t[e][l]?0<c.length?c[e%c.length].replace("#",t[e][l]):t[e][l]:0}_pasteDataType(e){const l=this,n=l.dataSource&&"number"==typeof l.dataSource.dataSource,t=e.cell,o=e.value;let i=t.column.dataType;return(!i||n)&&(isNaN(parseFloat(o))?i="string":o instanceof Date?i="date":"true"===o||"false"===o?i="boolean":i="number"),i}_pasteModeCopy(e){const l=this,n=l.dataSource&&"number"==typeof l.dataSource.dataSource,t=l._pasteDataType(e),o=e.cell,i=e.value,d=e.dataField;if("string"===t)o.value=i;else if("bool"===t||"boolean"===t)(1===i||"1"===i||!0===i||"true"===i||"TRUE"===i||"True"===i)&&(o.value=!0);else if("date"===t||"time"===t||"dateTime"===t){const e=l.columnByDataField[d];o.value=n?i:e&&e.dataType!==t?null:i}else if("number"===t||"float"===t||"int"===t){const e=l.columnByDataField[d];o.value=n?i:e&&e.dataType!==t?null:null===i?null:"int"===t||"integer"===t?parseInt(i):parseFloat(i)}}_pasteModeFill(e){const l=this,n=l.dataSource&&"number"==typeof l.dataSource.dataSource,t=l._pasteDataType(e),o=e.cell,i=e.selectedValues,d=e.minRowIndex,a=e.minColumnIndex,c=e.currentRowIndex,r=e.currentColumnIndex,s=e.dataField;let u=e.value;if("string"===t){const n=/\d+/.test(u.toString());n?(u=l._getPatternValue(c-d,r-a,i),u===void 0&&i[c-d]&&i[c-d][r-a]&&(u=i[c-d][r-a])):(u=l._getPatternValue(c-d,r-a,i),u=void 0===u?i[c-d]?i[c-d][r-a]:e.value:e.value),u!==void 0&&(o.value=u)}else if("bool"===t||"boolean"===t)(1===u||"1"===u||!0===u||"true"===u||"TRUE"===u||"True"===u)&&(o.value=!0);else if("date"===t||"time"===t||"dateTime"===t){const e=l.columnByDataField[s];n?o.value=u:e&&e.dataType!==t&&(o.value=null),i[c-d]&&(u=i[c-d][r-a],u!==void 0&&(o.value=u))}else if("number"===t||"float"===t||"int"===t){u=l._getPatternValue(c-d,r-a,i);const e=l.columnByDataField[s];o.value=n?u:e&&e.dataType!==t?null:null===u?null:"int"===t||"integer"===t?parseInt(u):parseFloat(u)}}_pasteSelectedCells(e,l){var n=Math.max,t=Math.min;const o=this;o.beginUpdate();let d=o._recyclingRows,i=e.row,a=e.endRow,c=e.column,r=e.endColumn;const s=d.indexOf(i),u=d.indexOf(a),m=d.indexOf(e.endRow),g=o.columns.indexOf(c),_=o.columns.indexOf(r),w=o.columns.indexOf(e.endColumn),p=t(m,t(s,u)),f=n(m,n(s,u)),h=t(w,t(g,_)),y=n(w,n(g,_));let S=0,R=0,x=0,C=0;for(let n in l)0==S&&(R+=Object.keys(l[n]).length),S++;for(let n=p;n<=f;n++){const e=d[n];x=0;for(let t=h;t<=y;t++){const i=o.columns[t].dataField,d=e.getCell(i);let a=0;for(let c in l){if(a===C){let a=0,r=l[c];for(let s in r){if(x===a){let a=r[s],u=!0;if(l[e.id]&&l[e.id][i]&&(u=!1),u&&"none"!==o.clipboard.autoFillMode){const e={value:a,oldValue:d.value,dataField:s,id:c};o.clipboard.onPasteValue?(o.clipboard.onPasteValue(e),d.value=e.value):(e.cell=d,e.selectedValues=l,e.minRowIndex=p,e.maxRowIndex=f,e.minColumnIndex=h,e.maxColumnIndex=y,e.currentColumnIndex=t,e.currentRowIndex=n,"copy"===o.clipboard.autoFillMode?o._pasteModeCopy(e):"fillSeries"===o.clipboard.autoFillMode&&o._pasteModeFill(e))}}a++}}a++}x++,x>=R&&(x=0)}C++,C>=S&&(C=0)}o.endUpdate(!1),o._recycle(!1)}_refreshCellSelectionRect(){var e=Math.max,l=Math.min;const n=this,t=n._selection.selectionRect;if(!t||t&&t.captured)return;let o=n._recyclingRows,i=t.row,d=t.endRow,a=t.column,c=t.endColumn;const r=o.indexOf(i),s=o.indexOf(d),u=n.columns.indexOf(a),m=n.columns.indexOf(c);let g=l(r,s),_=e(r,s),w=l(u,m),p=e(u,m);w=e(0,w),g=e(0,g);const f=function(t){const i=o.indexOf(t.row),d=o.indexOf(t.endRow),a=n.columns.indexOf(t.column),c=n.columns.indexOf(t.endColumn);g=l(g,i),g=l(g,d),g=e(0,g),_=e(_,i),_=e(_,d),w=l(w,a),w=l(w,c),w=e(0,w),p=e(p,a),p=e(p,c)},h=n._getParentCell(i,a.dataField),y=n._getParentCell(i,c.dataField),S=n._getParentCell(d,c.dataField),R=n._getParentCell(d,a.dataField);h&&f(h),y&&f(y),S&&f(S),R&&f(R);let x=0,C=0,F=0,v=0;t.cellValues=[];for(let e=g;e<=_;e++){const l=o[e];if(e===g&&(x=l.top,!0!==l.freeze&&"near"!==l.freeze&&(x+=n.__frozenNearHeight),"far"===l.freeze&&(x=l.top+n.__scrollHeight+n.scrollTop-n._scrollView.hScrollBar.offsetHeight)),e===_){let e=l.top;"far"===l.freeze&&(e=l.top+n.__scrollHeight+n.scrollTop-n._scrollView.hScrollBar.offsetHeight),C=e+l.height-x,!0!==l.freeze&&"near"!==l.freeze&&(C+=n.__frozenNearHeight)}t.cellValues[l.id]=[];for(let e=w;e<=p;e++){const o=n.columns[e].dataField,i=l.getCell(o);if(t.cellValues[l.id][o]=i.value,e===w&&(F=i.column.left,i.column.freeze&&"far"===i.column.freeze&&(F=n.__clientSize.width-n.__frozenFarWidth+F+n.scrollLeft-n._scrollView.vScrollBar.offsetWidth)),e===p){let e=i.column.left;i.column.freeze&&"far"===i.column.freeze&&(e=n.__clientSize.width-n.__frozenFarWidth+e+n.scrollLeft-n._scrollView.vScrollBar.offsetWidth),v=e+i.column.computedWidth-F}i.selected=!0}}t.style.top=x-n.scrollTop-1+"px",t.style.left=F-n.scrollLeft+"px",t.style.height=C+1+"px",t.style.width=v+1+"px"}_renderInputOverlay(e,l,n){const t=this,o=t.rowById[e];if(o&&o.allowSelect&&!o.label&&l&&t.selection.checkBoxes.enabled){t._inputOverlay&&t._inputOverlay.classList.contains("smart-input-overlay-column")&&(t._inputOverlay.parentNode&&t._inputOverlay.parentNode.removeChild(t._inputOverlay),t._inputOverlay=null),t._inputOverlay||(t._inputOverlay=document.createElement("div"),t.$.scrollView.appendChild(t._inputOverlay),t._inputOverlay.classList.add("smart-input-overlay"));let e=o.freeze?o.top:t.__frozenNearHeight+o.top;const i=Math.round((o.cellHeight-t._selectionColumn.computedWidth)/2),d=t._selectionColumn.element.parentElement.offsetLeft+t._selectionColumn.element.offsetLeft;t._inputOverlay.style.left=d+"px",t._inputOverlay.style.height=t._selectionColumn.computedWidth+"px",t._inputOverlay.style.width=t._selectionColumn.computedWidth+"px",t._inputOverlay.style.top=e+i-t.scrollTop+"px",t._inputOverlay.row=o,t._inputOverlay.onpointerdown=function(){t._inputOverlay||(t._inputOverlay.onpointerdown=null);const e=t._inputOverlay.row;t.beginUpdate(),e.selected=!e.selected,t.endUpdate(!1),t._recycle(),t._renderInputOverlay(e.id,l,!0)},t.appearance.allowCheckBoxesSelectionAnimation&&void 0===n&&t._inputOverlay.classList.add("smart-animate"),requestAnimationFrame(()=>{t._inputOverlay&&t._inputOverlay.classList.add("smart-input-overlay-on")})}}_selectRow(e,l){const n=this,t=n.rowById[e];t&&n.selection.enabled&&(!t.header||"row-resize"!==t.header.style.cursor)&&(l&&(!l.shiftKey||!n._selection.focusedCell)&&(n._selection.focusedCell=t.getCell(n.columns[0].dataField)),n._lastRowsSelectionRange=null,"extended"===n.selection.mode?n._handleExtendedRowSelection(t,l):"one"===n.selection.mode?t.selected=!0:t.selected=!t.selected)}_getParentCell(e,l){const n=this;let t=n._recyclingRows;for(let o=0;o<n._cellsMerge.length;o++){const i=n._cellsMerge[o];let d=[],a=[];if(d.push(i.row),1<i.rowSpan){const e=t.indexOf(i.row);if(0<=e)for(let l=e;l<e+i.rowSpan;l++)t[l]&&-1===d.indexOf(t[l])&&d.push(t[l])}if(a.push(i.column.dataField),1<i.colSpan){const e=n.columns.indexOf(n.columnByDataField[i.column.dataField]);for(let l=e;l<e+i.colSpan;l++)n.columns[l]&&-1===a.indexOf(n.columns[l].dataField)&&a.push(n.columns[l].dataField)}if(0<=d.indexOf(e)&&0<=a.indexOf(l))return{row:i.row,column:i.column,endRow:d[d.length-1],endColumn:n.columnByDataField[a[a.length-1]]}}return null}_selectCellsRange(e,l,n,t){var o=Math.max,i=Math.min;const d=this,a=d._selection.selectionRect;if(d._lastRowsSelectionRange&&d._lastRowsSelectionRange.id===e.id&&d._lastRowsSelectionRange.endId===l.id&&d._lastColumnSelectionRange&&d._lastColumnSelectionRange.dataField===n&&d._lastColumnSelectionRange.endDataField===t)return;d.beginUpdate(),d._clearSelection(),d._lastRowsSelectionRange={id:e.id,endId:l.id},d._lastColumnSelectionRange={dataField:n,endDataField:t},(!a||a&&!a.captured)&&d._selection.focusedCell&&d._renderCellSelectionRect(d._selection.focusedCell.row,d._selection.focusedCell.column,d.rowById[d._lastRowsSelectionRange.endId],d.columnByDataField[d._lastColumnSelectionRange.endDataField]);let c=d._recyclingRows,r=-1,s=d.columns.length,u=c.indexOf(e),m=c.indexOf(l);for(let o=0;o<d.columns.length;o++){const e=d.columns[o];e.allowSelect&&(e.dataField===n&&(r=o),e.dataField===t&&(s=o))}let g=i(u,m),_=o(u,m),w=i(r,s),p=o(r,s);const f=function(e){const l=c.indexOf(e.row),n=c.indexOf(e.endRow),t=d.columns.indexOf(e.column),a=d.columns.indexOf(e.endColumn);g=i(g,l),g=i(g,n),_=o(_,l),_=o(_,n),w=i(w,t),w=i(w,a),p=o(p,t),p=o(p,a)},h=d._getParentCell(e,n),y=d._getParentCell(l,t);if(h&&f(h),y&&f(y),0>_||0>g)return d.endUpdate(!1),void d._recycle();for(let o=g;o<=_;o++){const e=c[o];if(e.allowSelect)for(let l=0;l<d.columns.length;l++){const n=d.columns[l];if(n.allowSelect&&l>=w&&l<=p){const l=e.getCell(n.dataField);l.selected=!0}}}d.endUpdate(!1),d._recycle()}_selectRowsRange(e,l){const n=this;if(n._lastRowsSelectionRange&&n._lastRowsSelectionRange.id===e.id&&n._lastRowsSelectionRange.endId===l.id)return;n.beginUpdate(),n._clearSelection(),n._lastRowsSelectionRange={id:e.id,endId:l.id};let t=n._recyclingRows;const o=t.indexOf(e),i=t.indexOf(l),d=Math.min(o,i),a=Math.max(o,i);if(0>a)return n.endUpdate(!1),void n._recycle();for(let n=d;n<=a;n++){const e=t[n];e&&e.allowSelect&&(e.selected=!0)}n.endUpdate(!1),n._recycle()}_selectColumnsRange(e,l){const n=this;if(n._lastColumnSelectionRange&&n._lastColumnSelectionRange.dataField===e&&n._lastColumnSelectionRange.endDataField===l)return;n.beginUpdate(),n._clearSelection(),n._lastColumnSelectionRange={dataField:e,endDataField:l};let t=-1,o=n.columns.length;for(let d=0;d<n.columns.length;d++){const i=n.columns[d];i.allowSelect&&(i.dataField===e&&(t=d),i.dataField===l&&(o=d))}const d=Math.min(t,o),a=Math.max(t,o);for(let t=0;t<n.columns.length;t++){const e=n.columns[t];e.allowSelect&&t>=d&&t<=a&&(e.selected=!0)}n.endUpdate(!1),n._recycle()}_selectColumn(e,l){const n=this,t=n.columnByDataField[e];if(t&&n.selection.enabled&&t.allowSelect&&n.selection.allowColumnHeaderSelection&&!(t&&"col-resize"===t.element.style.cursor)&&l)if("extended"!==n.selection.mode)t.selected="one"===n.selection.mode||null===t.selected||!t.selected;else if(l.ctrlKey||l.shiftKey||(n._rangeSelectionStartColumn=t,n._rangeSelectionEndColumn=t),t.selected=!0,l&&l.shiftKey){n._rangeSelectionStartColumn||(n._rangeSelectionStartColumn=t),n._rangeSelectionEndColumn=t,n._selection.columns=[];const e=n.columns.indexOf(n._rangeSelectionStartColumn),l=n.columns.indexOf(n._rangeSelectionEndColumn),o=Math.min(e,l),d=Math.max(e,l);for(let e=o;e<=d;e++){const l=n.columns[e];l.selected=!0}}}_getSelectedRows(e,l){const n=this,t=[];let o=n.rows;n.rows.canNotify=!1,e&&(o=n.getVisibleRows()),n.paging.enabled&&l&&(o=o.slice(n.paging.pageIndex*n.paging.pageSize,(n.paging.pageIndex+1)*n.paging.pageSize));for(let n=0;n<o.length;n++){const e=o[n];e.getProperty("selected")?t.push(e):(e.canNotify=!1,e.selected=!1,e.canNotify=!0)}return n.rows.canNotify=!0,t}_dragSelectionEnd(){const e=this;e._dragSelectionStartDataField=null,e._dragSelectionStartRow=null;e.selection.allowDragSelection&&e.selection.isDragging&&(e.selection.isDragging=!1,e._autoScrollSelectionDragInterval&&(clearInterval(e._autoScrollSelectionDragInterval),!e.editing.isEditing&&e._recycle()))}_dragSelection(e){const l=this;if("extended"===l.selection.mode&&!1!==l.selection.allowDragSelection&&(l._dragSelectionStartDataField||l._dragSelectionStartRow)){if(l.selection.allowCellSelection&&l._dragSelectionStartDataField&&!l._columnResizeLine&&!l._dragSelectionStartDataField.startsWith("_")&&l._dragSelectionStartRow&&!l._rowResizeLine){const n=document.elementsFromPoint(e.clientX,e.clientY);let t=null;for(let e=0;e<n.length;e++){const l=n[e];if(l.getAttribute("data-field")){t=l.getAttribute("data-field");break}}let o=null;for(let e=0;e<n.length;e++){const l=n[e];if(l.getAttribute("data-id")){o=l.row;break}}return t&&o&&l._selectCellsRange(l._dragSelectionStartRow,o,l._dragSelectionStartDataField,t),void(l.selection.allowDragSelectionAutoScroll&&(l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const n=l.$.scrollView.getBoundingClientRect();e.clientX<=n.left+20?l.scrollLeft-=15:e.clientX>=n.left+n.width-20&&(l.scrollLeft+=15),e.clientY<=n.top+20?l.scrollTop-=15:e.clientY>=n.top+n.height-20&&(l.scrollTop+=15)},5)))}if(l._dragSelectionStartRow&&!l._rowResizeLine&&(l.selection.allowRowSelection&&!l._dragSelectionStartDataField.startsWith("_")||l.selection.allowRowHeaderSelection&&l._dragSelectionStartDataField.startsWith("_"))){const n=document.elementsFromPoint(e.clientX,e.clientY);let t=null;for(let e=0;e<n.length;e++){const l=n[e];if(l.getAttribute("data-id")){t=l.row,!t&&l.cell&&(t=l.cell.row);break}}t&&l._selectRowsRange(l._dragSelectionStartRow,t),l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const n=l.$.scrollView.getBoundingClientRect();e.clientY<=n.top+20?l.scrollTop-=15:e.clientY>=n.top+n.height-20&&(l.scrollTop+=15)},5)}else if(l._dragSelectionStartDataField&&!l._columnResizeLine&&!l._dragSelectionStartDataField.startsWith("_")&&l.selection.allowColumnHeaderSelection){const n=document.elementsFromPoint(e.clientX,e.clientY);let t=null;for(let e=0;e<n.length;e++){const l=n[e];if(l.getAttribute("data-field")){t=l.getAttribute("data-field");break}}t&&l._selectColumnsRange(l._dragSelectionStartDataField,t),l._autoScrollSelectionDragInterval&&clearInterval(l._autoScrollSelectionDragInterval),l.selection.isDragging=!0,l._autoScrollSelectionDragInterval=setInterval(function(){const n=l.$.scrollView.getBoundingClientRect();e.clientX<=n.left+20?l.scrollLeft-=15:e.clientX>=n.left+n.width-20&&(l.scrollLeft+=15)},5)}}}select(e,l){const n=this;n._setSelection(e,l)}unselect(e,l){const n=this;n._selection&&(n._selection.rows&&n._selection.rows[e]&&delete n._selection.rows[e],n._selection.columns&&n._selection.columns[l]&&delete n._selection.columns[l],n._selection.cells&&(n._selection.cells["row"+e]&&(delete n._selection.cells["row"+e][l],1===Object.getOwnPropertyNames(n._selection.cells["row"+e]).length&&delete n._selection.cells["row"+e]),n._selection.cells["column"+l]&&(delete n._selection.cells["column"+l][e],1===Object.getOwnPropertyNames(n._selection.cells["column"+l]).length&&delete n._selection.cells["column"+l])))}getSelection(){const e=this;let l=null,n=null,t=null,o=null;if(e._selection.rows&&0<Object.keys(e._selection.rows).length){const n=Object.keys(e._selection.rows);l=[];for(let t=0;t<n.length;t++){const o=n[t];l.push({id:o,row:e.rowById[o]})}}if(e._selection.columns&&0<Object.keys(e._selection.columns).length){const l=Object.keys(e._selection.columns);n=[];for(let t=0;t<l.length;t++){const o=l[t];n.push({dataField:o,column:e.columnByDataField[o]})}}if(e._selection.cells)for(let l in e._selection.cells)if(l.startsWith("row")){let n=l.replace("row",""),o=null;for(let i in e._selection.cells[l])o=i.replace("column",""),t||(t=[]),t.push({id:n,dataField:o,column:e.columnByDataField[o],row:e.rowById[n]})}return e._selection.focusedCell&&(o={id:e._selection.focusedCell.row.id,dataField:e._selection.focusedCell.column.dataField}),{rows:l,columns:n,cells:t,focused:o}}_clearSelection(e){const l=this;if(l._selection.rows=[],l._selection.columns=[],l._selection.cells=[],e&&(l._selection.focusedCell=null,l._selection.selectionRect)){const e=l._selection.selectionRect;e.parentNode.removeChild(e);const n={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(n.down="touchstart",n.move="touchmove",n.up="touchend"),document.removeEventListener(n.move,e.onMove),document.removeEventListener(n.up,e.onUp),document.removeEventListener(n.down,e.onDown),l._selection.selectionRect=null}l._recycle();const n=l._selectionColumn;n.refresh()}_getSelectionCellValues(){const e=this;if(e._selection.selectionRect)return e._selection.selectionRect.cellValues;if(0<e._selection.rows.length){let l=[];for(let n in e._selection.rows){const t=e.rowById[n];for(let o=0;o<e.columns.length;o++){const i=e.columns[o];i&&(l[n]||(l[n]=[]),l[n][i.dataField]=t.data[i.dataField])}}return l}if(0<e._selection.columns.length){let l=[];for(let n in e._selection.columns){const t=e.columnByDataField[n];if(t)for(let n=0;n<e._recyclingRows.length;n++){const o=e._recyclingRows[n];o&&(l[o.id]||(l[o.id]=[]),l[o.id][t.dataField]=o.data[t.dataField])}}return l}}_clipboardHandler(e,l){const n=this;if(n.clipboard.enabled){if(l.ctrlKey&&("c"===e||"x"===e)){const l=n._getSelectionCellValues();let t="",o=Object.keys(l).length,i=0;for(let n in l){let d="",a=Object.keys(l[n]).length,c=0;for(let e in l[n]){const t=l[n][e];d+=t,c++,c<a&&(d+="\t")}t+=d,i++,i<o&&(t+="\r\n"),"x"===e}navigator.clipboard.writeText(t).then(function(){},function(){})}l.ctrlKey&&"v"===e&&navigator.clipboard.readText().then(e=>{const l=[],t=e.split("\r");for(let n=0;n<t.length;n++){const e=t[n],o=e.split("\t");let i={};for(let e=0;e<o.length;e++)i[e]=o[e].trim();l[n]=i}const o=n._selection.selectionRect;if(o)n._pasteSelectedCells({row:o.row,endRow:o.endDragRow,column:o.column,endColumn:o.endColumn},l);else{let e=null,t=null;for(let l in n._selection.rows){const o=n.rowById[l];e||(e=o),t||(t=o),e.visibleIndex>o.visibleIndex&&(e=o),t.visibleIndex<o.visibleIndex&&(t=o)}e&&t&&n._pasteSelectedCells({row:e,endRow:t,column:n.columns[0],endColumn:n.columns[n.columns.length-1]},l)}})}}_keyDownHandler(e){const l=this;if(l.onKey&&(l.onKey(e),e.defaultPrevented))return;let n=e.key;if(!l.disabled&&!(0===l.dataSource.length||l.disabled||l.displayLoadingIndicator)){l._refreshCellSelectionRect();const t=l.getSelection();let o=t.focused;if(!t.focused){if(l.editing.enabled&&!0!==l.editing.isEditing&&("F2"===n||"Enter"===n)&&t.columns&&0<t.columns.length){const e=t.columns[t.columns.length-1];e.column.allowHeaderEdit&&l._beginColumnEdit(e.column)}return}const i=l._getParentCell(l.rowById[o.id],o.dataField);if(i&&("ArrowLeft"===n?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowRight"===n?(o.id=i.row.id,o.dataField=i.endColumn.dataField):"ArrowUp"===n?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowDown"===n&&(o.id=i.endRow.id,o.dataField=i.column.dataField)),l._selection.selectionRect&&e.shiftKey&&!e.ctrlKey?(l._selection.selectionRect.endRow&&(o.id=l._selection.selectionRect.endRow.id),l._selection.selectionRect.endColumn&&(o.dataField=l._selection.selectionRect.endColumn.dataField)):l.selection.allowRowSelection&&!l.selection.allowCellSelection&&void 0!==l._rangeSelectionEndRow&&(o.id=l._rangeSelectionEndRow.id),l._clipboardHandler(n,e),(e.ctrlKey&&"x"!==n&&"c"!==n&&"v"!==n&&"Control"!==n||"Tab"===n)&&(l._selection.rows=[],l._selection.columns=[],l._selection.cells=[]),"Escape"===n)return l.closeMenu(),l.cancelEdit(),void l._setSelection(o.id,o.dataField,e);if(!l.hasMenu()){if(e.altKey){if("ArrowDown"===n){const n=l.columnByDataField[o.dataField];n&&(n.showActionButton=!0,n.onAction(),l.menu&&(l.menu.querySelector("smart-menu").focus(),l.menu.querySelector("smart-menu").$.dispatch(e)))}else"ArrowUp"===n&&l.closeMenu();if("s"===n.toLowerCase()){const e=l.columnByDataField[o.dataField];e&&(e.sorted?"asc"===e.sortOrder?l.sortBy(e.dataField,"desc"):l.sortBy(e.dataField,null):l.sortBy(e.dataField,"asc"))}if("g"===n.toLowerCase()){const e=l.columnByDataField[o.dataField];e&&(e.group=!e.group)}return}const d=function(n,t){requestAnimationFrame(()=>{"extended"!==l.selection.mode&&l._clearSelection(),l.beginUpdate(),l._setSelection(n,t,e),l.ensureVisible(n,t),l.endUpdate(!1),l._recycle()}),e.stopPropagation(),e.preventDefault()};switch(n){case"Tab":{const n=e.shiftKey?l.prevColumn(o.dataField):l.nextColumn(o.dataField);if(n)l._selection.focusedCell=l.rowById[o.id].getCell(n.dataField),l._setSelection(o.id,n.dataField,e),l.focus(),e.stopPropagation(),e.preventDefault();else{let n=e.shiftKey?l.prevRow(o.id):l.nextRow(o.id),t=e.shiftKey?l.lastColumn().dataField:l.firstColumn().dataField;if(l.editing.addNewRow.autoCreate&&!e.shiftKey&&o.id===l.lastRow().id&&(l.addUnboundRow(1),n=l.lastRow()),!n)return;e.shiftKey&&(l._selection.focusedCell=null),d(n.id,t)}break}case" ":case"F2":{const e=l.rowById[o.id];if(!e||l.editing.editCell)return;" "===n&&l.dataSource.boundHierarchy&&(e.checked=!e.checked),l.editing.enabled&&l._beginEdit(e,o.dataField);break}case"Delete":case"Backspace":{const e=l.rowById[o.id];if(!e||l.editing.editCell)return;const i=e.getCell(o.dataField),d=i.value;if(t.cells){l.beginUpdate();for(let e=0;e<t.cells.length;e++){const n=t.cells[e],o=l.rowById[n.id];if(o){const e=o.getCell(n.dataField);e.value=null}}l.endUpdate(!1),l._recycle()}"Backspace"===n&&(l._beginEdit(e,o.dataField),i.canNotify=!1,i.value=d,i.canNotify=!0);break}default:{if(l.editing.enabled&&!l.editing.editCell&&!e.ctrlKey&&!e.altKey){const e=l.rowById[o.id];if(!e)return;if(0<=["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(n))return;l._beginEdit(e,o.dataField),setTimeout(function(){l.editing.editCell&&l.editing.editCell.editor.instance.setValue(n)},50)}break}case"Home":{const e=l.firstRow();if(!e)return;d(e.id,o.dataField);break}case"End":{const e=l.lastRow();if(!e)return;d(e.id,o.dataField);break}case"PageUp":{const e=l._recyclingRows,n=l.rowById[o.id],t=e.indexOf(n);for(let a=t;0<=a;a--){const t=e[a];if(n.top-t.top>=l.$.scrollView.offsetHeight)return void d(t.id,o.dataField)}d(l.firstRow().id,o.dataField);break}case"PageDown":{const e=l._recyclingRows,n=l.rowById[o.id],t=e.indexOf(n);for(let a=t;a<e.length;a++){const t=e[a];if(t.top-n.top>=l.$.scrollView.offsetHeight)return void d(t.id,o.dataField)}d(l.lastRow().id,o.dataField);break}case"ArrowDown":case"Enter":{let t=e.ctrlKey?l.lastRow():l.nextRow(o.id);if(l.editing.addNewRow.autoCreate&&"Enter"===n&&o.id===l.lastRow().id&&(l.addUnboundRow(1),t=l.lastRow()),!t)return;d(t.id,o.dataField);break}case"ArrowUp":{const n=e.ctrlKey?l.firstRow():l.prevRow(o.id);if(!n)return;d(n.id,o.dataField);break}case"ArrowRight":{const n=l.rowById[o.id];if(!1===n.leaf)if(!n.expanded)return void n.expand();else{const e=l.nextRow(o.id);if(e)return void d(e.id,o.dataField)}const t=e.ctrlKey?l.lastColumn():l.nextColumn(o.dataField);if(!t)return;d(o.id,t.dataField);break}case"ArrowLeft":{const n=l.rowById[o.id];if(!1===n.leaf)return void(n.expanded?n.collapse():n.parent&&d(n.parent.id,o.dataField));if(!0===n.leaf&&n.parent)return void d(n.parent.id,o.dataField);const t=e.ctrlKey?l.firstColumn():l.prevColumn(o.dataField);if(!t)return;d(o.id,t.dataField);break}}0>["Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(n)||(e.stopPropagation(),e.preventDefault())}}}_keyUpHandler(){const e=this;!e._focused}firstRow(){const e=this,l=e._recyclingRows;if(l&&0<l.length){if(!l[0].autoGenerated)return l[0];for(let e=0;e<l.length;e++)if(!l[e].autoGenerated)return l[e]}return null}lastRow(){const e=this,l=e._recyclingRows;if(l&&0<l.length){const e=l[l.length-1];if(!e.autoGenerated)return e;for(let e=l.length-1;0<=e;e--)if(!l[e].autoGenerated)return l[e]}return null}nextRow(e){const l=this,n=l._recyclingRows,t=l.rowById[e],o=n.indexOf(t);return 0<=o&&n[o+1]&&!n[o+1].autoGenerated?n[o+1]:null}prevRow(e){const l=this,n=l._recyclingRows,t=l.rowById[e],o=n.indexOf(t);return 0<=o&&n[o-1]&&!n[o-1].autoGenerated?n[o-1]:null}firstColumn(){const e=this,l=e.columns;return l&&0<l.length?l[0]:null}lastColumn(){const e=this,l=e.columns;return l&&0<l.length?l[l.length-1]:null}nextColumn(e){const l=this,n=l.columns,t=l.columnByDataField[e],o=n.indexOf(t);return n[o+1]?n[o+1]:null}prevColumn(e){const l=this,n=l.columns,t=l.columnByDataField[e],o=n.indexOf(t);return n[o-1]?n[o-1]:null}ensureVisible(e,l){const n=this,t=n._scrollView.vScrollBar,o=n._scrollView.hScrollBar,i=n.rowById[e],d=n.columnByDataField[l];(function(e){if(e){const l=e.visibleIndex;-1===l||(e.top+e.height+o.offsetHeight+n.__frozenNearHeight>=n._scrollView.scrollTop+n.$.scrollView.offsetHeight-n.__frozenFarHeight&&(n._scrollView.scrollTop=e.top+e.height),e.top<=n._scrollView.scrollTop&&(n._scrollView.scrollTop=e.top),0===l?n._scrollView.scrollTop=0:l===n.dataSource.length-1&&(n._scrollView.scrollTop=n._scrollView.scrollHeight))}})(i);(function(e){if(l){const l=e.visibleIndex;-1===l||(e.left+e.computedWidth+t.offsetWidth>=n._scrollView.scrollLeft+n._clientSize.width&&(n._scrollView.scrollLeft+=e.computedWidth),e.left<=n._scrollView.scrollLeft&&(n._scrollView.scrollLeft=e.left),0===l?n._scrollView.scrollLeft=0:l===n.columns.length-1&&(n._scrollView.scrollLeft=n._scrollView.scrollWidth))}})(d)}clearSelection(){const e=this;e._clearSelection(!0)}});