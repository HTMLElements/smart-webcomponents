
/* Smart HTML Elements v7.4.0 (2020-Apr) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function l(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=e,l.c=t,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=57)}({57:function(e,t){Smart.Utilities.Assign("Grid.Select",class{_refreshSelection(){const e=this;if(e.selection.enabled){e._selectionColumn.refresh()}e._refreshCellSelectionRect()}_toggleColumnSelection(e){const t=this;if(!t.selection.enabled||"none"===t.selection.checkBoxes.selectAllMode)return void(t._inputOverlay&&t._inputOverlay.parentNode&&t._inputOverlay.parentNode.removeChild(t._inputOverlay));let l=e.element.getAttribute("selected");l="indeterminate"===l||""!==l;let n=t._recyclingRows;t._selectionColumn._selecting=!0,t.beginUpdate();for(let e=0;e<n.length;e++){n[e].selected=l}if(t._selectionColumn._selecting=!1,t.endUpdate(!1),t._recycle(!1),t.selection.enabled&&t.selection.checkBoxes.enabled&&"none"!==t.selection.checkBoxes.selectAllMode){const l=e.element,n=l.querySelector(".smart-input");t._inputOverlay?t._inputOverlay.parentNode!==t.$.columnHeader&&(t._inputOverlay.parentNode&&t._inputOverlay.parentNode.removeChild(t._inputOverlay),t._inputOverlay=document.createElement("div"),t.$.columnHeader.appendChild(t._inputOverlay)):(t._inputOverlay=document.createElement("div"),t.$.columnHeader.appendChild(t._inputOverlay)),t._inputOverlay.column=e,t._inputOverlay.onpointerdown=function(){t._inputOverlay||(t._inputOverlay.onpointerdown=null);const e=t._inputOverlay.column;t._inputOverlay.classList.remove("smart-animate"),t._selectionColumn._selecting=!0,t.beginUpdate();let l=e.element.hasAttribute("selected"),n=t._recyclingRows;for(let e=0;e<n.length;e++){n[e].selected=!l}t._selectionColumn._selecting=!1;const o=t._inputOverlay;return t.endUpdate(!1),t._recycle(),t.$.columnHeader.appendChild(o),t._inputOverlay=o,t._inputOverlay.classList.add("smart-animate"),!1},t._inputOverlay.classList.add("smart-input-overlay"),t._inputOverlay.classList.add("smart-input-overlay-column"),t.appearance.allowCheckBoxesSelectionAnimation&&t._inputOverlay.classList.add("smart-animate"),t._inputOverlay.style.top=(l.offsetHeight-n.offsetHeight)/4+1+"px";const o=t._selectionColumn.element.parentElement.offsetLeft+t._selectionColumn.element.offsetLeft;t.rightToLeft?t._inputOverlay.style.right=o+"px":t._inputOverlay.style.left=o+"px",t._inputOverlay.style.height=l.offsetWidth+"px",t._inputOverlay.style.width=l.offsetWidth+"px",t._inputOverlay.onmousedown=null,t._inputOverlay.classList.add("smart-input-overlay-on"),t._selectionColumn.refresh()}}_refreshCheckBoxColumnSelection(){const e=this;if(e.selection.enabled&&e.selection.checkBoxes.enabled){const t=e._selectionColumn.element;"none"===e.selection.checkBoxes.selectAllMode?(t.removeAttribute("checkbox"),t.label.classList.remove("smart-input")):(t.setAttribute("checkbox",""),t.label.classList.add("smart-input")),e._selectionColumn.refresh()}}_handleExtendedRowSelection(e,t){const l=this;if(!e)return;let n=l._recyclingRows;if(l.paging.enabled&&"page"===l.selection.selectAllMode&&(n=n.slice(l.paging.pageIndex*l.paging.pageSize,(l.paging.pageIndex+1)*l.paging.pageSize)),t&&!t.ctrlKey&&(l._selection.rows=[]),t&&!t.shiftKey&&(l._rangeSelectionStartRow=e,l._rangeSelectionEndRow=e),t&&t.shiftKey){l._rangeSelectionEndRow=e;const t=n.indexOf(l._rangeSelectionStartRow),o=n.indexOf(l._rangeSelectionEndRow),i=Math.min(t,o),a=Math.max(t,o);if(-1===t||-1===o)return;for(let e=i;e<=a;e++){const t=n[e];t.allowSelect&&t.setProperty("selected",!0)}}else e.allowSelect&&(t&&t.ctrlKey?null===e.selected?e.setProperty("selected",!0):e.setProperty("selected",!e.selected):e.setProperty("selected",!0))}_setSelection(e,t,l){const n=this;if(!n.selection.enabled)return;if(n._lastColumnSelectionRange=null,n._lastRowSelectionRange=null,n.closeMenu(),null===e&&null===t)return void n.clearSelection();const o=function(){if(l&&!l.ctrlKey&&!l.shiftKey||"one"===n.selection.mode){if("many"!==n.selection.mode){for(let e in n._selection.rows){const t=n.rowById[e];t.canNotify=!1,t.selected=!1,t.canNotify=!0}n._selection.rows=[],n._selection.columns=[],n._selection.cells=[]}n._selection.focusedCell=null}if(n._selection.selectionRect){const e=n._selection.selectionRect;e.parentNode.removeChild(e);const t={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(t.down="touchstart",t.move="touchmove",t.up="touchend"),document.removeEventListener(t.move,e.onMove),document.removeEventListener(t.up,e.onUp),document.removeEventListener(t.down,e.onDown),n._selection.selectionRect=null}};n.beginUpdate();const i=n.columnByDataField[t];if(n.selection.allowCellSelection&&null!=e&&i&&!i.autoGenerated){const i=n.rowById[e];let a=i.getCell(t);const c=n._getParentCell(i,t);c&&(a=c.row.getCell(c.column.dataField)),o(),l&&!l.ctrlKey&&(n._selection.rows=[],n._selection.columns=[],"many"!==n.selection.mode&&(n._selection.cells=[])),"extended"===n.selection.mode?l&&l.ctrlKey?a.selected=!a.selected:a.selected=!0:"one"===n.selection.mode?a.selected=!0:a.selected=!a.selected,(l&&!l.shiftKey||!n._selection.focusedCell)&&(n._selection.focusedCell=a),l&&(l.shiftKey||n._selection.focusedCell===a)&&"extended"===n.selection.mode&&(c?n._renderCellSelectionRect(a.row,a.column,c.endRow,c.endColumn):n._renderCellSelectionRect(a.row,a.column,a.row,a.column))}else n.selection.allowRowHeaderSelection&&null!=e&&void 0===n.columnByDataField[t]||n.selection.checkBoxes.enabled&&null!=e&&"_checkBoxColumn"===t&&void 0===n.columnByDataField[t]?(o(),n._selectRow(e,l)):null==e||void 0!==t&&void 0===n.columnByDataField[t]||!n.selection.allowRowSelection?n.selection.allowColumnHeaderSelection&&i&&(o(),n._selectColumn(t,l)):(o(),n._selectRow(e,l));n.endUpdate(!1),n._recycle(),null==e||i||n._renderInputOverlay(e,l),n.__selectionStarted=new Date}_renderCellSelectionRect(e,t,l,n){const o=this;let i=o._recyclingRows;const a=i.indexOf(e),c=i.indexOf(l);if(a>=0&&c>=0){if(!o._selection.selectionRect){const e=function(e){const t=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div");return n.classList.add("smart-selection-overlay"),n.appendChild(l),l.appendChild(t),t.classList.add("smart-selection-overlay-content"),l.classList.add("smart-selection-overlay-border-content"),o.selection.allowCellDragSelectionHandle&&e&&l.classList.add("handle"),o.$.scrollView.appendChild(n),n},t=o._selection.selectionRect=e(!0);if(o.selection.allowCellDragSelectionHandle){let e=null,l=null,n=null;t.onMove=function(t){const a=o._selection.selectionRect;let c=t.clientX,r=t.clientY;t.touches&&(c=t.touches[0].clientX,r=t.touches[0].clientY);const s=function(e){const t=(o.enableShadowDOM?o.shadowRoot:o.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let l=null;for(let e=0;e<t.length;e++){const n=t[e];if(n.getAttribute("data-field")){l=n.getAttribute("data-field");break}}let n=null;for(let e=0;e<t.length;e++){const l=t[e];if(l.getAttribute("data-id")){n=l.row;break}}return{column:o.columnByDataField[l],row:n}};if(a.capturedDrag){let e=s({clientX:c,clientY:r}),l=s({clientX:c,clientY:r+a.top}).row,n=s({clientX:c+a.left,clientY:r}).column;l||(l=i[i.length-1]),n||(n=e.column),l&&n&&e.row&&e.column&&(a.row=e.row,a.column=e.column,a.endDragRow=a.endRow=l,a.endDragColumn=a.endColumn=n,o._dragSelectionStartDataField=a.column.dataField,o._dragSelectionStartRow=a.row,o._selection.focusedCell=a.row.getCell(a.column.dataField)),o._resizeSelectionRect(),t.preventDefault()}else if(a.captured)if(o._dragSelectionStartDataField=o._selection.focusedCell.column.dataField,o._dragSelectionStartRow=o._selection.focusedCell.row,null===l&&null===n&&(Math.abs(c-e.left)>=30?l=!0:Math.abs(r-e.top)>=30&&(n=!0)),a.lastPoint&&Math.abs(a.lastPoint.top-r)>=40?(l=null,n=!0):a.lastPoint&&Math.abs(a.lastPoint.left-c)>=40&&(n=null,l=!0),l){const t=a.endDragColumn.dataField,l=s({clientX:c,clientY:e.top-5});l.row&&l.column&&(a.endDragRow=a.endRow,a.endDragColumn=l.column,a.endDragColumn.dataField!==t&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}else if(n){const t=a.endDragRow,l=s({clientX:e.left-5,clientY:r});l.row&&l.column&&(a.endDragRow=l.row,a.endDragColumn=a.endColumn,a.endDragRow.id&&a.endDragRow.id!==t.id&&(a.lastPoint={left:c,top:r}),o._resizeSelectionRect())}a.captured&&o.selection.allowDragSelectionAutoScroll&&(o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.selection.isDragging=!0,o._autoScrollSelectionDragInterval=setInterval((function(){const e=o.$.scrollView.getBoundingClientRect();c<=e.left+20?(o.scrollLeft-=15,o._resizeSelectionRect()):c>=e.left+e.width-20&&(o.scrollLeft+=15,o._resizeSelectionRect()),r<=e.top+20?(o.scrollTop-=15,o._resizeSelectionRect()):r>=e.top+e.height-20&&(o.scrollTop+=15,o._resizeSelectionRect())}),5))},t.onUp=function(){if(!t.captured)return;o._autoScrollSelectionDragInterval&&clearInterval(o._autoScrollSelectionDragInterval),o.editing.editCell||o.editing.editRow||o.focus(),t.capturedDrag=!1,t.captured=!1,l=null,n=null,e=null,t.lastPoint=null;const i=t.cellValues;t.minRow&&t.maxRow&&t.maxRow&&t.maxColumn&&(o._selectCellsRange(t.minRow,t.maxRow,t.minColumn.dataField,t.maxColumn.dataField),t.row=t.minRow,t.column=t.minColumn,t.endColumn=t.maxColumn,t.endRow=t.maxRow,t.cellValues=i,o._resizeSelectionRect(),o.selection.allowCellDragSelectionAutoFill&&o._pasteSelectedCells({row:t.row,endRow:t.endDragRow,column:t.column,endColumn:t.endColumn},i)),t.endDragColumn=null,t.endDragRow=null,t.minColumn=null,t.minRow=null,t.maxColumn=null,t.maxRow=null},t.onDown=function(l){if(t.captured&&!e){let t=l.clientX,n=l.clientY;l.touches&&(t=l.touches[0].clientX,n=l.touches[0].clientY),e={left:t,top:n}}};const a={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(a.down="touchstart",a.move="touchmove",a.up="touchend"),t["on"+a.down]=function(e){const l=t.getBoundingClientRect();let n=e.clientX,i=e.clientY;e.touches&&(n=e.touches[0].clientX,i=e.touches[0].clientY),n>=l.right-5&&i>=l.bottom-5?(t.captured=!0,t.endDragRow=t.endRow,t.endDragColumn=t.endColumn):o.selection.allowCellDragDropSelectionHandle&&i>=l.bottom-5?(t.captured=!0,t.capturedDrag=!0,t.endDragRow=t.endRow,t.endDragColumn=t.endColumn,t.left=t.endColumn.left-t.column.left,t.top=t.endRow.top-t.row.top):t.captured||o._rowDownHandler(e)},document.addEventListener(a.move,t.onMove,{passive:!1}),document.addEventListener(a.up,t.onUp,{passive:!1}),document.addEventListener(a.down,t.onDown,{passive:!1})}}const e=o._selection.selectionRect;e.row=o._selection.focusedCell.row,e.column=o._selection.focusedCell.column,e.endRow=l,e.endDragRow=l,e.endColumn=n,e.endDragColumn=n,o._refreshCellSelectionRect()}}_resizeSelectionRect(){const e=this,t=e._selection.selectionRect;if(!t)return;let l=e._recyclingRows,n=t.row,o=t.endDragRow,i=t.column,a=t.endDragColumn;const c=l.indexOf(n),r=l.indexOf(o),s=l.indexOf(t.endRow),d=e.columns.indexOf(i),u=e.columns.indexOf(a),f=e.columns.indexOf(t.endColumn),m=Math.min(s,Math.min(c,r)),g=Math.max(s,Math.max(c,r)),_=Math.min(f,Math.min(d,u)),h=Math.max(f,Math.max(d,u));s<=Math.min(c,r)?t.minRow=t.endRow:t.minRow=c<=r?n:o,s>=Math.max(c,r)?t.maxRow=t.endRow:t.maxRow=c>=r?n:o,f<=Math.min(d,u)?t.minColumn=t.endColumn:t.minColumn=d<=u?i:a,f>=Math.max(d,u)?t.maxColumn=t.endColumn:t.maxColumn=d>=u?i:a;let p=0,w=0,S=0,y=0;for(let t=m;t<=g;t++){const n=l[t];t===m&&(p=n.top),t===g&&(w=n.top+n.height-p);for(let t=_;t<=h;t++){const l=e.columns[t].dataField,o=n.getCell(l);t===_&&(S=o.column.left),t===h&&(y=o.column.left+o.column.computedWidth-S)}}t.style.top=p-e.scrollTop-1+"px",e.rightToLeft?t.style.right=S-e.scrollLeft+"px":t.style.left=S-e.scrollLeft+"px",t.style.height=w+1+"px",t.style.width=y+1+"px"}_getPatternValue(e,t,l){let n=[],o=0,i=[],a=[],c=[],r=[];const s={names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},d={names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},u=function(e){if(void 0===e)return;if(e.toString().indexOf("GMT+")>=0||e.toString().indexOf("GMT-")>=0)return;if(isNaN(parseFloat(e))){if(s.names.indexOf(e)>=0)return r=s.names,s.names.indexOf(e);if(s.namesAbbr.indexOf(e)>=0)return r=s.namesAbbr,s.namesAbbr.indexOf(e);if(s.namesShort.indexOf(e)>=0)return r=s.namesShort,s.namesShort.indexOf(e);if(d.names.indexOf(e)>=0)return r=d.names,d.names.indexOf(e);if(d.namesAbbr.indexOf(e)>=0)return r=d.namesAbbr,d.namesAbbr.indexOf(e);if(void 0!==e){if(null===e&&(e=""),/\d+/.test(e.toString())){c.push(e.toString().replace(/[0-9]/,"#")),c[c.length-1]=c[c.length-1].replace(/[0-9]/g,"");const t=parseFloat(e.toString().replace(/\D/g,""));return isNaN(t)?0:t}}return}return/[A-Za-z]/.test(e.toString())?void 0:parseFloat(e)};let f=0;for(let e in l){let t=l[e];n[o]=[],f=0;for(let e in t){let l=u(t[e]);void 0!==l&&(n[o].push(l),f++)}if(0===n[o].length)continue;let a=n[o][0],s=0;for(let e=0;e<n[o].length;e++){let t=u(n[o][e-1]),l=u(n[o][e]);0===e&&(t=l),a+=l,s+=l-t}a/=n[o].length,a-=n[o][0],a+=n[o][n[o].length-1],0!==s&&(s/=n[o].length-1),(r.length>0||c.length>0)&&(s=1,a=n[o][0]),n[o].length<=2&&(a=n[o][n[o].length-1]+s),i.push({step:s,stepStart:a}),o++}for(let e=0;e<f;e++){let t=n[0][e],l=0;for(let o=1;o<n.length;o++){const i=u(n[o-1][e]),a=u(n[o][e]);t+=a,l+=a-i}t/=n.length,t-=n[0][e],t+=n[n.length-1][e],0!==l&&(l/=n.length-1),(r.length>0||c.length>0)&&(l=1,t=n[0][e]),n.length<=2&&(t=n[n.length-1][e]+l),a.push({step:l,stepStart:t})}if(!n[e]){let l=n.length;for(let o=l;o<=e;o++){n[o]=[];for(let e=0;e<=t;e++)a[e]||(a[e]=a[e-1]),a[e]&&(o===l?n[o][e]=a[e].stepStart:(n[o][e]=n[o-1][e]+a[e].step,r.length>1&&n[o][e]>=r.length&&(n[o][e]=0)))}return r.length>0?r[n[e][t]]:c.length>0?c[e%c.length].replace("#",n[e][t]):n[e][t]}if(!n[e][t]){let l=f;for(let o=l;o<=t;o++)i[e]&&(o===l?n[e].push(i[e].stepStart):(n[e][o]=n[e][o-1]+i[e].step,r.length>1&&n[e][o]>=r.length&&(n[e][o]=0)));return r.length>0?r[n[e][t]]:c.length>0?c[e%c.length].replace("#",n[e][t]):n[e][t]}return n[e]&&n[e][t]?c.length>0?c[e%c.length].replace("#",n[e][t]):n[e][t]:0}_pasteDataType(e){const t=this.dataSource&&"number"==typeof this.dataSource.dataSource,l=e.cell,n=e.value;let o=l.column.dataType;return o&&!t||(o=isNaN(parseFloat(n))?"string":n instanceof Date?"date":"true"===n||"false"===n?"boolean":"number"),o}_pasteModeCopy(e){const t=this,l=t.dataSource&&"number"==typeof t.dataSource.dataSource,n=t._pasteDataType(e),o=e.cell,i=e.value,a=e.dataField;if("string"===n)o.value=i;else if("bool"===n||"boolean"===n)1!==i&&"1"!==i&&!0!==i&&"true"!==i&&"TRUE"!==i&&"True"!==i||(o.value=!0);else if("date"===n||"time"===n||"dateTime"===n){const e=t.columnByDataField[a];l?o.value=i:e&&e.dataType!==n?o.value=null:o.value=i}else if("number"===n||"float"===n||"int"===n){const e=t.columnByDataField[a];l?o.value=i:e&&e.dataType!==n?o.value=null:o.value=null!==i?"int"===n||"integer"===n?parseInt(i):parseFloat(i):null}}_pasteModeFill(e){const t=this,l=t.dataSource&&"number"==typeof t.dataSource.dataSource,n=t._pasteDataType(e),o=e.cell,i=e.selectedValues,a=e.minRowIndex,c=e.minColumnIndex,r=e.currentRowIndex,s=e.currentColumnIndex,d=e.dataField;let u=e.value;if("string"===n){/\d+/.test(u.toString())?(u=t._getPatternValue(r-a,s-c,i),void 0===u&&i[r-a]&&i[r-a][s-c]&&(u=i[r-a][s-c])):(u=t._getPatternValue(r-a,s-c,i),u=void 0===u&&i[r-a]?i[r-a][s-c]:e.value),void 0!==u&&(o.value=u)}else if("bool"===n||"boolean"===n)1!==u&&"1"!==u&&!0!==u&&"true"!==u&&"TRUE"!==u&&"True"!==u||(o.value=!0);else if("date"===n||"time"===n||"dateTime"===n){const e=t.columnByDataField[d];l?o.value=u:e&&e.dataType!==n&&(o.value=null),i[r-a]&&(u=i[r-a][s-c],void 0!==u&&(o.value=u))}else if("number"===n||"float"===n||"int"===n){u=t._getPatternValue(r-a,s-c,i);const e=t.columnByDataField[d];l?o.value=u:e&&e.dataType!==n?o.value=null:o.value=null!==u?"int"===n||"integer"===n?parseInt(u):parseFloat(u):null}}_pasteSelectedCells(e,t){const l=this;l.beginUpdate();let n=l._recyclingRows,o=e.row,i=e.endRow,a=e.column,c=e.endColumn;const r=n.indexOf(o),s=n.indexOf(i),d=n.indexOf(e.endRow),u=l.columns.indexOf(a),f=l.columns.indexOf(c),m=l.columns.indexOf(e.endColumn),g=Math.min(d,Math.min(r,s)),_=Math.max(d,Math.max(r,s)),h=Math.min(m,Math.min(u,f)),p=Math.max(m,Math.max(u,f));let w=0,S=0,y=0,R=0;for(let e in t)0===w&&(S+=Object.keys(t[e]).length),w++;for(let e=g;e<=_;e++){const o=n[e];y=0;for(let n=h;n<=p;n++){const i=l.columns[n].dataField,a=o.getCell(i);let c=0;for(let r in t){if(c===R){let c=0,s=t[r];for(let d in s){if(y===c){let c=s[d],u=!0;if(t[o.id]&&t[o.id][i]&&(u=!1),u&&"none"!==l.clipboard.autoFillMode){const o={value:c,oldValue:a.value,dataField:d,id:r};l.clipboard.onPasteValue?(l.clipboard.onPasteValue(o),a.value=o.value):(o.cell=a,o.selectedValues=t,o.minRowIndex=g,o.maxRowIndex=_,o.minColumnIndex=h,o.maxColumnIndex=p,o.currentColumnIndex=n,o.currentRowIndex=e,"copy"===l.clipboard.autoFillMode?l._pasteModeCopy(o):"fillSeries"===l.clipboard.autoFillMode&&l._pasteModeFill(o))}}c++}}c++}y++,y>=S&&(y=0)}R++,R>=w&&(R=0)}l.endUpdate(!1),l._recycle(!1)}_refreshCellSelectionRect(){const e=this,t=e._selection.selectionRect;if(!t||t&&t.captured)return;let l=e._recyclingRows,n=t.row,o=t.endRow,i=t.column,a=t.endColumn;const c=l.indexOf(n),r=l.indexOf(o),s=e.columns.indexOf(i),d=e.columns.indexOf(a);let u=Math.min(c,r),f=Math.max(c,r),m=Math.min(s,d),g=Math.max(s,d);m=Math.max(0,m),u=Math.max(0,u);const _=function(t){const n=l.indexOf(t.row),o=l.indexOf(t.endRow),i=e.columns.indexOf(t.column),a=e.columns.indexOf(t.endColumn);u=Math.min(u,n),u=Math.min(u,o),u=Math.max(0,u),f=Math.max(f,n),f=Math.max(f,o),m=Math.min(m,i),m=Math.min(m,a),m=Math.max(0,m),g=Math.max(g,i),g=Math.max(g,a)},h=e._getParentCell(n,i.dataField),p=e._getParentCell(n,a.dataField),w=e._getParentCell(o,a.dataField),S=e._getParentCell(o,i.dataField);h&&_(h),p&&_(p),w&&_(w),S&&_(S);let y=0,R=0,v=0,C=0;t.cellValues=[];for(let n=u;n<=f;n++){const o=l[n];if(n===u&&(y=o.top,!0!==o.freeze&&"near"!==o.freeze&&(y+=e.__frozenNearHeight),"far"===o.freeze&&(y=o.top+e.__scrollHeight+e.scrollTop-e._scrollView.hScrollBar.offsetHeight)),n===f){let t=o.top;"far"===o.freeze&&(t=o.top+e.__scrollHeight+e.scrollTop-e._scrollView.hScrollBar.offsetHeight),R=t+o.height-y,!0!==o.freeze&&"near"!==o.freeze&&(R+=e.__frozenNearHeight)}t.cellValues[o.id]=[];for(let l=m;l<=g;l++){const n=e.columns[l].dataField,i=o.getCell(n);if(t.cellValues[o.id][n]=i.value,l===m&&(v=i.column.left,i.column.freeze&&"far"===i.column.freeze&&(v=e.__clientSize.width-e.__frozenFarWidth+v+e.scrollLeft-e._scrollView.vScrollBar.offsetWidth)),l===g){let t=i.column.left;i.column.freeze&&"far"===i.column.freeze&&(t=e.__clientSize.width-e.__frozenFarWidth+t+e.scrollLeft-e._scrollView.vScrollBar.offsetWidth),C=t+i.column.computedWidth-v}i.selected=!0}}t.style.top=y-e.scrollTop-1+"px",e.rightToLeft?t.style.right=v-e.scrollLeft+"px":t.style.left=v-e.scrollLeft+"px",t.style.height=R+1+"px",t.style.width=C+1+"px"}_renderInputOverlay(e,t,l){const n=this,o=n.rowById[e];if(o&&o.allowSelect&&!o.label&&t&&n.selection.checkBoxes.enabled){n._inputOverlay&&n._inputOverlay.classList.contains("smart-input-overlay-column")&&(n._inputOverlay.parentNode&&n._inputOverlay.parentNode.removeChild(n._inputOverlay),n._inputOverlay=null),n._inputOverlay||(n._inputOverlay=document.createElement("div"),n.$.scrollView.appendChild(n._inputOverlay),n._inputOverlay.classList.add("smart-input-overlay"));let e=o.freeze?o.top:n.__frozenNearHeight+o.top;const i=Math.round((o.cellHeight-n._selectionColumn.computedWidth)/2),a=n._selectionColumn.element.parentElement.offsetLeft+n._selectionColumn.element.offsetLeft;n._inputOverlay.style.left=a+"px",n._inputOverlay.style.height=n._selectionColumn.computedWidth+"px",n._inputOverlay.style.width=n._selectionColumn.computedWidth+"px",n._inputOverlay.style.top=e+i-n.scrollTop+"px",n._inputOverlay.row=o,n._inputOverlay.onpointerdown=function(){n._inputOverlay||(n._inputOverlay.onpointerdown=null);const e=n._inputOverlay.row;n.beginUpdate(),e.selected=!e.selected,n.endUpdate(!1),n._recycle(),n._renderInputOverlay(e.id,t,!0)},n.appearance.allowCheckBoxesSelectionAnimation&&void 0===l&&n._inputOverlay.classList.add("smart-animate"),requestAnimationFrame(()=>{n._inputOverlay&&n._inputOverlay.classList.add("smart-input-overlay-on")})}}_selectRow(e,t){const l=this,n=l.rowById[e];n&&l.selection.enabled&&(n.header&&"row-resize"===n.header.style.cursor||(t&&(t.shiftKey&&l._selection.focusedCell||(l._selection.focusedCell=n.getCell(l.columns[0].dataField))),l._lastRowsSelectionRange=null,"extended"===l.selection.mode?l._handleExtendedRowSelection(n,t):"one"===l.selection.mode?n.selected=!0:n.selected=!n.selected))}_getParentCell(e,t){const l=this;let n=l._recyclingRows;for(let o=0;o<l._cellsMerge.length;o++){const i=l._cellsMerge[o];let a=[],c=[];if(a.push(i.row),i.rowSpan>1){const e=n.indexOf(i.row);if(e>=0)for(let t=e;t<e+i.rowSpan;t++)n[t]&&-1===a.indexOf(n[t])&&a.push(n[t])}if(c.push(i.column.dataField),i.colSpan>1){const e=l.columns.indexOf(l.columnByDataField[i.column.dataField]);for(let t=e;t<e+i.colSpan;t++)l.columns[t]&&-1===c.indexOf(l.columns[t].dataField)&&c.push(l.columns[t].dataField)}if(a.indexOf(e)>=0&&c.indexOf(t)>=0)return{row:i.row,column:i.column,endRow:a[a.length-1],endColumn:l.columnByDataField[c[c.length-1]]}}return null}_selectCellsRange(e,t,l,n){const o=this,i=o._selection.selectionRect;if(o._lastRowsSelectionRange&&o._lastRowsSelectionRange.id===e.id&&o._lastRowsSelectionRange.endId===t.id&&o._lastColumnSelectionRange&&o._lastColumnSelectionRange.dataField===l&&o._lastColumnSelectionRange.endDataField===n)return;o.beginUpdate(),o._clearSelection(),o._lastRowsSelectionRange={id:e.id,endId:t.id},o._lastColumnSelectionRange={dataField:l,endDataField:n},(!i||i&&!i.captured)&&o._selection.focusedCell&&o._renderCellSelectionRect(o._selection.focusedCell.row,o._selection.focusedCell.column,o.rowById[o._lastRowsSelectionRange.endId],o.columnByDataField[o._lastColumnSelectionRange.endDataField]);let a=o._recyclingRows,c=-1,r=o.columns.length,s=a.indexOf(e),d=a.indexOf(t);for(let e=0;e<o.columns.length;e++){const t=o.columns[e];t.allowSelect&&(t.dataField===l&&(c=e),t.dataField===n&&(r=e))}let u=Math.min(s,d),f=Math.max(s,d),m=Math.min(c,r),g=Math.max(c,r);const _=function(e){const t=a.indexOf(e.row),l=a.indexOf(e.endRow),n=o.columns.indexOf(e.column),i=o.columns.indexOf(e.endColumn);u=Math.min(u,t),u=Math.min(u,l),f=Math.max(f,t),f=Math.max(f,l),m=Math.min(m,n),m=Math.min(m,i),g=Math.max(g,n),g=Math.max(g,i)},h=o._getParentCell(e,l),p=o._getParentCell(t,n);if(h&&_(h),p&&_(p),f<0||u<0)return o.endUpdate(!1),void o._recycle();for(let e=u;e<=f;e++){const t=a[e];if(t.allowSelect)for(let e=0;e<o.columns.length;e++){const l=o.columns[e];if(l.allowSelect&&(e>=m&&e<=g)){t.getCell(l.dataField).selected=!0}}}o.endUpdate(!1),o._recycle()}_selectRowsRange(e,t){const l=this;if(l._lastRowsSelectionRange&&l._lastRowsSelectionRange.id===e.id&&l._lastRowsSelectionRange.endId===t.id)return;l.beginUpdate(),l._clearSelection(),l._lastRowsSelectionRange={id:e.id,endId:t.id};let n=l._recyclingRows;const o=n.indexOf(e),i=n.indexOf(t),a=Math.min(o,i),c=Math.max(o,i);if(c<0)return l.endUpdate(!1),void l._recycle();for(let e=a;e<=c;e++){const t=n[e];t&&(t.allowSelect&&(t.selected=!0))}l.endUpdate(!1),l._recycle()}_selectColumnsRange(e,t){const l=this;if(l._lastColumnSelectionRange&&l._lastColumnSelectionRange.dataField===e&&l._lastColumnSelectionRange.endDataField===t)return;l.beginUpdate(),l._clearSelection(),l._lastColumnSelectionRange={dataField:e,endDataField:t};let n=-1,o=l.columns.length;for(let i=0;i<l.columns.length;i++){const a=l.columns[i];a.allowSelect&&(a.dataField===e&&(n=i),a.dataField===t&&(o=i))}const i=Math.min(n,o),a=Math.max(n,o);for(let e=0;e<l.columns.length;e++){const t=l.columns[e];t.allowSelect&&(e>=i&&e<=a&&(t.selected=!0))}l.endUpdate(!1),l._recycle()}_selectColumn(e,t){const l=this,n=l.columnByDataField[e];if(n&&l.selection.enabled&&n.allowSelect&&l.selection.allowColumnHeaderSelection&&(!n||"col-resize"!==n.element.style.cursor)&&t)if("extended"===l.selection.mode){if(t.ctrlKey||t.shiftKey||(l._rangeSelectionStartColumn=n,l._rangeSelectionEndColumn=n),n.selected=!0,t&&t.shiftKey){l._rangeSelectionStartColumn||(l._rangeSelectionStartColumn=n),l._rangeSelectionEndColumn=n,l._selection.columns=[];const e=l.columns.indexOf(l._rangeSelectionStartColumn),t=l.columns.indexOf(l._rangeSelectionEndColumn),o=Math.min(e,t),i=Math.max(e,t);for(let e=o;e<=i;e++){l.columns[e].selected=!0}}}else"one"===l.selection.mode||null===n.selected?n.selected=!0:n.selected=!n.selected}_getSelectedRows(e,t){const l=this,n=[];let o=l.rows;l.rows.canNotify=!1,e&&(o=l.getVisibleRows()),l.paging.enabled&&t&&(o=o.slice(l.paging.pageIndex*l.paging.pageSize,(l.paging.pageIndex+1)*l.paging.pageSize));for(let e=0;e<o.length;e++){const t=o[e];t.getProperty("selected")?n.push(t):(t.canNotify=!1,t.selected=!1,t.canNotify=!0)}return l.rows.canNotify=!0,n}_dragSelectionEnd(e){const t=this;t._dragSelectionStartDataField=null,t._dragSelectionStartRow=null,t.__selectionStarted&&(t.$.fireEvent("change",{started:!1,finished:!0,originalEvent:e}),delete t.__selectionStarted,delete t.__selectionStartedFired),t.selection.allowDragSelection&&t.selection.isDragging&&(t.selection.isDragging=!1,t._autoScrollSelectionDragInterval&&(clearInterval(t._autoScrollSelectionDragInterval),t.editing.isEditing||t._recycle()))}_dragSelection(e){const t=this;if("extended"!==t.selection.mode||!1===t.selection.allowDragSelection)return;if(!t._dragSelectionStartDataField&&!t._dragSelectionStartRow)return;const l=()=>{t.__selectionStarted&&!t.__selectionStartedFired&&(t.$.fireEvent("change",{started:!0,finished:!1,originalEvent:e}),t.__selectionStartedFired=!0),t.$.fireEvent("change",{started:!1,finished:!1,originalEvent:e})};if(!t.selection.allowCellSelection||!t._dragSelectionStartDataField||t._columnResizeLine||t._dragSelectionStartDataField.startsWith("_")||!t._dragSelectionStartRow||t._rowResizeLine){if(t._dragSelectionStartRow&&!t._rowResizeLine&&(t.selection.allowRowSelection&&!t._dragSelectionStartDataField.startsWith("_")||t.selection.allowRowHeaderSelection&&t._dragSelectionStartDataField.startsWith("_"))){const n=(t.enableShadowDOM?t.shadowRoot:t.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let o=null;for(let e=0;e<n.length;e++){const t=n[e];if(t.getAttribute("data-id")){o=t.row,!o&&t.cell&&(o=t.cell.row);break}}let i=!0;t._lastRowsSelectionRange&&t._lastRowsSelectionRange.id===t._dragSelectionStartRow.id&&o&&t._lastRowsSelectionRange.endId===o.id&&(i=!1),o&&t._selectRowsRange(t._dragSelectionStartRow,o),t._autoScrollSelectionDragInterval&&clearInterval(t._autoScrollSelectionDragInterval),t.selection.isDragging=!0,i&&l(),t._autoScrollSelectionDragInterval=setInterval((function(){const l=t.$.scrollView.getBoundingClientRect();e.clientY<=l.top+20?t.scrollTop-=15:e.clientY>=l.top+l.height-20&&(t.scrollTop+=15)}),5)}else if(t._dragSelectionStartDataField&&!t._columnResizeLine&&!t._dragSelectionStartDataField.startsWith("_")&&t.selection.allowColumnHeaderSelection){const n=(t.enableShadowDOM?t.shadowRoot:t.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let o=null;for(let e=0;e<n.length;e++){const t=n[e];if(t.getAttribute("data-field")){o=t.getAttribute("data-field");break}}o&&t._selectColumnsRange(t._dragSelectionStartDataField,o),t._autoScrollSelectionDragInterval&&clearInterval(t._autoScrollSelectionDragInterval);let i=!0;t._lastColumnSelectionRange&&t._lastColumnSelectionRange.dataField===t._dragSelectionStartDataField&&t._lastColumnSelectionRange.endDataField===o&&(i=!1),i&&l(),t.selection.isDragging=!0,t._autoScrollSelectionDragInterval=setInterval((function(){const l=t.$.scrollView.getBoundingClientRect();e.clientX<=l.left+20?t.scrollLeft-=15:e.clientX>=l.left+l.width-20&&(t.scrollLeft+=15)}),5)}}else{const n=(t.enableShadowDOM?t.shadowRoot:t.getRootNode()).elementsFromPoint(e.clientX,e.clientY);let o=null;for(let e=0;e<n.length;e++){const t=n[e];if(t.getAttribute("data-field")){o=t.getAttribute("data-field");break}}let i=null;for(let e=0;e<n.length;e++){const t=n[e];if(t.getAttribute("data-id")){i=t.row;break}}if(o&&i){if(i.id===t._dragSelectionStartRow.id&&t._dragSelectionStartDataField===o)return;let e=!0;t._lastRowsSelectionRange&&t._lastRowsSelectionRange.id===t._dragSelectionStartRow.id&&t._lastRowsSelectionRange.endId===i.id&&t._lastColumnSelectionRange&&t._lastColumnSelectionRange.dataField===t._dragSelectionStartDataField&&t._lastColumnSelectionRange.endDataField===o&&(e=!1),t._selectCellsRange(t._dragSelectionStartRow,i,t._dragSelectionStartDataField,o),e&&l()}t.selection.allowDragSelectionAutoScroll&&(t._autoScrollSelectionDragInterval&&clearInterval(t._autoScrollSelectionDragInterval),t.selection.isDragging=!0,t._autoScrollSelectionDragInterval=setInterval((function(){const l=t.$.scrollView.getBoundingClientRect();e.clientX<=l.left+20?t.scrollLeft-=15:e.clientX>=l.left+l.width-20&&(t.scrollLeft+=15),e.clientY<=l.top+20?t.scrollTop-=15:e.clientY>=l.top+l.height-20&&(t.scrollTop+=15)}),5))}}select(e,t){this._setSelection(e,t),this.$.fireEvent("change",{started:!1,finished:!0})}selectRange(e,t,l,n){const o=this;!function(){const i=new KeyboardEvent("keydown",{shiftKey:!0});requestAnimationFrame(()=>{"extended"!==o.selection.mode&&o._clearSelection(),o.beginUpdate(),o._setSelection(e,t),o._setSelection(l,n,i),o.ensureVisible(e,t),o.endUpdate(!1),o._recycle()})}(),o.$.fireEvent("change",{started:!1,finished:!0})}unselect(e,t){const l=this;l._selection&&(l._selection.rows&&l._selection.rows[e]&&delete l._selection.rows[e],l._selection.columns&&l._selection.columns[t]&&delete l._selection.columns[t],l._selection.cells&&(l._selection.cells["row"+e]&&(delete l._selection.cells["row"+e][t],1===Object.getOwnPropertyNames(l._selection.cells["row"+e]).length&&delete l._selection.cells["row"+e]),l._selection.cells["column"+t]&&(delete l._selection.cells["column"+t][e],1===Object.getOwnPropertyNames(l._selection.cells["column"+t]).length&&delete l._selection.cells["column"+t])),l.$.fireEvent("change",{started:!1,finished:!0}))}getSelection(){const e=this;let t=null,l=null,n=null,o=null;if(e._selection.rows&&Object.keys(e._selection.rows).length>0){const l=Object.keys(e._selection.rows);t=[];for(let n=0;n<l.length;n++){const o=l[n];t.push({id:o,row:e.rowById[o]})}}if(e._selection.columns&&Object.keys(e._selection.columns).length>0){const t=Object.keys(e._selection.columns);l=[];for(let n=0;n<t.length;n++){const o=t[n];l.push({dataField:o,column:e.columnByDataField[o]})}}if(e._selection.cells)for(let t in e._selection.cells)if(t.startsWith("row")){let l=t.replace("row",""),o=null;for(let i in e._selection.cells[t])o=i.replace("column",""),n||(n=[]),n.push({id:l,dataField:o,column:e.columnByDataField[o],row:e.rowById[l]})}return e._selection.focusedCell&&(o={id:e._selection.focusedCell.row.id,dataField:e._selection.focusedCell.column.dataField}),{rows:t,columns:l,cells:n,focused:o}}_clearSelection(e){const t=this;if(t._selection.rows=[],t._selection.columns=[],t._selection.cells=[],e&&(t._selection.focusedCell=null,t._selection.selectionRect)){const e=t._selection.selectionRect;e.parentNode.removeChild(e);const l={down:"pointerdown",move:"pointermove",up:"pointerup"};Smart.Utilities.Core.isMobile&&(l.down="touchstart",l.move="touchmove",l.up="touchend"),document.removeEventListener(l.move,e.onMove),document.removeEventListener(l.up,e.onUp),document.removeEventListener(l.down,e.onDown),t._selection.selectionRect=null}t._recycle(),t._selectionColumn.refresh()}_getSelectionCellValues(){const e=this;if(e._selection.selectionRect)return e._selection.selectionRect.cellValues;if(e._selection.rows.length>0){let t=[];for(let l in e._selection.rows){const n=e.rowById[l];for(let o=0;o<e.columns.length;o++){const i=e.columns[o];i&&(t[l]||(t[l]=[]),t[l][i.dataField]=n.data[i.dataField])}}return t}if(e._selection.columns.length>0){let t=[];for(let l in e._selection.columns){const n=e.columnByDataField[l];if(n)for(let l=0;l<e._recyclingRows.length;l++){const o=e._recyclingRows[l];o&&(t[o.id]||(t[o.id]=[]),t[o.id][n.dataField]=o.data[n.dataField])}}return t}}_clipboardHandler(e,t){const l=this;if(l.clipboard.enabled){if(t.ctrlKey&&("c"===e||"x"===e)){const e=l._getSelectionCellValues();let t="",n=Object.keys(e).length,o=0;for(let l in e){let i="",a=Object.keys(e[l]).length,c=0;for(let t in e[l]){i+=e[l][t],c++,c<a&&(i+="\t")}t+=i,o++,o<n&&(t+="\r\n")}navigator.clipboard.writeText(t).then((function(){}),(function(){}))}t.ctrlKey&&"v"===e&&navigator.clipboard.readText().then(e=>{const t=[],n=e.split("\r");for(let e=0;e<n.length;e++){const l=n[e].split("\t");let o={};for(let e=0;e<l.length;e++)o[e]=l[e].trim();t[e]=o}const o=l._selection.selectionRect;if(o)l._pasteSelectedCells({row:o.row,endRow:o.endDragRow,column:o.column,endColumn:o.endColumn},t);else{let e=null,n=null;for(let t in l._selection.rows){const o=l.rowById[t];e||(e=o),n||(n=o),e.visibleIndex>o.visibleIndex&&(e=o),n.visibleIndex<o.visibleIndex&&(n=o)}e&&n&&l._pasteSelectedCells({row:e,endRow:n,column:l.columns[0],endColumn:l.columns[l.columns.length-1]},t)}})}}_keyDownHandler(e){const t=this;if(t.onKey&&(t.onKey(e),e.defaultPrevented))return;let l=e.key;if(t.disabled)return;if(0===t.dataSource.length||t.disabled||t.displayLoadingIndicator)return;if(t.editing.editRow||t.editing.editCell)return;t.rightToLeft&&("ArrowLeft"===l?l="ArrowRight":"ArrowRight"===l&&(l="ArrowLeft")),t._refreshCellSelectionRect();const n=t.getSelection();let o=n.focused;if(!n.focused){if(t.editing.enabled&&!0!==t.editing.isEditing&&("F2"===l||"Enter"===l)&&n.columns&&n.columns.length>0){const e=n.columns[n.columns.length-1];e.column.allowHeaderEdit&&t._beginColumnEdit(e.column)}return}const i=t._getParentCell(t.rowById[o.id],o.dataField);if(i&&("ArrowLeft"===l?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowRight"===l?(o.id=i.row.id,o.dataField=i.endColumn.dataField):"ArrowUp"===l?(o.id=i.row.id,o.dataField=i.column.dataField):"ArrowDown"===l&&(o.id=i.endRow.id,o.dataField=i.column.dataField)),t._selection.selectionRect&&e.shiftKey&&!e.ctrlKey?(t._selection.selectionRect.endRow&&(o.id=t._selection.selectionRect.endRow.id),t._selection.selectionRect.endColumn&&(o.dataField=t._selection.selectionRect.endColumn.dataField)):t.selection.allowRowSelection&&!t.selection.allowCellSelection&&void 0!==t._rangeSelectionEndRow&&(o.id=t._rangeSelectionEndRow.id),t._clipboardHandler(l,e),(e.ctrlKey&&"x"!==l&&"c"!==l&&"v"!==l&&"Control"!==l||"Tab"===l)&&(t._selection.rows=[],t._selection.columns=[],t._selection.cells=[]),"Escape"===l)return t.closeMenu(),t.cancelEdit(),void t._setSelection(o.id,o.dataField,e);if(t.hasMenu())return;if(e.altKey){if("ArrowDown"===l){const l=t.columnByDataField[o.dataField];l&&t.hasColumnMenu(l)&&(l.showActionButton=!0,l.onAction(),t.menu&&(t.menu.querySelector("smart-menu").focus(),t.menu.querySelector("smart-menu").$.dispatch(e)))}else"ArrowUp"===l&&t.closeMenu();if("s"===l.toLowerCase()){const e=t.columnByDataField[o.dataField];e&&(e.sorted?"asc"===e.sortOrder?t.sortBy(e.dataField,"desc"):t.sortBy(e.dataField,null):t.sortBy(e.dataField,"asc"))}if("g"===l.toLowerCase()){const e=t.columnByDataField[o.dataField];e&&(e.group=!e.group)}return}const a=function(l,n){requestAnimationFrame(()=>{"extended"!==t.selection.mode&&t._clearSelection(),t.beginUpdate(),t._setSelection(l,n,e),t.ensureVisible(l,n),t.endUpdate(!1),t._recycle()}),e.stopPropagation(),e.preventDefault()};switch(l){case"Tab":{const l=e.shiftKey?t.prevColumn(o.dataField):t.nextColumn(o.dataField);if(l)t._selection.focusedCell=t.rowById[o.id].getCell(l.dataField),t._setSelection(o.id,l.dataField,e),t.focus(),e.stopPropagation(),e.preventDefault();else{let l=e.shiftKey?t.prevRow(o.id):t.nextRow(o.id),n=e.shiftKey?t.lastColumn().dataField:t.firstColumn().dataField;if(t.editing.addNewRow.autoCreate&&!e.shiftKey&&o.id===t.lastRow().id&&(t.addUnboundRow(1),l=t.lastRow()),!l)return;e.shiftKey&&(t._selection.focusedCell=null),a(l.id,n)}break}case" ":case"F2":{const e=t.rowById[o.id];if(!e||t.editing.editCell)return;" "===l&&t.dataSource.boundHierarchy&&(e.checked=!e.checked),t.editing.enabled&&(t._beginEdit(e,o.dataField),setTimeout((function(){if(t.editing.editCell&&t.editing.editCell.column.dataType.indexOf("bool")>=0){const e=t.editing.editCell.editor.instance,l=e.getValue();e.setValue(!l)}}),50));break}case"Delete":case"Backspace":{const e=t.rowById[o.id];if(!e||t.editing.editCell)return;const i=e.getCell(o.dataField),a=i.value;if(n.cells){t.beginUpdate();for(let e=0;e<n.cells.length;e++){const l=n.cells[e],o=t.rowById[l.id];if(o){o.getCell(l.dataField).value=null}}t.endUpdate(!1),t._recycle()}"Backspace"===l&&(t._beginEdit(e,o.dataField),i.canNotify=!1,i.value=a,i.canNotify=!0);break}default:if(t.editing.enabled&&!t.editing.editCell&&!e.ctrlKey&&!e.altKey&&!t.editing.editRow){const e=t.rowById[o.id];if(!e)return;if(["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(l)>=0)return;t._beginEdit(e,o.dataField),setTimeout((function(){if(t.editing.editCell)t.editing.editCell.editor.instance.setValue(l);else if(t.editing.editRow){const e=t.editing.editRow.getCell(o.dataField);if(!e)return;e.editor.instance.setValue(l)}}),50)}break;case"Home":{const e=t.firstRow();if(!e)return;a(e.id,o.dataField);break}case"End":{const e=t.lastRow();if(!e)return;a(e.id,o.dataField);break}case"PageUp":{const e=t._recyclingRows,l=t.rowById[o.id];for(let n=e.indexOf(l);n>=0;n--){const i=e[n];if(l.top-i.top>=t.$.scrollView.offsetHeight)return void a(i.id,o.dataField)}a(t.firstRow().id,o.dataField);break}case"PageDown":{const e=t._recyclingRows,l=t.rowById[o.id];for(let n=e.indexOf(l);n<e.length;n++){const i=e[n];if(i.top-l.top>=t.$.scrollView.offsetHeight)return void a(i.id,o.dataField)}a(t.lastRow().id,o.dataField);break}case"ArrowDown":case"Enter":{let n=e.ctrlKey?t.lastRow():t.nextRow(o.id);if(t.editing.addNewRow.autoCreate&&"Enter"===l&&o.id===t.lastRow().id&&(t.addUnboundRow(1),n=t.lastRow()),!n)return;a(n.id,o.dataField);break}case"ArrowUp":{const l=e.ctrlKey?t.firstRow():t.prevRow(o.id);if(!l)return;a(l.id,o.dataField);break}case"ArrowRight":{const l=t.rowById[o.id];if(!1===l.leaf){if(!l.expanded)return void l.expand();{const e=t.nextRow(o.id);if(e)return void a(e.id,o.dataField)}}const n=e.ctrlKey?t.lastColumn():t.nextColumn(o.dataField);if(!n)return;a(o.id,n.dataField);break}case"ArrowLeft":{const l=t.rowById[o.id];if(!1===l.leaf)return void(l.expanded?l.collapse():l.parent&&a(l.parent.id,o.dataField));if(!0===l.leaf&&l.parent)return void a(l.parent.id,o.dataField);const n=e.ctrlKey?t.firstColumn():t.prevColumn(o.dataField);if(!n)return;a(o.id,n.dataField);break}}["Shift","Up","Down","Left","Right","Control","F2","Esc"," ","Home","End","PageUp","PageDown"].indexOf(l)<0||(e.stopPropagation(),e.preventDefault())}_keyUpHandler(){this._focused}firstRow(){const e=this._recyclingRows;if(e&&e.length>0){if(!e[0].autoGenerated)return e[0];for(let t=0;t<e.length;t++)if(!e[t].autoGenerated)return e[t]}return null}lastRow(){const e=this._recyclingRows;if(e&&e.length>0){const t=e[e.length-1];if(!t.autoGenerated)return t;for(let t=e.length-1;t>=0;t--)if(!e[t].autoGenerated)return e[t]}return null}nextRow(e){const t=this._recyclingRows,l=this.rowById[e],n=t.indexOf(l);if(n>=0&&t[n+1]&&!t[n+1].autoGenerated){const e=t[n+1];if(e.allowSelect&&!e.disabled)return e;for(let e=n+1;e<t.length;e++){const l=t[e];if(l.allowSelect&&!l.disabled)return l}}return null}prevRow(e){const t=this._recyclingRows,l=this.rowById[e],n=t.indexOf(l);if(n>=0&&t[n-1]&&!t[n-1].autoGenerated){const e=t[n-1];if(e.allowSelect&&!e.disabled)return e;for(let e=n-1;e>=0;e--){const l=t[e];if(l.allowSelect&&!l.disabled)return l}}return null}firstColumn(){const e=this.columns;return e&&e.length>0?e[0]:null}lastColumn(){const e=this.columns;return e&&e.length>0?e[e.length-1]:null}nextColumn(e){const t=this.columns,l=this.columnByDataField[e],n=t.indexOf(l);return t[n+1]?t[n+1]:null}prevColumn(e){const t=this.columns,l=this.columnByDataField[e],n=t.indexOf(l);return t[n-1]?t[n-1]:null}isVisible(e,t){const l=this,n=l._scrollView.vScrollBar,o=l._scrollView.hScrollBar,i=l.rowById[e],a=l.columnByDataField[t];return{row:function(e){if(!e)return!1;return-1!==e.visibleIndex&&(!(e.top+e.height+o.offsetHeight+l.__frozenNearHeight>=l._scrollView.scrollTop+l.$.scrollView.offsetHeight-l.__frozenFarHeight)&&!(e.top<=l._scrollView.scrollTop))}(i),column:function(e){if(!t)return!1;return-1!==e.visibleIndex&&(!(e.left+e.computedWidth+n.offsetWidth>=l._scrollView.scrollLeft+l._clientSize.width)&&!(e.left<=l._scrollView.scrollLeft))}(a)}}ensureVisible(e,t){const l=this,n=l._scrollView.vScrollBar,o=l._scrollView.hScrollBar,i=l.rowById[e],a=l.columnByDataField[t];!function(e){if(!e)return;const t=e.visibleIndex;-1!==t&&(e.top+e.height+o.offsetHeight+l.__frozenNearHeight>=l._scrollView.scrollTop+l.$.scrollView.offsetHeight-l.__frozenFarHeight&&(l._scrollView.scrollTop=e.top+e.height),e.top<=l._scrollView.scrollTop&&(l._scrollView.scrollTop=e.top),0===t?l._scrollView.scrollTop=0:t===l.dataSource.length-1&&(l._scrollView.scrollTop=l._scrollView.scrollHeight))}(i);!function(e){if(!t)return;const o=e.visibleIndex;-1!==o&&(e.left+e.computedWidth+n.offsetWidth>=l._scrollView.scrollLeft+l._clientSize.width&&(l._scrollView.scrollLeft=l._scrollView.scrollLeft+e.computedWidth),e.left<=l._scrollView.scrollLeft&&(l._scrollView.scrollLeft=e.left),0===o?l._scrollView.scrollLeft=0:o===l.columns.length-1&&(l._scrollView.scrollLeft=l._scrollView.scrollWidth))}(a)}clearSelection(){this._clearSelection(!0),this.$.fireEvent("change",{started:!1,finished:!0})}})}});