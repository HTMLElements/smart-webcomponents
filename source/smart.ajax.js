
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

function Ajax(a,b){let c="GET",d=a.url,e=null,f=!0;if(a.type&&(c=a.type),a.data)if("GET"===c){for(let b in d+="?",a.data)a.data.hasOwnProperty(b)&&(d+=encodeURI(b+"="+a.data[b]+"&"));"&"===d.charAt(d.length-1)&&(d=d.slice(0,d.length-1))}else"POST"===c&&(e=JSON.stringify(a.data));b&&!1===b.async&&"xlsx"!==b.dataType&&(f=!1),void 0!==window.fetch&&f?AjaxFetch(a,b,c,d,e):AjaxXMLHttpRequest(a,b,c,d,e,f)}function AjaxFetch(a,b,c,d,e){const f={method:c};let g;switch(a.dataType){case"json":g="json";break;case"xlsx":g="arrayBuffer";break;default:g="text";}b&&b.contentType&&(f.headers=new Headers({"Content-Type":b.contentType})),null!==e&&(f.body=e);let h,i,j;if(a.timeout&&(i=setTimeout(function(){j=!0},a.timeout)),b.beforeSend){const a=b.beforeSend(f,b);if(!1===a)return}fetch(d,f).then(function(a){if(j)throw h=408,new Error("timeout");if(i&&clearTimeout(i),h=a.status,!a.ok)throw new Error(a.statusText);return a[g]()}).then(function(a){return"arrayBuffer"===g?JSZip.loadAsync(a).then(function(a){return a.files["xl/worksheets/sheet1.xml"].async("text").then(function(c){return a.files["xl/sharedStrings.xml"].async("text").then(function(a){const d=parseXLSXData(c,a);AjaxComplete(b,d,h)})})}):void AjaxComplete(b,a,h)}).catch(function(a){"JSZip is not defined"===a.message&&(a.message="JSZip is not defined. Please include a reference to JSZip to be able to load data from XLSX files."),b&&b.loadError&&b.loadError(h,a)})}function AjaxXMLHttpRequest(a,b,c,d,e,f){const g=new XMLHttpRequest;if(g.open(c,d,f),g.ontimeout=function(){b&&b.loadError&&b.loadError(408,"timeout")},g.onload=function(){if(4===g.readyState){const c=g.status;let d=g.response;200<=c&&299>=c?("json"===a.dataType&&(d=JSON.parse(d)),AjaxComplete(b,d,c)):b&&b.loadError&&b.loadError(c,d)}},g.onerror=function(){b&&b.loadError&&b.loadError(g.status,g.response)},b&&b.contentType&&g.setRequestHeader("Content-Type",b.contentType),f&&a.timeout&&(g.timeout=a.timeout),b.beforeSend){const a=b.beforeSend(g,b);if(!1===a)return}g.send(e)}function AjaxComplete(a,b,c){if(a){if(a.beforeLoadComplete){const c=a.beforeLoadComplete(b);c&&(b=c)}a.loadComplete&&a.loadComplete(b,c)}}function parseXLSXData(a,b){const c=new DOMParser,d=c.parseFromString(b,"text/xml"),e=Array.from(d.getElementsByTagName("si")),f=[],g=c.parseFromString(a,"text/xml"),h=Array.from(g.getElementsByTagName("row")),i=[];return e.forEach(function(a){let b=a.getElementsByTagName("t");if(1===b.length)f.push(b[0].innerHTML);else{let a="";b=Array.from(b),b.forEach(function(b){a+=b.innerHTML}),f.push(a)}}),h.forEach(function(a){const b={},c=Array.from(a.getElementsByTagName("c"));c.forEach(function(a){const c=a.getAttribute("r").match(/\D+/)[0],d=a.getAttribute("t"),e=a.getElementsByTagName("v")[0].innerHTML;let g;g="s"===d?f[parseFloat(e)]:"b"===d?1===parseFloat(e):parseFloat(e),b[c]=g}),i.push(b)}),i}