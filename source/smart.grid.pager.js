
/* Smart UI v9.3.53 (2021-05-10) 
Copyright (c) 2011-2021 jQWidgets. 
License: https://htmlelements.com/license/ */ //

Smart.Utilities.Assign("Grid.Pager",class{_refreshPaging(e){const t=this;requestAnimationFrame((()=>{if(t.filtering.filterRow)for(let e=0;e<t.columns.length;e++)t.columns[e]._filterEditorInitialized=!1;t._refreshLayout(),t._refreshSelection(),e||(t._initializeRowElements(),t._refreshLayout()),t.dataSource&&t.dataSource.virtualDataSource?t._virtualDataRequest(e?"pageIndexChange":"pageSizeChange"):t._recycle(!1);const a=t.paging.pageIndex*t.paging.pageSize,r=a+t.paging.pageSize;t.$.fireEvent("page",{data:{first:a,last:r,size:r-a}})}))}_refreshPagesCount(){const e=this;if(!e.paging.enabled)return;const t=e.$.headerPager.querySelector("smart-pager"),a=function(){const t=e.getVisibleRows();let a=t.length;if(e.rowHierarchy){a=0;for(let e=0;e<t.length;e++){const r=t[e];0!==r.level||r.parent||a++}if(void 0!==e.dataSource.virtualDataSourceLength)a=e.dataSource.virtualDataSourceLength;else{e._refreshRowHierarchy(!1,!0),a=0;const t=a=>{let r=[];if(0===e.dataSource.groupBy.length)return a;for(let e=0;e<a.length;e++){const i=a[e];(!i.$||void 0===i.$.filtered||i.$.filtered)&&(r.push(i),i.children&&(r=r.concat(t(i.children))))}return r};for(let r=0;r<e.rowHierarchy.length;r++){const i=e.rowHierarchy[r];if(0===i.level&&!i.parent){if(0===t(i.children).length)continue;a++}}e._refreshRowHierarchy(),e._recycle(!1)}}return{pagesCount:Math.ceil(a/e.paging.pageSize),totalRecords:a}}();t&&(t.pagesCount=a.pagesCount,t.totalRecords=a.totalRecords);const r=e.$.footerPager.querySelector("smart-pager");t&&(r.pagesCount=a.pagesCount,r.totalRecords=a.totalRecords,t.$.pageSizeSelector.disabled=a.totalRecords<e.pager.pageSizeSelector.dataSource[0],r.$.pageSizeSelector.disabled=a.totalRecords<e.pager.pageSizeSelector.dataSource[0]),e.paging.pageIndex>=a.pagesCount&&a.pagesCount>0&&(e.paging.pageIndex=a.pagesCount-1,e._refreshPaging(e.paging.pageIndex))}_renderPagers(){const e=this;e.pager.visible&&requestAnimationFrame((()=>{const t=document.createElement("smart-pager"),a=document.createElement("smart-pager");e.$.headerPager.innerHTML="",e.$.footerPager.innerHTML="",e.$.headerPager.appendChild(t),e.$.footerPager.appendChild(a);const r=function(t){t.messages[e.locale]||(t.messages[e.locale]={}),Object.assign(t.messages[e.locale],{firstButton:e.localize("pagerFirstButton"),lastButton:e.localize("pagerLastButton"),previousButton:e.localize("pagerPreviousButton"),nextButton:e.localize("pagerNextButton"),navigateToLabel:e.localize("pagerNavigateToLabel"),pageSizeLabel:e.localize("pagerPageSizeLabel"),navigateToInputPlaceholder:e.localize("pagerNavigateToInputPlaceholder"),ellipsis:e.localize("pagerEllipsis"),summaryString:e.localize("pagerSummaryString"),summaryPrefix:e.localize("pagerSummaryPrefix"),summarySuffix:e.localize("pagerSummarySuffix")}),t.locale=e.locale},i=function(){const t=e.getVisibleRows();let a=t.length;if(e.rowHierarchy){a=0;for(let e=0;e<t.length;e++){const r=t[e];0!==r.level||r.parent||a++}if(void 0!==e.dataSource.virtualDataSourceLength)a=e.dataSource.virtualDataSourceLength;else{e._refreshRowHierarchy(!1,!0),a=0;const t=a=>{let r=[];if(0===e.dataSource.groupBy.length)return a;for(let e=0;e<a.length;e++){const i=a[e];(!i.$||void 0===i.$.filtered||i.$.filtered)&&(r.push(i),i.children&&(r=r.concat(t(i.children))))}return r};for(let r=0;r<e.rowHierarchy.length;r++){const i=e.rowHierarchy[r];if(0===i.level&&!i.parent){if(0===t(i.children).length)continue;a++}}e._refreshRowHierarchy(),e._recycle(!1)}}return{pagesCount:Math.ceil(a/e.paging.pageSize),totalRecords:a}},o=function(r,o){const n=o+"GridPager",g=i();r.setAttribute("smart-id",n),e.$[n]=r,e["$"+n]=Smart.Utilities.Extend(r),r.beginUpdate(),e.addPropertyBinding("[[pager_navigationButtons_position]]","navigationButtonsPosition",r),e.addPropertyBinding("[[pager_navigationButtons_firstLastButtons_visible]]","showFirstLastNavigationButtons",r),e.addPropertyBinding("[[pager_navigationButtons_prevNextButtons_visible]]","showPrevNextNavigationButtons",r),e.addPropertyBinding("[[pager_navigationButtons_labels_visible]]","showNavigationButtonLabels",r),e.addPropertyBinding("[[pager_pageIndexSelectors_visible]]","showPageIndexSelectors",r),e.addPropertyBinding("[[pager_pageIndexSelectors_dataSource]]","pageIndexSelectors",r),e.addPropertyBinding("[[pager_summary_visible]]","showSummary",r),e.addPropertyBinding("[[pager_summary_position]]","summaryPosition",r),e.addPropertyBinding("[[pager_navigationInput_visible]]","showNavigationInput",r),e.addPropertyBinding("[[pager_navigationInput_position]]","navigationInputPosition",r),e.addPropertyBinding("[[pager_pageSizeSelector_visible]]","showPageSizeSelector",r),e.addPropertyBinding("[[pager_pageSizeSelector_dataSource]]","pageSizeSelectorDataSource",r),e.addPropertyBinding("[[pager_pageSizeSelector_position]]","pageSizeSelectorPosition",r),e.addPropertyBinding("[[pager_autoEllipsis]]","autoEllipsis",r),e.addPropertyBinding("[[!paging_enabled]]","disabled",r),e.addPropertyBinding("{{paging_pageIndex}}","pageIndex",r),e.addPropertyBinding("{{paging_pageSize}}","pageSize",r),e.addPropertyBinding("{{rightToLeft}}","rightToLeft",r),r.pagesCount=g.pagesCount,r.totalRecords=g.totalRecords,r.$.pageSizeSelector.dropDownAppendTo="body",r.$.pageSizeSelector.selectedIndexes=[0],r.totalRecords<e.pager.pageSizeSelector.dataSource[0]&&(r.$.pageSizeSelector.disabled=!0),e["$"+n].listen("change",(function(o){const n=i();r.pagesCount=n.pagesCount,r.totalRecords=n.totalRecords,e.paging.pageIndex>r.pagesCount&&(e.paging.pageIndex=r.pagesCount-1),t.refresh(),a.refresh();const g=o.detail&&void 0!==o.detail.index||void 0!==o.target.value;e._refreshPaging(g)})),r.endUpdate()};o(t,"header"),o(a,"footer"),r(t),r(a)}))}});