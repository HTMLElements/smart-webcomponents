
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("TickIntervalHandler",class{constructor(a,b,c,d,e,f,g){const h=this;h.context=a,h.minLabel=b,h.maxLabel=c,h.labelClass=d,h.dimension=e,h.logarithmic=g,h.labelsSize=a.customInterval?0<a.customTicks.length?h.getCustomTicksLabelSize():{minLabelSize:0,minLabelOtherSize:0,maxLabelSize:0,maxLabelOtherSize:0}:h.getMinAndMaxLabelSize(),f?(h.getNiceInterval=h.getNiceIntervalInteger,h.getPossibleBiggerLabel=h.getPossibleBiggerLabelInteger):(h.getNiceInterval=h.getNiceIntervalFloatingPoint,h.getPossibleBiggerLabel=h.getPossibleBiggerLabelFloatingPoint)}getInterval(a,b,c,d){var e=Math.max;const f=this.context,g=f._measurements.innerRadius;let h,i=1;"radial"===a?(h=e(this.labelsSize.minLabelSize,this.labelsSize.minLabelOtherSize,this.labelsSize.maxLabelSize,this.labelsSize.maxLabelOtherSize),i=1.35):(h=e(this.labelsSize.minLabelSize,this.labelsSize.maxLabelSize),i=1.45),h*=i;let j;j="radial"===a?function(){let a=2*Math.PI*g*(Math.abs(f.startAngle-f.endAngle)/360);return Math.round(a)}():f[this.dimension]-this.labelsSize.minLabelSize/2-this.labelsSize.maxLabelSize/2,j=e(10,j);const k=Math.ceil(j/h),l="radial"===a?4*k:3*k;let m=this.getNiceInterval(b,c,k,!0),n=this.getNiceInterval(b,c,l);if(f._cachedLabelsSize=this.labelsSize,2<k&&!f.customInterval){const g=this.getPossibleBiggerLabel(k,m);if(g.length>e(this.minLabel.length,this.maxLabel.length)){const e=this.minLabel;this.minLabel=g,this.labelsSize=this.getMinAndMaxLabelSize(),f._cachedLabelsSize=this.labelsSize;const h=this.getInterval(a,b,c,d);return this.minLabel=e,this.labelsSize=this.getMinAndMaxLabelSize(),h}}return{major:m,minor:n}}getNiceIntervalFloatingPoint(a,b,c,d){var e=Math.log10;const f=b-a,g=Math.floor(e(f)-e(c));let h,i=Math.pow(10,g),j=c*i;h=f<2*j?1:f<3*j?2:f<7*j?5:10;let k=h*i;return d&&this.context._range/k>c&&(5===h?h=10:2===h?h=5:1===h?h=2:void 0,k=h*i),this.nearestPowerOfTen=i,this.logarithmic&&d?Math.max(1,k):k}getPossibleBiggerLabelFloatingPoint(a,b){var c=Math.pow;const d=this.context;let e,f,g=parseFloat(d.min-d._numericProcessor.getPreciseModulo(parseFloat(d.min),b)+parseFloat(b)),h=g;this.logarithmic&&(g=c(10,g)),e=d._formatLabel(g);for(let g=1;g<a&&(h+=b,!(h>=d._drawMax));g++)f=this.logarithmic?c(10,h):h,f=d._formatLabel(f),f.length>e.length&&(e=f);return e}getNiceIntervalInteger(a,b,c,d){var e=Math.log10;const f=new Smart.Utilities.BigNumber(b).subtract(new Smart.Utilities.BigNumber(a)),g=Math.floor(e(f.toString())-e(c)),h=new Smart.Utilities.BigNumber(10).pow(new Smart.Utilities.BigNumber(g)),i=new Smart.Utilities.BigNumber(c).multiply(h);let j=-1===f.compare(new Smart.Utilities.BigNumber(2*i))?1:-1===f.compare(new Smart.Utilities.BigNumber(3*i))?2:-1===f.compare(new Smart.Utilities.BigNumber(7*i))?5:10;let k=new Smart.Utilities.BigNumber(j).multiply(h);return d&&1===new Smart.Utilities.BigNumber(this.context._range).divide(k).compare(c)&&(5===j?j=10:2===j?j=5:1===j?j=2:void 0,k=new Smart.Utilities.BigNumber(j).multiply(h)),-1===k.compare(1)&&(k=new Smart.Utilities.BigNumber(1)),this.nearestPowerOfTen=h,k}getPossibleBiggerLabelInteger(a,b){const c=this.context,d=new Smart.Utilities.BigNumber(10);let e,f,g=new Smart.Utilities.BigNumber(c.min).subtract(new Smart.Utilities.BigNumber(c.min).mod(b)).add(b),h=g;this.logarithmic&&(g=d.pow(g)),e=c._formatLabel(g);for(let g=1;g<a&&(h=h.add(b),-1===h.compare(c._drawMax));g++)f=this.logarithmic?d.pow(h):h,f=c._formatLabel(f),f.length>e.length&&(e=f);return e}getMinAndMaxLabelSize(){const a=this,b=a.context,c=b.$.container,d=document.createElement("span");d.className=a.labelClass,d.style.position="absolute",d.style.visibility="hidden",c.appendChild(d),d.innerHTML=a.minLabel;const e=d[a.dimension],f=d[b._settings.otherSize];d.innerHTML=a.maxLabel;const g=d[a.dimension],h=d[b._settings.otherSize];return c.removeChild(d),{minLabelSize:e,minLabelOtherSize:f,maxLabelSize:g,maxLabelOtherSize:h}}getCustomTicksLabelSize(){const a=this,b=a.context,c=b.$.container,d=document.createElement("span"),e=b.customTicks;d.className=a.labelClass,d.style.position="absolute",d.style.visibility="hidden",c.appendChild(d),d.innerHTML=b._formatLabel(e[0]);let f=d[a.dimension],g=d[b._settings.otherSize];for(let c=1;c<b.customTicks.length;c++){d.innerHTML=b._formatLabel(b.customTicks[c]);const e=d[a.dimension],h=d[b._settings.otherSize];e>f&&(f=e),h>g&&(g=h)}return c.removeChild(d),{minLabelSize:f,minLabelOtherSize:g,maxLabelSize:f,maxLabelOtherSize:g}}});